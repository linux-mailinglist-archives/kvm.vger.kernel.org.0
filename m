Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id D903E4D8B6
	for <lists+kvm@lfdr.de>; Thu, 20 Jun 2019 20:28:50 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727601AbfFTS2l (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Thu, 20 Jun 2019 14:28:41 -0400
Received: from mail-eopbgr720085.outbound.protection.outlook.com ([40.107.72.85]:31712
        "EHLO NAM05-CO1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727670AbfFTSDf (ORCPT <rfc822;kvm@vger.kernel.org>);
        Thu, 20 Jun 2019 14:03:35 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=bIIK3esCMPQSvmdFQmpZO+9pFUeNIETCcZlxkUt9c0M=;
 b=EYvGNAAyHpjy155/qzFt6KwuxJqHEQsN3QuUOrf3lcLeDHhj7Fc+wrxhzpBZBcvaiO7VIxnpzSeRTHqafmLI959PSZMhbOAaYLRDr5LImKOPAEgYa+4O8bjG1jDTMhp3w6UFBRwbEo6+kXhMJuqH/p2n9er0Xh5+b5saH3nZkxo=
Received: from DM6PR12MB2682.namprd12.prod.outlook.com (20.176.116.31) by
 DM6PR12MB3260.namprd12.prod.outlook.com (20.179.105.216) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1987.15; Thu, 20 Jun 2019 18:03:23 +0000
Received: from DM6PR12MB2682.namprd12.prod.outlook.com
 ([fe80::b9c1:b235:fff3:dba2]) by DM6PR12MB2682.namprd12.prod.outlook.com
 ([fe80::b9c1:b235:fff3:dba2%6]) with mapi id 15.20.1987.014; Thu, 20 Jun 2019
 18:03:23 +0000
From:   "Singh, Brijesh" <brijesh.singh@amd.com>
To:     "qemu-devel@nongnu.org" <qemu-devel@nongnu.org>
CC:     "Lendacky, Thomas" <Thomas.Lendacky@amd.com>,
        "kvm@vger.kernel.org" <kvm@vger.kernel.org>,
        "Singh, Brijesh" <brijesh.singh@amd.com>
Subject: [RFC PATCH v1 10/12] target/i386: sev: add support to load incoming
 encrypted page
Thread-Topic: [RFC PATCH v1 10/12] target/i386: sev: add support to load
 incoming encrypted page
Thread-Index: AQHVJ5JyQwoOU+uwV02za7BB4A2ErA==
Date:   Thu, 20 Jun 2019 18:03:21 +0000
Message-ID: <20190620180247.8825-11-brijesh.singh@amd.com>
References: <20190620180247.8825-1-brijesh.singh@amd.com>
In-Reply-To: <20190620180247.8825-1-brijesh.singh@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: DM5PR16CA0025.namprd16.prod.outlook.com
 (2603:10b6:4:15::11) To DM6PR12MB2682.namprd12.prod.outlook.com
 (2603:10b6:5:4a::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=brijesh.singh@amd.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [165.204.77.1]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: a4c91a21-1243-429f-2b7e-08d6f5a994df
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(5600148)(711020)(4605104)(1401327)(4618075)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);SRVR:DM6PR12MB3260;
x-ms-traffictypediagnostic: DM6PR12MB3260:
x-microsoft-antispam-prvs: <DM6PR12MB32602E5E02ACD80599E62AA3E5E40@DM6PR12MB3260.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:1186;
x-forefront-prvs: 0074BBE012
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(366004)(396003)(376002)(136003)(39860400002)(346002)(199004)(189003)(2351001)(53936002)(486006)(2616005)(11346002)(81156014)(8676002)(14444005)(6436002)(446003)(5640700003)(50226002)(6512007)(476003)(102836004)(6916009)(99286004)(2501003)(6486002)(76176011)(8936002)(52116002)(81166006)(316002)(186003)(6506007)(26005)(478600001)(256004)(3846002)(2906002)(386003)(66066001)(14454004)(54906003)(6116002)(305945005)(25786009)(1076003)(66946007)(66556008)(73956011)(64756008)(66446008)(71190400001)(71200400001)(68736007)(36756003)(66476007)(5660300002)(7736002)(86362001)(4326008);DIR:OUT;SFP:1101;SCL:1;SRVR:DM6PR12MB3260;H:DM6PR12MB2682.namprd12.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;A:1;MX:1;
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: DAZEztOcF+0AmdXM1klP/mEzccMkGEbAD7EgdAJmDVAr7NbwgpFG7WXEkLIxhwuMNWG4Sdu+grKU4CWqFLuwesk+Bq1Bv1FkzHKWRnpYiszpAJ674Yx2zkmDCStSZDT6q7thl0ASfYkvUc42vAocxB3LBdT9XdgvnX1nYm9CR95an99BDnZubsukdTEGUfPm69tXgWpvbO4KcHLOWXpMHm2p0hbEdfn1V+1zC9iwEMoGbhRyRg4Dw+90i8lQ3bTydC9IWYlfHPjJ7dHpJ8G6QUcr750sohm0srVrbQo9ZXQV1TAgmDajqUiOLTaqj+1kZFq3YVsN6oIG67Zp+4TdyX6/KkIxw2EwUwthoVi70iZOiwngauwisd+lwDagjGuXoQtkXXJTORTzzhj2yFNpNOQKBKuqwhYB3Z8psk6N5C8=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: a4c91a21-1243-429f-2b7e-08d6f5a994df
X-MS-Exchange-CrossTenant-originalarrivaltime: 20 Jun 2019 18:03:21.9283
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: sbrijesh@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB3260
Sender: kvm-owner@vger.kernel.org
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

VGhlIHNldl9sb2FkX2luY29taW5nX3BhZ2UoKSBwcm92aWRlIHRoZSBpbXBsZW1lbnRhdGlvbiB0
byByZWFkIHRoZQ0KaW5jb21pbmcgZ3Vlc3QgcHJpdmF0ZSBwYWdlcyBmcm9tIHRoZSBzb2NrZXQg
YW5kIGxvYWQgaXQgaW50byB0aGUgZ3Vlc3QNCm1lbW9yeS4gVGhlIHJvdXRpbmVzIHVzZXMgdGhl
IFJFQ0VJVkVfU1RBUlQgY29tbWFuZCB0byBjcmVhdGUgdGhlDQppbmNvbWluZyBlbmNyeXB0aW9u
IGNvbnRleHQgb24gdGhlIGZpcnN0IGNhbGwgdGhlbiB1c2VzIHRoZQ0KUkVDRUlFVkVfVVBEQVRF
X0RBVEEgY29tbWFuZCB0byBsb2FkIHRoZSBlbmNyeXB0ZWQgcGFnZXMgaW50byB0aGUgZ3Vlc3QN
Cm1lbW9yeS4gQWZ0ZXIgbWlncmF0aW9uIGlzIGNvbXBsZXRlZCwgd2UgaXNzdWUgdGhlIFJFQ0VJ
VkVfRklOSVNIIGNvbW1hbmQNCnRvIHRyYW5zaXRpb24gdGhlIFNFViBndWVzdCB0byB0aGUgcnVu
bmFibGUgc3RhdGUgc28gdGhhdCBpdCBjYW4gYmUNCmV4ZWN1dGVkLg0KDQpTaWduZWQtb2ZmLWJ5
OiBCcmlqZXNoIFNpbmdoIDxicmlqZXNoLnNpbmdoQGFtZC5jb20+DQotLS0NCiBhY2NlbC9rdm0v
a3ZtLWFsbC5jICAgICAgfCAgIDEgKw0KIHRhcmdldC9pMzg2L3Nldi5jICAgICAgICB8IDEyNiAr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0NCiB0YXJnZXQvaTM4Ni90cmFj
ZS1ldmVudHMgfCAgIDMgKw0KIDMgZmlsZXMgY2hhbmdlZCwgMTI5IGluc2VydGlvbnMoKyksIDEg
ZGVsZXRpb24oLSkNCg0KZGlmZiAtLWdpdCBhL2FjY2VsL2t2bS9rdm0tYWxsLmMgYi9hY2NlbC9r
dm0va3ZtLWFsbC5jDQppbmRleCA4NWQ2NTA4ZTdmLi5mZTY1YzhlYjVkIDEwMDY0NA0KLS0tIGEv
YWNjZWwva3ZtL2t2bS1hbGwuYw0KKysrIGIvYWNjZWwva3ZtL2t2bS1hbGwuYw0KQEAgLTE3ODUs
NiArMTc4NSw3IEBAIHN0YXRpYyBpbnQga3ZtX2luaXQoTWFjaGluZVN0YXRlICptcykNCiAgICAg
ICAgIGt2bV9zdGF0ZS0+bWVtY3J5cHRfZW5jcnlwdF9kYXRhID0gc2V2X2VuY3J5cHRfZGF0YTsN
CiAgICAgICAgIGt2bV9zdGF0ZS0+bWVtY3J5cHRfc3luY19wYWdlX2VuY19iaXRtYXAgPSBzZXZf
c3luY19wYWdlX2VuY19iaXRtYXA7DQogICAgICAgICBrdm1fc3RhdGUtPm1lbWNyeXB0X3NhdmVf
b3V0Z29pbmdfcGFnZSA9IHNldl9zYXZlX291dGdvaW5nX3BhZ2U7DQorICAgICAgICBrdm1fc3Rh
dGUtPm1lbWNyeXB0X2xvYWRfaW5jb21pbmdfcGFnZSA9IHNldl9sb2FkX2luY29taW5nX3BhZ2U7
DQogICAgIH0NCiANCiAgICAgcmV0ID0ga3ZtX2FyY2hfaW5pdChtcywgcyk7DQpkaWZmIC0tZ2l0
IGEvdGFyZ2V0L2kzODYvc2V2LmMgYi90YXJnZXQvaTM4Ni9zZXYuYw0KaW5kZXggYjVhYTUzZWM0
NC4uYjdmZWVkY2U3ZCAxMDA2NDQNCi0tLSBhL3RhcmdldC9pMzg2L3Nldi5jDQorKysgYi90YXJn
ZXQvaTM4Ni9zZXYuYw0KQEAgLTcwOCwxMyArNzA4LDM0IEBAIHNldl9sYXVuY2hfZmluaXNoKFNF
VlN0YXRlICpzKQ0KICAgICB9DQogfQ0KIA0KK3N0YXRpYyBpbnQNCitzZXZfcmVjZWl2ZV9maW5p
c2goU0VWU3RhdGUgKnMpDQorew0KKyAgICBpbnQgZXJyb3IsIHJldCA9IDE7DQorDQorICAgIHRy
YWNlX2t2bV9zZXZfcmVjZWl2ZV9maW5pc2goKTsNCisgICAgcmV0ID0gc2V2X2lvY3RsKHMtPnNl
dl9mZCwgS1ZNX1NFVl9SRUNFSVZFX0ZJTklTSCwgMCwgJmVycm9yKTsNCisgICAgaWYgKHJldCkg
ew0KKyAgICAgICAgZXJyb3JfcmVwb3J0KCIlczogUkVDRUlWRV9GSU5JU0ggcmV0PSVkIGZ3X2Vy
cm9yPSVkICclcyciLA0KKyAgICAgICAgICAgICAgICBfX2Z1bmNfXywgcmV0LCBlcnJvciwgZndf
ZXJyb3JfdG9fc3RyKGVycm9yKSk7DQorICAgICAgICBnb3RvIGVycjsNCisgICAgfQ0KKw0KKyAg
ICBzZXZfc2V0X2d1ZXN0X3N0YXRlKFNFVl9TVEFURV9SVU5OSU5HKTsNCitlcnI6DQorICAgIHJl
dHVybiByZXQ7DQorfQ0KKw0KKw0KIHN0YXRpYyB2b2lkDQogc2V2X3ZtX3N0YXRlX2NoYW5nZSh2
b2lkICpvcGFxdWUsIGludCBydW5uaW5nLCBSdW5TdGF0ZSBzdGF0ZSkNCiB7DQogICAgIFNFVlN0
YXRlICpzID0gb3BhcXVlOw0KIA0KICAgICBpZiAocnVubmluZykgew0KLSAgICAgICAgaWYgKCFz
ZXZfY2hlY2tfc3RhdGUoU0VWX1NUQVRFX1JVTk5JTkcpKSB7DQorICAgICAgICBpZiAoc2V2X2No
ZWNrX3N0YXRlKFNFVl9TVEFURV9SRUNFSVZFX1VQREFURSkpIHsNCisgICAgICAgICAgICBzZXZf
cmVjZWl2ZV9maW5pc2gocyk7DQorICAgICAgICB9IGVsc2UgaWYgKCFzZXZfY2hlY2tfc3RhdGUo
U0VWX1NUQVRFX1JVTk5JTkcpKSB7DQogICAgICAgICAgICAgc2V2X2xhdW5jaF9maW5pc2gocyk7
DQogICAgICAgICB9DQogICAgIH0NCkBAIC0xMDkyLDYgKzExMTMsMTA5IEBAIGludCBzZXZfc2F2
ZV9vdXRnb2luZ19wYWdlKHZvaWQgKmhhbmRsZSwgUUVNVUZpbGUgKmYsIHVpbnQ4X3QgKnB0ciwN
CiAgICAgcmV0dXJuIHNldl9zZW5kX3VwZGF0ZV9kYXRhKHMsIGYsIHB0ciwgc3osIGJ5dGVzX3Nl
bnQpOw0KIH0NCiANCitzdGF0aWMgaW50DQorc2V2X3JlY2VpdmVfc3RhcnQoUVNldkd1ZXN0SW5m
byAqc2V2LCBRRU1VRmlsZSAqZikNCit7DQorICAgIGludCByZXQgPSAxOw0KKyAgICBpbnQgZndf
ZXJyb3I7DQorICAgIHN0cnVjdCBrdm1fc2V2X3JlY2VpdmVfc3RhcnQgKnN0YXJ0Ow0KKyAgICBn
Y2hhciAqc2Vzc2lvbiA9IE5VTEwsICpwZGhfY2VydCA9IE5VTEw7DQorDQorICAgIHN0YXJ0ID0g
Z19uZXcwKHN0cnVjdCBrdm1fc2V2X3JlY2VpdmVfc3RhcnQsIDEpOw0KKw0KKyAgICAvKiBnZXQg
U0VWIGd1ZXN0IGhhbmRsZSAqLw0KKyAgICBzdGFydC0+aGFuZGxlID0gb2JqZWN0X3Byb3BlcnR5
X2dldF9pbnQoT0JKRUNUKHNldiksICJoYW5kbGUiLA0KKyAgICAgICAgICAgICZlcnJvcl9hYm9y
dCk7DQorDQorICAgIC8qIGdldCB0aGUgc291cmNlIHBvbGljeSAqLw0KKyAgICBzdGFydC0+cG9s
aWN5ID0gcWVtdV9nZXRfYmUzMihmKTsNCisNCisgICAgLyogZ2V0IHNvdXJjZSBQREgga2V5ICov
DQorICAgIHN0YXJ0LT5wZGhfbGVuID0gcWVtdV9nZXRfYmUzMihmKTsNCisgICAgcGRoX2NlcnQg
PSBnX25ldyhnY2hhciwgc3RhcnQtPnBkaF9sZW4pOw0KKyAgICBxZW11X2dldF9idWZmZXIoZiwg
KHVpbnQ4X3QgKilwZGhfY2VydCwgc3RhcnQtPnBkaF9sZW4pOw0KKyAgICBzdGFydC0+cGRoX3Vh
ZGRyID0gKHVuc2lnbmVkIGxvbmcpcGRoX2NlcnQ7DQorDQorICAgIC8qIGdldCBzb3VyY2Ugc2Vz
c2lvbiBkYXRhICovDQorICAgIHN0YXJ0LT5zZXNzaW9uX2xlbiA9IHFlbXVfZ2V0X2JlMzIoZik7
DQorICAgIHNlc3Npb24gPSBnX25ldyhnY2hhciwgc3RhcnQtPnNlc3Npb25fbGVuKTsNCisgICAg
cWVtdV9nZXRfYnVmZmVyKGYsICh1aW50OF90ICopc2Vzc2lvbiwgc3RhcnQtPnNlc3Npb25fbGVu
KTsNCisgICAgc3RhcnQtPnNlc3Npb25fdWFkZHIgPSAodW5zaWduZWQgbG9uZylzZXNzaW9uOw0K
Kw0KKyAgICB0cmFjZV9rdm1fc2V2X3JlY2VpdmVfc3RhcnQoc3RhcnQtPnBvbGljeSwgc2Vzc2lv
biwgcGRoX2NlcnQpOw0KKw0KKyAgICByZXQgPSBzZXZfaW9jdGwoc2V2X3N0YXRlLT5zZXZfZmQs
IEtWTV9TRVZfUkVDRUlWRV9TVEFSVCwgc3RhcnQsICZmd19lcnJvcik7DQorICAgIGlmIChyZXQg
PCAwKSB7DQorICAgICAgICBlcnJvcl9yZXBvcnQoIkVycm9yIFJFQ0VJVkVfU1RBUlQgcmV0PSVk
IGZ3X2Vycm9yPSVkICclcyciLA0KKyAgICAgICAgICAgICAgICByZXQsIGZ3X2Vycm9yLCBmd19l
cnJvcl90b19zdHIoZndfZXJyb3IpKTsNCisgICAgICAgIGdvdG8gZXJyOw0KKyAgICB9DQorDQor
ICAgIG9iamVjdF9wcm9wZXJ0eV9zZXRfaW50KE9CSkVDVChzZXYpLCBzdGFydC0+aGFuZGxlLCAi
aGFuZGxlIiwgJmVycm9yX2Fib3J0KTsNCisgICAgc2V2X3NldF9ndWVzdF9zdGF0ZShTRVZfU1RB
VEVfUkVDRUlWRV9VUERBVEUpOw0KK2VycjoNCisgICAgZ19mcmVlKHN0YXJ0KTsNCisgICAgZ19m
cmVlKHNlc3Npb24pOw0KKyAgICBnX2ZyZWUocGRoX2NlcnQpOw0KKw0KKyAgICByZXR1cm4gcmV0
Ow0KK30NCisNCitzdGF0aWMgaW50IHNldl9yZWNlaXZlX3VwZGF0ZV9kYXRhKFFFTVVGaWxlICpm
LCB1aW50OF90ICpwdHIpDQorew0KKyAgICBpbnQgcmV0ID0gMSwgZndfZXJyb3IgPSAwOw0KKyAg
ICBnY2hhciAqaGRyID0gTlVMTCwgKnRyYW5zID0gTlVMTDsNCisgICAgc3RydWN0IGt2bV9zZXZf
cmVjZWl2ZV91cGRhdGVfZGF0YSAqdXBkYXRlOw0KKw0KKyAgICB1cGRhdGUgPSBnX25ldzAoc3Ry
dWN0IGt2bV9zZXZfcmVjZWl2ZV91cGRhdGVfZGF0YSwgMSk7DQorDQorICAgIC8qIGdldCBwYWNr
ZXQgaGVhZGVyICovDQorICAgIHVwZGF0ZS0+aGRyX2xlbiA9IHFlbXVfZ2V0X2JlMzIoZik7DQor
ICAgIGhkciA9IGdfbmV3KGdjaGFyLCB1cGRhdGUtPmhkcl9sZW4pOw0KKyAgICBxZW11X2dldF9i
dWZmZXIoZiwgKHVpbnQ4X3QgKiloZHIsIHVwZGF0ZS0+aGRyX2xlbik7DQorICAgIHVwZGF0ZS0+
aGRyX3VhZGRyID0gKHVuc2lnbmVkIGxvbmcpaGRyOw0KKw0KKyAgICAvKiBnZXQgdHJhbnNwb3J0
IGJ1ZmZlciAqLw0KKyAgICB1cGRhdGUtPnRyYW5zX2xlbiA9IHFlbXVfZ2V0X2JlMzIoZik7DQor
ICAgIHRyYW5zID0gZ19uZXcoZ2NoYXIsIHVwZGF0ZS0+dHJhbnNfbGVuKTsNCisgICAgdXBkYXRl
LT50cmFuc191YWRkciA9ICh1bnNpZ25lZCBsb25nKXRyYW5zOw0KKyAgICBxZW11X2dldF9idWZm
ZXIoZiwgKHVpbnQ4X3QgKil1cGRhdGUtPnRyYW5zX3VhZGRyLCB1cGRhdGUtPnRyYW5zX2xlbik7
DQorDQorICAgIHVwZGF0ZS0+Z3Vlc3RfdWFkZHIgPSAodW5zaWduZWQgbG9uZykgcHRyOw0KKyAg
ICB1cGRhdGUtPmd1ZXN0X2xlbiA9IHVwZGF0ZS0+dHJhbnNfbGVuOw0KKw0KKyAgICB0cmFjZV9r
dm1fc2V2X3JlY2VpdmVfdXBkYXRlX2RhdGEodHJhbnMsIHB0ciwgdXBkYXRlLT5ndWVzdF9sZW4s
DQorICAgICAgICAgICAgaGRyLCB1cGRhdGUtPmhkcl9sZW4pOw0KKw0KKyAgICByZXQgPSBzZXZf
aW9jdGwoc2V2X3N0YXRlLT5zZXZfZmQsIEtWTV9TRVZfUkVDRUlWRV9VUERBVEVfREFUQSwNCisg
ICAgICAgICAgICAgICAgICAgIHVwZGF0ZSwgJmZ3X2Vycm9yKTsNCisgICAgaWYgKHJldCkgew0K
KyAgICAgICAgZXJyb3JfcmVwb3J0KCJFcnJvciBSRUNFSVZFX1VQREFURV9EQVRBIHJldD0lZCBm
d19lcnJvcj0lZCAnJXMnIiwNCisgICAgICAgICAgICAgICAgcmV0LCBmd19lcnJvciwgZndfZXJy
b3JfdG9fc3RyKGZ3X2Vycm9yKSk7DQorICAgICAgICBnb3RvIGVycjsNCisgICAgfQ0KK2VycjoN
CisgICAgZ19mcmVlKHRyYW5zKTsNCisgICAgZ19mcmVlKHVwZGF0ZSk7DQorICAgIGdfZnJlZSho
ZHIpOw0KKyAgICByZXR1cm4gcmV0Ow0KK30NCisNCitpbnQgc2V2X2xvYWRfaW5jb21pbmdfcGFn
ZSh2b2lkICpoYW5kbGUsIFFFTVVGaWxlICpmLCB1aW50OF90ICpwdHIpDQorew0KKyAgICBTRVZT
dGF0ZSAqcyA9IChTRVZTdGF0ZSAqKWhhbmRsZTsNCisNCisgICAgLyogSWYgdGhpcyBpcyBmaXJz
dCBidWZmZXIgYW5kIFNFViBpcyBub3QgaW4gcmVjaWVpdmluZyBzdGF0ZSB0aGVuDQorICAgICAq
IHVzZSBSRUNFSVZFX1NUQVJUIGNvbW1hbmQgdG8gY3JlYXRlIGEgZW5jcnlwdGlvbiBjb250ZXh0
Lg0KKyAgICAgKi8NCisgICAgaWYgKCFzZXZfY2hlY2tfc3RhdGUoU0VWX1NUQVRFX1JFQ0VJVkVf
VVBEQVRFKSAmJg0KKyAgICAgICAgc2V2X3JlY2VpdmVfc3RhcnQocy0+c2V2X2luZm8sIGYpKSB7
DQorICAgICAgICByZXR1cm4gMTsNCisgICAgfQ0KKw0KKyAgICByZXR1cm4gc2V2X3JlY2VpdmVf
dXBkYXRlX2RhdGEoZiwgcHRyKTsNCit9DQorDQogc3RhdGljIHZvaWQNCiBzZXZfcmVnaXN0ZXJf
dHlwZXModm9pZCkNCiB7DQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2kzODYvdHJhY2UtZXZlbnRzIGIv
dGFyZ2V0L2kzODYvdHJhY2UtZXZlbnRzDQppbmRleCBiNDE1MTZjZjlmLi42MDk3NTJjY2E3IDEw
MDY0NA0KLS0tIGEvdGFyZ2V0L2kzODYvdHJhY2UtZXZlbnRzDQorKysgYi90YXJnZXQvaTM4Ni90
cmFjZS1ldmVudHMNCkBAIC0xOCwzICsxOCw2IEBAIGt2bV9zZXZfbGF1bmNoX2ZpbmlzaCh2b2lk
KSAiIg0KIGt2bV9zZXZfc2VuZF9zdGFydCh1aW50NjRfdCBwZGgsIGludCBsMSwgdWludDY0X3Qg
cGxhdCwgaW50IGwyLCB1aW50NjRfdCBhbWQsIGludCBsMykgInBkaCAweCUiIFBSSXg2NCAiIGxl
biAlZCBwbGF0IDB4JSIgUFJJeDY0ICIgbGVuICVkIGFtZCAweCUiIFBSSXg2NCAiIGxlbiAlZCIN
CiBrdm1fc2V2X3NlbmRfdXBkYXRlX2RhdGEodm9pZCAqc3JjLCB2b2lkICpkc3QsIGludCBsZW4p
ICJndWVzdCAlcCB0cmFucyAlcCBsZW4gJWQiDQoga3ZtX3Nldl9zZW5kX2ZpbmlzaCh2b2lkKSAi
Ig0KK2t2bV9zZXZfcmVjZWl2ZV9zdGFydChpbnQgcG9saWN5LCB2b2lkICpzZXNzaW9uLCB2b2lk
ICpwZGgpICJwb2xpY3kgMHgleCBzZXNzaW9uICVwIHBkaCAlcCINCitrdm1fc2V2X3JlY2VpdmVf
dXBkYXRlX2RhdGEodm9pZCAqc3JjLCB2b2lkICpkc3QsIGludCBsZW4sIHZvaWQgKmhkciwgaW50
IGhkcl9sZW4pICJndWVzdCAlcCB0cmFucyAlcCBsZW4gJWQgaGRyICVwIGhkcl9sZW4gJWQiDQor
a3ZtX3Nldl9yZWNlaXZlX2ZpbmlzaCh2b2lkKSAiIg0KLS0gDQoyLjE3LjENCg0K
