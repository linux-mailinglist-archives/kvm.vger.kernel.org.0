Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 61DFB42A03B
	for <lists+kvm@lfdr.de>; Tue, 12 Oct 2021 10:47:03 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S234952AbhJLItD (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Tue, 12 Oct 2021 04:49:03 -0400
Received: from mail.kernel.org ([198.145.29.99]:36066 "EHLO mail.kernel.org"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S230043AbhJLItC (ORCPT <rfc822;kvm@vger.kernel.org>);
        Tue, 12 Oct 2021 04:49:02 -0400
Received: by mail.kernel.org (Postfix) with ESMTPSA id 379A1604D2;
        Tue, 12 Oct 2021 08:47:00 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1634028421;
        bh=gaKIJ83TvgM0MYSRpj3SkIwisGIWzXjMzf4QykrWwsM=;
        h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
        b=Q7CDFuItNSzjBLqnd0aHQR6R9jIUNNmghbvG33Y6yAzDuNq/OkpN+DVorAU6Afc8e
         SzvGXopyEGhrxPQeXITuc9PoDCwgfvK4CBo4mNbHk61Wx9d9Y82/elDBGqmwhbKK+O
         K9v30qX0JCTX0QO4ZuDOGPiyF+yHVAs1Vm1uN8qlAD2PVyi5YTuohGH/Y+mJKQa41Y
         zJSSVyHqYakct7G8u9+z65MIX8FTUSWuslXUpjH10+Cn+vStWCxvcckutISEDMZ8p/
         RCi1kF3Y7WytXNiZxZMX5iX7OT8bvvhivdyk8D4yqVFMbsijmyHQfAgSHk2EIm3fLD
         wF5IJnbSttKnw==
From:   Will Deacon <will@kernel.org>
To:     kvm@vger.kernel.org, Alexandru Elisei <alexandru.elisei@arm.com>,
        julien.thierry.kdev@gmail.com
Cc:     catalin.marinas@arm.com, kernel-team@android.com,
        Will Deacon <will@kernel.org>, christoffer.dall@arm.com,
        vivek.gautam@arm.com
Subject: Re: [PATCH kvmtool 00/10] Run kvm-unit-tests with --kernel
Date:   Tue, 12 Oct 2021 09:46:54 +0100
Message-Id: <163402804886.3592955.3123326945963617623.b4-ty@kernel.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20210923144505.60776-1-alexandru.elisei@arm.com>
References: <20210923144505.60776-1-alexandru.elisei@arm.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

On Thu, 23 Sep 2021 15:44:55 +0100, Alexandru Elisei wrote:
> What prompted this series (which I really hoped will turn out smaller than
> it did) is my attempt to add support for kvmtool to kvm-unit-tests
> automated test runner [1]. When working through the review comments for
> that series, I realized that kvmtool must be able to load an initrd when
> running a test to get all the features that tests rely on.
> 
> kvm-unit-tests uses the initrd, which is expected to be a text file in the
> format key=value, to pass parameters to a test. The initrd is by default
> generated by the runner script, but the location of a custom initrd file
> can also be set using the environment variable KVM_UNIT_TEST_ENV (many
> thanks to Andrew Jones for explaining that). Contained in the automatically
> generated initrd is information about the presence of certain commits in
> the host kernel.  These commits are important because they fix serious bugs
> in KVM, and running tests which are designed to exercise the fix on systems
> where it isn't present can cause the host kernel to crash. kvm-unit-tests
> calls these bug fixing commits erratas, and their presence is signalled by
> an entry ERRATA_<commit_id>=y in the initrd.
> 
> [...]

Applied patches 1-7, 9 and 10 to kvmtool (master), thanks!

[01/10] builtin-run: Treat specifying both --kernel and --firmware as an error
        https://git.kernel.org/will/kvmtool/c/6810e75ce9e0
[02/10] builtin-run: Warn when ignoring initrd because --firmware was specified
        https://git.kernel.org/will/kvmtool/c/6cbec43ef88d
[03/10] builtin-run: Do not attempt to find vmlinux if --firmware
        https://git.kernel.org/will/kvmtool/c/638630c9f7a3
[04/10] builtin-run: Abstract argument validation into a separate function
        https://git.kernel.org/will/kvmtool/c/cce9616484bd
[05/10] Use kvm->nr_disks instead of kvm->cfg.image_count
        https://git.kernel.org/will/kvmtool/c/39ab3a0b380c
[06/10] builtin-run: Move kernel command line generation to a separate function
        https://git.kernel.org/will/kvmtool/c/a5253f7cc810
[07/10] Add --nodefaults command line argument
        https://git.kernel.org/will/kvmtool/c/5613ae26b998
[09/10] arm64: Use the default offset when the kernel image magic is not found
        https://git.kernel.org/will/kvmtool/c/5303f0964ffd
[10/10] arm64: Be more permissive when parsing the kernel header
        https://git.kernel.org/will/kvmtool/c/dc6646192057

Cheers,
-- 
Will

https://fixes.arm64.dev
https://next.arm64.dev
https://will.arm64.dev
