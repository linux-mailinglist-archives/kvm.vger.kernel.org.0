Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 91B3A23F514
	for <lists+kvm@lfdr.de>; Sat,  8 Aug 2020 01:03:15 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726166AbgHGXDO (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Fri, 7 Aug 2020 19:03:14 -0400
Received: from smtp-fw-33001.amazon.com ([207.171.190.10]:38871 "EHLO
        smtp-fw-33001.amazon.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1726066AbgHGXDN (ORCPT <rfc822;kvm@vger.kernel.org>);
        Fri, 7 Aug 2020 19:03:13 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
  d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
  t=1596841392; x=1628377392;
  h=subject:to:cc:references:from:message-id:date:
   mime-version:in-reply-to:content-transfer-encoding;
  bh=+Nyh/S6RQ1YtV2Z4wtd6bp0sFu3q/lSJQSaACXnEqfs=;
  b=usBVlFFp5IPIgUydslqBbV5AymvDt0HUIPmyi2QQ3N8/iu9bMSzK/lFO
   oOSNPrlgHZYPbwkj28ZnCO7ZmLVr/s7vGGBFDzc4s0P8Q7F4LeQWyP8w5
   eJ6I7M/KCkM5hbX9pETj5B4q3Kior4nwsTqeR42HDKgtL9w0XQ6n13oUP
   E=;
IronPort-SDR: o2oCfZGZ7GuZuo2CDUoDrmasI/Nh7W9Di8WUWCkmEv/4XESJ/Pyqn4HMQT2kJMWM78n7isY3a/
 dItx4iiBpXqQ==
X-IronPort-AV: E=Sophos;i="5.75,447,1589241600"; 
   d="scan'208";a="65209272"
Received: from sea32-co-svc-lb4-vlan3.sea.corp.amazon.com (HELO email-inbound-relay-2b-4e24fd92.us-west-2.amazon.com) ([10.47.23.38])
  by smtp-border-fw-out-33001.sea14.amazon.com with ESMTP; 07 Aug 2020 23:03:08 +0000
Received: from EX13MTAUWC001.ant.amazon.com (pdx4-ws-svc-p6-lb7-vlan2.pdx.amazon.com [10.170.41.162])
        by email-inbound-relay-2b-4e24fd92.us-west-2.amazon.com (Postfix) with ESMTPS id 8A6E4A1EE4;
        Fri,  7 Aug 2020 23:03:07 +0000 (UTC)
Received: from EX13D20UWC001.ant.amazon.com (10.43.162.244) by
 EX13MTAUWC001.ant.amazon.com (10.43.162.135) with Microsoft SMTP Server (TLS)
 id 15.0.1497.2; Fri, 7 Aug 2020 23:03:07 +0000
Received: from 38f9d3867b82.ant.amazon.com (10.43.160.48) by
 EX13D20UWC001.ant.amazon.com (10.43.162.244) with Microsoft SMTP Server (TLS)
 id 15.0.1497.2; Fri, 7 Aug 2020 23:03:05 +0000
Subject: Re: [PATCH 4/6] KVM: x86: Ensure the MSR bitmap never clears
 userspace tracked MSRs
To:     Aaron Lewis <aaronlewis@google.com>, <jmattson@google.com>
CC:     <pshier@google.com>, <oupton@google.com>, <kvm@vger.kernel.org>
References: <20200804042043.3592620-1-aaronlewis@google.com>
 <20200804042043.3592620-5-aaronlewis@google.com>
From:   Alexander Graf <graf@amazon.com>
Message-ID: <617a3e8d-755e-c7b1-7927-d8c9f1da2c58@amazon.com>
Date:   Sat, 8 Aug 2020 01:03:01 +0200
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0)
 Gecko/20100101 Thunderbird/68.11.0
MIME-Version: 1.0
In-Reply-To: <20200804042043.3592620-5-aaronlewis@google.com>
Content-Language: en-US
X-Originating-IP: [10.43.160.48]
X-ClientProxiedBy: EX13D47UWA004.ant.amazon.com (10.43.163.47) To
 EX13D20UWC001.ant.amazon.com (10.43.162.244)
Content-Type: text/plain; charset="utf-8"; format="flowed"
Content-Transfer-Encoding: base64
Sender: kvm-owner@vger.kernel.org
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

CgpPbiAwNC4wOC4yMCAwNjoyMCwgQWFyb24gTGV3aXMgd3JvdGU6Cj4gCj4gU0RNIHZvbHVtZSAz
OiAyNC42LjkgIk1TUi1CaXRtYXAgQWRkcmVzcyIgYW5kIEFQTSB2b2x1bWUgMjogMTUuMTEgIk1T
Cj4gaW50ZXJjZXB0cyIgZGVzY3JpYmUgTVNSIHBlcm1pc3Npb24gYml0bWFwcy4gIFBlcm1pc3Np
b24gYml0bWFwcyBhcmUKPiB1c2VkIHRvIGNvbnRyb2wgd2hldGhlciBhbiBleGVjdXRpb24gb2Yg
cmRtc3Igb3Igd3Jtc3Igd2lsbCBjYXVzZSBhCj4gdm0gZXhpdC4gIEZvciB1c2Vyc3BhY2UgdHJh
Y2tlZCBNU1JzIGl0IGlzIHJlcXVpcmVkIHRoZXkgY2F1c2UgYSB2bQo+IGV4aXQsIHNvIHRoZSBo
b3N0IGlzIGFibGUgdG8gZm9yd2FyZCB0aGUgTVNSIHRvIHVzZXJzcGFjZS4gIFRoaXMgY2hhbmdl
Cj4gYWRkcyB2bXgvc3ZtIHN1cHBvcnQgdG8gZW5zdXJlIHRoZSBwZXJtaXNzaW9uIGJpdG1hcCBp
cyBwcm9wZXJseSBzZXQgdG8KPiBjYXVzZSBhIHZtX2V4aXQgdG8gdGhlIGhvc3Qgd2hlbiByZG1z
ciBvciB3cm1zciBpcyB1c2VkIGJ5IG9uZSBvZiB0aGUKPiB1c2Vyc3BhY2UgdHJhY2tlZCBNU1Jz
LiAgQWxzbywgdG8gYXZvaWQgcmVwZWF0ZWRseSBzZXR0aW5nIHRoZW0sCj4ga3ZtX21ha2VfcmVx
dWVzdCgpIGlzIHVzZWQgdG8gY29hbGVzY2UgdGhlc2UgaW50byBhIHNpbmdsZSBjYWxsLgoKSSBt
aWdodCBoYXZlIHNvbWUgZnVuZGFtZW50YWwgbWlzdW5kZXJzdGFuZGluZyBoZXJlOgoKMSkgWW91
IGZvcmNlIHRoYXQgdGhlIGxpc3Qgb2YgdHJhcHBlZCBNU1JzIGlzIHNldCBiZWZvcmUgdkNQVSBj
cmVhdGlvbiwgCnNvIGF0IHRoZSBwb2ludCBvZiB2Q1BVIGNyZWF0aW9uLCB5b3Uga25vdyBhbHJl
YWR5IHdoaWNoIE1TUnMgc2hvdWxkIAp0cmFwIHRvIHVzZXIgc3BhY2UKCjIpIE1TUiBpbnRlcmNl
cHQgYml0bWFwcyBhcmUgKEFGQUlLKSBhbGwgc2V0IHRvICJ0cmFwIGJ5IGRlZmF1bHQiLiBUaGF0
IAptZWFucyBhbnkgTVNSIHRoYXQgd2Ugd2FudCB0aGUgZ3Vlc3QgdG8gZ2V0IGRpcmVjdCBhY2Nl
c3MgdG8gbmVlZHMgCmV4cGxpY2l0IG9wdC1pbiB0aHJvdWdoIGJpdG1hcCBtb2RpZmljYXRpb25z
LgoKVGhhdCBtZWFucyBpZiB5b3Ugc2ltcGx5IGNoZWNrIHdoZXRoZXIgYW4gTVNSIGlzIHN1cHBv
c2VkIHRvIHRyYXAgdG8gCnVzZXIgc3BhY2UgaW4gdGhlIGJpdG1hcCBzZXQgcGF0aCwgeW91IGRv
bid0IG5lZWQgYW55IG9mIHRoZSBjb21wbGljYXRlZCAKbG9naWMgYmVsb3csIG5vPwoKCkFsZXgK
Cj4gCj4gU2lnbmVkLW9mZi1ieTogQWFyb24gTGV3aXMgPGFhcm9ubGV3aXNAZ29vZ2xlLmNvbT4K
PiBSZXZpZXdlZC1ieTogT2xpdmVyIFVwdG9uIDxvdXB0b25AZ29vZ2xlLmNvbT4KPiAtLS0KPiAg
IGFyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9ob3N0LmggfCAgMyArKwo+ICAgYXJjaC94ODYva3Zt
L3N2bS9zdm0uYyAgICAgICAgICB8IDQ5ICsrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0t
LQo+ICAgYXJjaC94ODYva3ZtL3ZteC92bXguYyAgICAgICAgICB8IDEzICsrKysrKysrLQo+ICAg
YXJjaC94ODYva3ZtL3g4Ni5jICAgICAgICAgICAgICB8IDE2ICsrKysrKysrKysrCj4gICA0IGZp
bGVzIGNoYW5nZWQsIDcwIGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYg
LS1naXQgYS9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oIGIvYXJjaC94ODYvaW5jbHVk
ZS9hc20va3ZtX2hvc3QuaAo+IGluZGV4IDUxMDA1NTQ3MWRkMC4uMDdhODVmNWYwYjhhIDEwMDY0
NAo+IC0tLSBhL2FyY2gveDg2L2luY2x1ZGUvYXNtL2t2bV9ob3N0LmgKPiArKysgYi9hcmNoL3g4
Ni9pbmNsdWRlL2FzbS9rdm1faG9zdC5oCj4gQEAgLTg3LDYgKzg3LDcgQEAKPiAgICNkZWZpbmUg
S1ZNX1JFUV9IVl9UTEJfRkxVU0ggXAo+ICAgICAgICAgIEtWTV9BUkNIX1JFUV9GTEFHUygyNywg
S1ZNX1JFUVVFU1RfTk9fV0FLRVVQKQo+ICAgI2RlZmluZSBLVk1fUkVRX0FQRl9SRUFEWSAgICAg
ICAgICAgICAgS1ZNX0FSQ0hfUkVRKDI4KQo+ICsjZGVmaW5lIEtWTV9SRVFfVVNFUl9NU1JfVVBE
QVRFIEtWTV9BUkNIX1JFUSgyOSkKPiAKPiAgICNkZWZpbmUgQ1IwX1JFU0VSVkVEX0JJVFMgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKPiAgICAgICAgICAo
fih1bnNpZ25lZCBsb25nKShYODZfQ1IwX1BFIHwgWDg2X0NSMF9NUCB8IFg4Nl9DUjBfRU0gfCBY
ODZfQ1IwX1RTIFwKPiBAQCAtMTI3MSw2ICsxMjcyLDggQEAgc3RydWN0IGt2bV94ODZfb3BzIHsK
PiAgICAgICAgICBpbnQgKCplbmFibGVfZGlyZWN0X3RsYmZsdXNoKShzdHJ1Y3Qga3ZtX3ZjcHUg
KnZjcHUpOwo+IAo+ICAgICAgICAgIHZvaWQgKCptaWdyYXRlX3RpbWVycykoc3RydWN0IGt2bV92
Y3B1ICp2Y3B1KTsKPiArCj4gKyAgICAgICB2b2lkICgqc2V0X3VzZXJfbXNyX2ludGVyY2VwdCko
c3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgbXNyKTsKPiAgIH07Cj4gCj4gICBzdHJ1Y3Qga3Zt
X3g4Nl9uZXN0ZWRfb3BzIHsKPiBkaWZmIC0tZ2l0IGEvYXJjaC94ODYva3ZtL3N2bS9zdm0uYyBi
L2FyY2gveDg2L2t2bS9zdm0vc3ZtLmMKPiBpbmRleCBlYjY3M2I1OWY3YjcuLmM1NjBkMjgzYjJh
ZiAxMDA2NDQKPiAtLS0gYS9hcmNoL3g4Ni9rdm0vc3ZtL3N2bS5jCj4gKysrIGIvYXJjaC94ODYv
a3ZtL3N2bS9zdm0uYwo+IEBAIC01ODMsMTMgKzU4MywyNyBAQCBzdGF0aWMgYm9vbCBtc3Jfd3Jp
dGVfaW50ZXJjZXB0ZWQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgbXNyKQo+ICAgICAgICAg
IHJldHVybiAhIXRlc3RfYml0KGJpdF93cml0ZSwgICZ0bXApOwo+ICAgfQo+IAo+ICtzdGF0aWMg
dm9pZCBfX3NldF9tc3JfaW50ZXJjZXB0aW9uKHUzMiAqbXNycG0sIHUzMiBtc3IsIGludCByZWFk
LCBpbnQgd3JpdGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgb2Zm
c2V0KQo+ICt7Cj4gKyAgICAgICB1OCBiaXRfcmVhZCwgYml0X3dyaXRlOwo+ICsgICAgICAgdW5z
aWduZWQgbG9uZyB0bXA7Cj4gKwo+ICsgICAgICAgYml0X3JlYWQgID0gMiAqIChtc3IgJiAweDBm
KTsKPiArICAgICAgIGJpdF93cml0ZSA9IDIgKiAobXNyICYgMHgwZikgKyAxOwo+ICsgICAgICAg
dG1wICAgICAgID0gbXNycG1bb2Zmc2V0XTsKPiArCj4gKyAgICAgICByZWFkICA/IGNsZWFyX2Jp
dChiaXRfcmVhZCwgICZ0bXApIDogc2V0X2JpdChiaXRfcmVhZCwgICZ0bXApOwo+ICsgICAgICAg
d3JpdGUgPyBjbGVhcl9iaXQoYml0X3dyaXRlLCAmdG1wKSA6IHNldF9iaXQoYml0X3dyaXRlLCAm
dG1wKTsKPiArCj4gKyAgICAgICBtc3JwbVtvZmZzZXRdID0gdG1wOwo+ICt9Cj4gKwo+ICAgc3Rh
dGljIHZvaWQgc2V0X21zcl9pbnRlcmNlcHRpb24oc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIg
bXNyLCBpbnQgcmVhZCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHdy
aXRlKQo+ICAgewo+ICAgICAgICAgIHN0cnVjdCB2Y3B1X3N2bSAqc3ZtID0gdG9fc3ZtKHZjcHUp
Owo+ICAgICAgICAgIHUzMiAqbXNycG0gPSBzdm0tPm1zcnBtOwo+IC0gICAgICAgdTggYml0X3Jl
YWQsIGJpdF93cml0ZTsKPiAtICAgICAgIHVuc2lnbmVkIGxvbmcgdG1wOwo+ICAgICAgICAgIHUz
MiBvZmZzZXQ7Cj4gCj4gICAgICAgICAgLyoKPiBAQCAtNTk4LDE3ICs2MTIsMzAgQEAgc3RhdGlj
IHZvaWQgc2V0X21zcl9pbnRlcmNlcHRpb24oc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgbXNy
LCBpbnQgcmVhZCwKPiAgICAgICAgICAgKi8KPiAgICAgICAgICBXQVJOX09OKCF2YWxpZF9tc3Jf
aW50ZXJjZXB0KG1zcikpOwo+IAo+IC0gICAgICAgb2Zmc2V0ICAgID0gc3ZtX21zcnBtX29mZnNl
dChtc3IpOwo+IC0gICAgICAgYml0X3JlYWQgID0gMiAqIChtc3IgJiAweDBmKTsKPiAtICAgICAg
IGJpdF93cml0ZSA9IDIgKiAobXNyICYgMHgwZikgKyAxOwo+IC0gICAgICAgdG1wICAgICAgID0g
bXNycG1bb2Zmc2V0XTsKPiAtCj4gKyAgICAgICBvZmZzZXQgPSBzdm1fbXNycG1fb2Zmc2V0KG1z
cik7Cj4gICAgICAgICAgQlVHX09OKG9mZnNldCA9PSBNU1JfSU5WQUxJRCk7Cj4gCj4gLSAgICAg
ICByZWFkICA/IGNsZWFyX2JpdChiaXRfcmVhZCwgICZ0bXApIDogc2V0X2JpdChiaXRfcmVhZCwg
ICZ0bXApOwo+IC0gICAgICAgd3JpdGUgPyBjbGVhcl9iaXQoYml0X3dyaXRlLCAmdG1wKSA6IHNl
dF9iaXQoYml0X3dyaXRlLCAmdG1wKTsKPiArICAgICAgIF9fc2V0X21zcl9pbnRlcmNlcHRpb24o
bXNycG0sIG1zciwgcmVhZCwgd3JpdGUsIG9mZnNldCk7Cj4gCj4gLSAgICAgICBtc3JwbVtvZmZz
ZXRdID0gdG1wOwo+ICsgICAgICAgaWYgKHJlYWQgfHwgd3JpdGUpCj4gKyAgICAgICAgICAgICAg
IGt2bV9tYWtlX3JlcXVlc3QoS1ZNX1JFUV9VU0VSX01TUl9VUERBVEUsIHZjcHUpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBzZXRfdXNlcl9tc3JfaW50ZXJjZXB0aW9uKHN0cnVjdCBrdm1fdmNw
dSAqdmNwdSwgdTMyIG1zciwgaW50IHJlYWQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgd3JpdGUpCj4gK3sKPiArICAgICAgIHN0cnVjdCB2Y3B1X3N2bSAqc3Zt
ID0gdG9fc3ZtKHZjcHUpOwo+ICsgICAgICAgdTMyICptc3JwbSA9IHN2bS0+bXNycG07Cj4gKyAg
ICAgICB1MzIgb2Zmc2V0Owo+ICsKPiArICAgICAgIG9mZnNldCA9IHN2bV9tc3JwbV9vZmZzZXQo
bXNyKTsKPiArICAgICAgIGlmIChvZmZzZXQgIT0gTVNSX0lOVkFMSUQpCj4gKyAgICAgICAgICAg
ICAgIF9fc2V0X21zcl9pbnRlcmNlcHRpb24obXNycG0sIG1zciwgcmVhZCwgd3JpdGUsIG9mZnNl
dCk7Cj4gK30KPiArCj4gK3ZvaWQgc3ZtX3NldF91c2VyX21zcl9pbnRlcmNlcHQoc3RydWN0IGt2
bV92Y3B1ICp2Y3B1LCB1MzIgbXNyKQo+ICt7Cj4gKyAgICAgICBzZXRfdXNlcl9tc3JfaW50ZXJj
ZXB0aW9uKHZjcHUsIG1zciwgMCwgMCk7Cj4gICB9Cj4gCj4gICBzdGF0aWMgdm9pZCBzdm1fdmNw
dV9pbml0X21zcnBtKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwgdTMyICptc3JwbSkKPiBAQCAtNDA4
OCw2ICs0MTE1LDggQEAgc3RhdGljIHN0cnVjdCBrdm1feDg2X29wcyBzdm1feDg2X29wcyBfX2lu
aXRkYXRhID0gewo+ICAgICAgICAgIC5uZWVkX2VtdWxhdGlvbl9vbl9wYWdlX2ZhdWx0ID0gc3Zt
X25lZWRfZW11bGF0aW9uX29uX3BhZ2VfZmF1bHQsCj4gCj4gICAgICAgICAgLmFwaWNfaW5pdF9z
aWduYWxfYmxvY2tlZCA9IHN2bV9hcGljX2luaXRfc2lnbmFsX2Jsb2NrZWQsCj4gKwo+ICsgICAg
ICAgLnNldF91c2VyX21zcl9pbnRlcmNlcHQgPSBzdm1fc2V0X3VzZXJfbXNyX2ludGVyY2VwdCwK
PiAgIH07Cj4gCj4gICBzdGF0aWMgc3RydWN0IGt2bV94ODZfaW5pdF9vcHMgc3ZtX2luaXRfb3Bz
IF9faW5pdGRhdGEgPSB7Cj4gZGlmZiAtLWdpdCBhL2FyY2gveDg2L2t2bS92bXgvdm14LmMgYi9h
cmNoL3g4Ni9rdm0vdm14L3ZteC5jCj4gaW5kZXggMTMxM2U0N2E1YTFlLi4zZDNkOWVhZWNhNjQg
MTAwNjQ0Cj4gLS0tIGEvYXJjaC94ODYva3ZtL3ZteC92bXguYwo+ICsrKyBiL2FyY2gveDg2L2t2
bS92bXgvdm14LmMKPiBAQCAtMzcyOCw2ICszNzI4LDEwIEBAIHN0YXRpYyBfX2Fsd2F5c19pbmxp
bmUgdm9pZCB2bXhfZGlzYWJsZV9pbnRlcmNlcHRfZm9yX21zcihzdHJ1Y3Qga3ZtX3ZjcHUgKnZj
cHUsCj4gICAgICAgICAgICAgICAgICAgICAgICAgIF9fY2xlYXJfYml0KG1zciwgbXNyX2JpdG1h
cCArIDB4YzAwIC8gZik7Cj4gCj4gICAgICAgICAgfQo+ICsKPiArICAgICAgIGlmICh0eXBlICYg
TVNSX1RZUEVfUiB8fCB0eXBlICYgTVNSX1RZUEVfVykgewo+ICsgICAgICAgICAgICAgICBrdm1f
bWFrZV9yZXF1ZXN0KEtWTV9SRVFfVVNFUl9NU1JfVVBEQVRFLCB2Y3B1KTsKPiArICAgICAgIH0K
PiAgIH0KPiAKPiAgIHN0YXRpYyBfX2Fsd2F5c19pbmxpbmUgdm9pZCB2bXhfZW5hYmxlX2ludGVy
Y2VwdF9mb3JfbXNyKHN0cnVjdCBrdm1fdmNwdSAqdmNwdSwKPiBAQCAtMzc5NSw3ICszNzk5LDcg
QEAgc3RhdGljIHU4IHZteF9tc3JfYml0bWFwX21vZGUoc3RydWN0IGt2bV92Y3B1ICp2Y3B1KQo+
ICAgfQo+IAo+ICAgc3RhdGljIHZvaWQgdm14X3VwZGF0ZV9tc3JfYml0bWFwX3gyYXBpYyhzdHJ1
Y3Qga3ZtX3ZjcHUgKnZjcHUsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBsb25nICptc3JfYml0bWFwLCB1OCBtb2RlKQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICptc3JfYml0bWFwLCB1OCBt
b2RlKQo+ICAgewo+ICAgICAgICAgIGludCBtc3I7Cj4gCj4gQEAgLTM4MTksNiArMzgyMywxMSBA
QCBzdGF0aWMgdm9pZCB2bXhfdXBkYXRlX21zcl9iaXRtYXBfeDJhcGljKHN0cnVjdCBrdm1fdmNw
dSAqdmNwdSwKPiAgICAgICAgICB9Cj4gICB9Cj4gCj4gK3ZvaWQgdm14X3NldF91c2VyX21zcl9p
bnRlcmNlcHQoc3RydWN0IGt2bV92Y3B1ICp2Y3B1LCB1MzIgbXNyKQo+ICt7Cj4gKyAgICAgICB2
bXhfZW5hYmxlX2ludGVyY2VwdF9mb3JfbXNyKHZjcHUsIG1zciwgTVNSX1RZUEVfUlcpOwo+ICt9
Cj4gKwo+ICAgdm9pZCB2bXhfdXBkYXRlX21zcl9iaXRtYXAoc3RydWN0IGt2bV92Y3B1ICp2Y3B1
KQo+ICAgewo+ICAgICAgICAgIHN0cnVjdCB2Y3B1X3ZteCAqdm14ID0gdG9fdm14KHZjcHUpOwo+
IEBAIC03OTY1LDYgKzc5NzQsOCBAQCBzdGF0aWMgc3RydWN0IGt2bV94ODZfb3BzIHZteF94ODZf
b3BzIF9faW5pdGRhdGEgPSB7Cj4gICAgICAgICAgLm5lZWRfZW11bGF0aW9uX29uX3BhZ2VfZmF1
bHQgPSB2bXhfbmVlZF9lbXVsYXRpb25fb25fcGFnZV9mYXVsdCwKPiAgICAgICAgICAuYXBpY19p
bml0X3NpZ25hbF9ibG9ja2VkID0gdm14X2FwaWNfaW5pdF9zaWduYWxfYmxvY2tlZCwKPiAgICAg
ICAgICAubWlncmF0ZV90aW1lcnMgPSB2bXhfbWlncmF0ZV90aW1lcnMsCj4gKwo+ICsgICAgICAg
LnNldF91c2VyX21zcl9pbnRlcmNlcHQgPSB2bXhfc2V0X3VzZXJfbXNyX2ludGVyY2VwdCwKPiAg
IH07Cj4gCj4gICBzdGF0aWMgX19pbml0IGludCBoYXJkd2FyZV9zZXR1cCh2b2lkKQo+IGRpZmYg
LS1naXQgYS9hcmNoL3g4Ni9rdm0veDg2LmMgYi9hcmNoL3g4Ni9rdm0veDg2LmMKPiBpbmRleCA0
NzYxOWI0OTgxOGEuLjQ1YmY1OWY5NGQzNCAxMDA2NDQKPiAtLS0gYS9hcmNoL3g4Ni9rdm0veDg2
LmMKPiArKysgYi9hcmNoL3g4Ni9rdm0veDg2LmMKPiBAQCAtMzUzNyw2ICszNTM3LDE5IEBAIGJv
b2wga3ZtX21zcl91c2VyX2V4aXQoc3RydWN0IGt2bSAqa3ZtLCB1MzIgaW5kZXgpCj4gICB9Cj4g
ICBFWFBPUlRfU1lNQk9MX0dQTChrdm1fbXNyX3VzZXJfZXhpdCk7Cj4gCj4gK3N0YXRpYyB2b2lk
IGt2bV9zZXRfdXNlcl9tc3JfaW50ZXJjZXB0cyhzdHJ1Y3Qga3ZtX3ZjcHUgKnZjcHUpCj4gK3sK
PiArICAgICAgIHN0cnVjdCBrdm1fbXNyX2xpc3QgKm1zcl9saXN0ID0gdmNwdS0+a3ZtLT5hcmNo
LnVzZXJfZXhpdF9tc3JzOwo+ICsgICAgICAgdTMyIGksIG1zcjsKPiArCj4gKyAgICAgICBpZiAo
bXNyX2xpc3QpIHsKPiArICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG1zcl9saXN0LT5u
bXNyczsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgbXNyID0gbXNyX2xpc3QtPmlu
ZGljZXNbaV07Cj4gKyAgICAgICAgICAgICAgICAgICAgICAga3ZtX3g4Nl9vcHMuc2V0X3VzZXJf
bXNyX2ludGVyY2VwdCh2Y3B1LCBtc3IpOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICB9
Cj4gK30KPiArCj4gICBpbnQga3ZtX3ZtX2lvY3RsX2NoZWNrX2V4dGVuc2lvbihzdHJ1Y3Qga3Zt
ICprdm0sIGxvbmcgZXh0KQo+ICAgewo+ICAgICAgICAgIGludCByID0gMDsKPiBAQCAtODU1Myw2
ICs4NTY2LDkgQEAgc3RhdGljIGludCB2Y3B1X2VudGVyX2d1ZXN0KHN0cnVjdCBrdm1fdmNwdSAq
dmNwdSkKPiAgICAgICAgICAgICAgICAgICAgICAgICAga3ZtX3ZjcHVfdXBkYXRlX2FwaWN2KHZj
cHUpOwo+ICAgICAgICAgICAgICAgICAgaWYgKGt2bV9jaGVja19yZXF1ZXN0KEtWTV9SRVFfQVBG
X1JFQURZLCB2Y3B1KSkKPiAgICAgICAgICAgICAgICAgICAgICAgICAga3ZtX2NoZWNrX2FzeW5j
X3BmX2NvbXBsZXRpb24odmNwdSk7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoa3ZtX2NoZWNr
X3JlcXVlc3QoS1ZNX1JFUV9VU0VSX01TUl9VUERBVEUsIHZjcHUpKQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGt2bV9zZXRfdXNlcl9tc3JfaW50ZXJjZXB0cyh2Y3B1KTsKPiAgICAgICAgICB9
Cj4gCj4gICAgICAgICAgaWYgKGt2bV9jaGVja19yZXF1ZXN0KEtWTV9SRVFfRVZFTlQsIHZjcHUp
IHx8IHJlcV9pbnRfd2luKSB7Cj4gLS0KPiAyLjI4LjAuMTYzLmc2MTA0Y2MyZjBiNi1nb29nCj4g
CgoKCkFtYXpvbiBEZXZlbG9wbWVudCBDZW50ZXIgR2VybWFueSBHbWJICktyYXVzZW5zdHIuIDM4
CjEwMTE3IEJlcmxpbgpHZXNjaGFlZnRzZnVlaHJ1bmc6IENocmlzdGlhbiBTY2hsYWVnZXIsIEpv
bmF0aGFuIFdlaXNzCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVu
dGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCg==

