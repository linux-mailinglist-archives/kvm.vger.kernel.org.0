Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id BF013415CD1
	for <lists+kvm@lfdr.de>; Thu, 23 Sep 2021 13:29:55 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S240565AbhIWLbZ (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Thu, 23 Sep 2021 07:31:25 -0400
Received: from smtp-fw-6001.amazon.com ([52.95.48.154]:17123 "EHLO
        smtp-fw-6001.amazon.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S238930AbhIWLbZ (ORCPT <rfc822;kvm@vger.kernel.org>);
        Thu, 23 Sep 2021 07:31:25 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
  d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
  t=1632396594; x=1663932594;
  h=from:to:cc:subject:date:message-id:mime-version:
   content-transfer-encoding;
  bh=9oc7KcUgotG5DyBrzd2WLdKjEqKFBb3lZ964sBEFK54=;
  b=BHMRmSCcLYQuEZ1aPMVVsqak8pR4l4m3XkOXpWaiOf2kIKBi1e27NPnb
   TAFErLYRZiR/5fK9Tn3JAgzlM39QLgbamfw7CEHp2Qs0VUMdeA0LWV6YP
   DmciKKrAgCk8bx65fCDihmPj6kHpApwGbxeQT2V+a3J40c5T1ti4vwADu
   w=;
X-IronPort-AV: E=Sophos;i="5.85,316,1624320000"; 
   d="scan'208";a="144023350"
Received: from iad12-co-svc-p1-lb1-vlan3.amazon.com (HELO email-inbound-relay-iad-1d-10222bbc.us-east-1.amazon.com) ([10.43.8.6])
  by smtp-border-fw-6001.iad6.amazon.com with ESMTP; 23 Sep 2021 11:29:46 +0000
Received: from EX13MTAUWC002.ant.amazon.com (iad12-ws-svc-p26-lb9-vlan3.iad.amazon.com [10.40.163.38])
        by email-inbound-relay-iad-1d-10222bbc.us-east-1.amazon.com (Postfix) with ESMTPS id 4B77B1A0E23;
        Thu, 23 Sep 2021 11:29:44 +0000 (UTC)
Received: from EX13D20UWC001.ant.amazon.com (10.43.162.244) by
 EX13MTAUWC002.ant.amazon.com (10.43.162.240) with Microsoft SMTP Server (TLS)
 id 15.0.1497.23; Thu, 23 Sep 2021 11:29:43 +0000
Received: from u79c5a0a55de558.ant.amazon.com (10.43.160.137) by
 EX13D20UWC001.ant.amazon.com (10.43.162.244) with Microsoft SMTP Server (TLS)
 id 15.0.1497.23; Thu, 23 Sep 2021 11:29:40 +0000
From:   Alexander Graf <graf@amazon.com>
To:     <kvm@vger.kernel.org>
CC:     Paolo Bonzini <pbonzini@redhat.com>,
        Daniele Ahmed <ahmeddan@amazon.com>,
        Thomas Huth <thuth@redhat.com>,
        Sean Christopherson <sean.j.christopherson@intel.com>,
        Andrew Jones <drjones@redhat.com>,
        "Vitaly Kuznetsov" <vkuznets@redhat.com>
Subject: [PATCH v2] scripts: Add get_maintainer.pl
Date:   Thu, 23 Sep 2021 13:29:33 +0200
Message-ID: <20210923112933.20476-1-graf@amazon.com>
X-Mailer: git-send-email 2.28.0.394.ge197136389
MIME-Version: 1.0
X-Originating-IP: [10.43.160.137]
X-ClientProxiedBy: EX13D02UWB002.ant.amazon.com (10.43.161.160) To
 EX13D20UWC001.ant.amazon.com (10.43.162.244)
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

V2hpbGUgd2UgYWRvcHRlZCB0aGUgTUFJTlRBSU5FUlMgZmlsZSBpbiBrdm0tdW5pdC10ZXN0cywg
dGhlIHRvb2wgdG8KZGV0ZXJtaW5lIHdobyB0byBDQyBvbiBwYXRjaCBzdWJtaXNzaW9ucyBpcyBz
dGlsbCBtaXNzaW5nLgoKQ29weSBMaW51eCdzIHZlcnNpb24gb3ZlciBhbmQgYWRqdXN0IGl0IHRv
IHdvcmsgd2l0aCBhbmQgY2FsbCBvdXQgdGhlCmt2bS11bml0LXRlc3RzIHRyZWUuCgpTaWduZWQt
b2ZmLWJ5OiBBbGV4YW5kZXIgR3JhZiA8Z3JhZkBhbWF6b24uY29tPgoKLS0tCgp2MSAtPiB2MjoK
CiAgLSBSZW1vdmUgUGVuZ2l1biBDaGllZiBsb2dpYwotLS0KIHNjcmlwdHMvZ2V0X21haW50YWlu
ZXIucGwgfCAyNTQzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDEgZmls
ZSBjaGFuZ2VkLCAyNTQzIGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDc1NSBzY3JpcHRz
L2dldF9tYWludGFpbmVyLnBsCgpkaWZmIC0tZ2l0IGEvc2NyaXB0cy9nZXRfbWFpbnRhaW5lci5w
bCBiL3NjcmlwdHMvZ2V0X21haW50YWluZXIucGwKbmV3IGZpbGUgbW9kZSAxMDA3NTUKaW5kZXgg
MDAwMDAwMC4uMTE3YjY5MQotLS0gL2Rldi9udWxsCisrKyBiL3NjcmlwdHMvZ2V0X21haW50YWlu
ZXIucGwKQEAgLTAsMCArMSwyNTQzIEBACisjIS91c3IvYmluL2VudiBwZXJsCisjIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisjCisjIChjKSAyMDA3LCBKb2UgUGVyY2hlcyA8am9l
QHBlcmNoZXMuY29tPgorIyAgICAgICAgICAgY3JlYXRlZCBmcm9tIGNoZWNrcGF0Y2gucGwKKyMK
KyMgUHJpbnQgc2VsZWN0ZWQgTUFJTlRBSU5FUlMgaW5mb3JtYXRpb24gZm9yCisjIHRoZSBmaWxl
cyBtb2RpZmllZCBpbiBhIHBhdGNoIG9yIGZvciBhIGZpbGUKKyMKKyMgdXNhZ2U6IHBlcmwgc2Ny
aXB0cy9nZXRfbWFpbnRhaW5lci5wbCBbT1BUSU9OU10gPHBhdGNoPgorIyAgICAgICAgcGVybCBz
Y3JpcHRzL2dldF9tYWludGFpbmVyLnBsIFtPUFRJT05TXSAtZiA8ZmlsZT4KKwordXNlIHdhcm5p
bmdzOwordXNlIHN0cmljdDsKKworbXkgJFAgPSAkMDsKK215ICRWID0gJzAuMjYnOworCit1c2Ug
R2V0b3B0OjpMb25nIHF3KDpjb25maWcgbm9fYXV0b19hYmJyZXYpOwordXNlIEN3ZDsKK3VzZSBG
aWxlOjpGaW5kOwordXNlIEZpbGU6OlNwZWM6OkZ1bmN0aW9uczsKKworbXkgJGN1cl9wYXRoID0g
ZmFzdGdldGN3ZCgpIC4gJy8nOworbXkgJGxrX3BhdGggPSAiLi8iOworbXkgJGVtYWlsID0gMTsK
K215ICRlbWFpbF91c2VuYW1lID0gMTsKK215ICRlbWFpbF9tYWludGFpbmVyID0gMTsKK215ICRl
bWFpbF9yZXZpZXdlciA9IDE7CitteSAkZW1haWxfZml4ZXMgPSAxOworbXkgJGVtYWlsX2xpc3Qg
PSAxOworbXkgJGVtYWlsX21vZGVyYXRlZF9saXN0ID0gMTsKK215ICRlbWFpbF9zdWJzY3JpYmVy
X2xpc3QgPSAwOworbXkgJGVtYWlsX2dpdCA9IDA7CitteSAkZW1haWxfZ2l0X2FsbF9zaWduYXR1
cmVfdHlwZXMgPSAwOworbXkgJGVtYWlsX2dpdF9ibGFtZSA9IDA7CitteSAkZW1haWxfZ2l0X2Js
YW1lX3NpZ25hdHVyZXMgPSAxOworbXkgJGVtYWlsX2dpdF9mYWxsYmFjayA9IDE7CitteSAkZW1h
aWxfZ2l0X21pbl9zaWduYXR1cmVzID0gMTsKK215ICRlbWFpbF9naXRfbWF4X21haW50YWluZXJz
ID0gNTsKK215ICRlbWFpbF9naXRfbWluX3BlcmNlbnQgPSA1OworbXkgJGVtYWlsX2dpdF9zaW5j
ZSA9ICIxLXllYXItYWdvIjsKK215ICRlbWFpbF9oZ19zaW5jZSA9ICItMzY1IjsKK215ICRpbnRl
cmFjdGl2ZSA9IDA7CitteSAkZW1haWxfcmVtb3ZlX2R1cGxpY2F0ZXMgPSAxOworbXkgJGVtYWls
X3VzZV9tYWlsbWFwID0gMTsKK215ICRvdXRwdXRfbXVsdGlsaW5lID0gMTsKK215ICRvdXRwdXRf
c2VwYXJhdG9yID0gIiwgIjsKK215ICRvdXRwdXRfcm9sZXMgPSAwOworbXkgJG91dHB1dF9yb2xl
c3RhdHMgPSAxOworbXkgJG91dHB1dF9zZWN0aW9uX21heGxlbiA9IDUwOworbXkgJHNjbSA9IDA7
CitteSAkdHJlZSA9IDE7CitteSAkd2ViID0gMDsKK215ICRzdWJzeXN0ZW0gPSAwOworbXkgJHN0
YXR1cyA9IDA7CitteSAkbGV0dGVycyA9ICIiOworbXkgJGtleXdvcmRzID0gMTsKK215ICRzZWN0
aW9ucyA9IDA7CitteSAkZW1haWxfZmlsZV9lbWFpbHMgPSAwOworbXkgJGZyb21fZmlsZW5hbWUg
PSAwOworbXkgJHBhdHRlcm5fZGVwdGggPSAwOworbXkgJHNlbGZfdGVzdCA9IHVuZGVmOworbXkg
JHZlcnNpb24gPSAwOworbXkgJGhlbHAgPSAwOworbXkgJGZpbmRfbWFpbnRhaW5lcl9maWxlcyA9
IDA7CitteSAkbWFpbnRhaW5lcl9wYXRoOworbXkgJHZjc191c2VkID0gMDsKKworbXkgJGV4aXQg
PSAwOworCitteSBAZmlsZXMgPSAoKTsKK215IEBmaXhlcyA9ICgpOwkJCSMgSWYgYSBwYXRjaCBk
ZXNjcmlwdGlvbiBpbmNsdWRlcyBGaXhlczogbGluZXMKK215IEByYW5nZSA9ICgpOworbXkgQGtl
eXdvcmRfdHZpID0gKCk7CitteSBAZmlsZV9lbWFpbHMgPSAoKTsKKworbXkgJWNvbW1pdF9hdXRo
b3JfaGFzaDsKK215ICVjb21taXRfc2lnbmVyX2hhc2g7CisKKyMgU2lnbmF0dXJlIHR5cGVzIG9m
IHBlb3BsZSB3aG8gYXJlIGVpdGhlcgorIyAJYSkgcmVzcG9uc2libGUgZm9yIHRoZSBjb2RlIGlu
IHF1ZXN0aW9uLCBvcgorIyAJYikgZmFtaWxpYXIgZW5vdWdoIHdpdGggaXQgdG8gZ2l2ZSByZWxl
dmFudCBmZWVkYmFjaworbXkgQHNpZ25hdHVyZV90YWdzID0gKCk7CitwdXNoKEBzaWduYXR1cmVf
dGFncywgIlNpZ25lZC1vZmYtYnk6Iik7CitwdXNoKEBzaWduYXR1cmVfdGFncywgIlJldmlld2Vk
LWJ5OiIpOworcHVzaChAc2lnbmF0dXJlX3RhZ3MsICJBY2tlZC1ieToiKTsKKworbXkgJHNpZ25h
dHVyZV9wYXR0ZXJuID0gIlwoIiAuIGpvaW4oInwiLCBAc2lnbmF0dXJlX3RhZ3MpIC4gIlwpIjsK
KworIyByZmM4MjIgZW1haWwgYWRkcmVzcyAtIHByZWxvYWRlZCBtZXRob2RzIGdvIGhlcmUuCitt
eSAkcmZjODIyX2x3c3AgPSAiKD86KD86XFxyXFxuKT9bIFxcdF0pIjsKK215ICRyZmM4MjJfY2hh
ciA9ICdbXFwwMDAtXFwzNzddJzsKKworIyBWQ1MgY29tbWFuZCBzdXBwb3J0OiBjbGFzcy1saWtl
IGZ1bmN0aW9ucyBhbmQgc3RyaW5ncworCitteSAlVkNTX2NtZHM7CisKK215ICVWQ1NfY21kc19n
aXQgPSAoCisgICAgImV4ZWN1dGVfY21kIiA9PiBcJmdpdF9leGVjdXRlX2NtZCwKKyAgICAiYXZh
aWxhYmxlIiA9PiAnKHdoaWNoKCJnaXQiKSBuZSAiIikgJiYgKC1lICIuZ2l0IiknLAorICAgICJm
aW5kX3NpZ25lcnNfY21kIiA9PgorCSJnaXQgbG9nIC0tbm8tY29sb3IgLS1mb2xsb3cgLS1zaW5j
ZT1cJGVtYWlsX2dpdF9zaW5jZSAiIC4KKwkgICAgJy0tbnVtc3RhdCAtLW5vLW1lcmdlcyAnIC4K
KwkgICAgJy0tZm9ybWF0PSJHaXRDb21taXQ6ICVIJW4nIC4KKwkJICAgICAgJ0dpdEF1dGhvcjog
JWFuIDwlYWU+JW4nIC4KKwkJICAgICAgJ0dpdERhdGU6ICVhRCVuJyAuCisJCSAgICAgICdHaXRT
dWJqZWN0OiAlcyVuJyAuCisJCSAgICAgICclYiVuIicgLgorCSAgICAiIC0tIFwkZmlsZSIsCisg
ICAgImZpbmRfY29tbWl0X3NpZ25lcnNfY21kIiA9PgorCSJnaXQgbG9nIC0tbm8tY29sb3IgIiAu
CisJICAgICctLW51bXN0YXQgJyAuCisJICAgICctLWZvcm1hdD0iR2l0Q29tbWl0OiAlSCVuJyAu
CisJCSAgICAgICdHaXRBdXRob3I6ICVhbiA8JWFlPiVuJyAuCisJCSAgICAgICdHaXREYXRlOiAl
YUQlbicgLgorCQkgICAgICAnR2l0U3ViamVjdDogJXMlbicgLgorCQkgICAgICAnJWIlbiInIC4K
KwkgICAgIiAtMSBcJGNvbW1pdCIsCisgICAgImZpbmRfY29tbWl0X2F1dGhvcl9jbWQiID0+CisJ
ImdpdCBsb2cgLS1uby1jb2xvciAiIC4KKwkgICAgJy0tbnVtc3RhdCAnIC4KKwkgICAgJy0tZm9y
bWF0PSJHaXRDb21taXQ6ICVIJW4nIC4KKwkJICAgICAgJ0dpdEF1dGhvcjogJWFuIDwlYWU+JW4n
IC4KKwkJICAgICAgJ0dpdERhdGU6ICVhRCVuJyAuCisJCSAgICAgICdHaXRTdWJqZWN0OiAlcyVu
IicgLgorCSAgICAiIC0xIFwkY29tbWl0IiwKKyAgICAiYmxhbWVfcmFuZ2VfY21kIiA9PiAiZ2l0
IGJsYW1lIC1sIC1MIFwkZGlmZl9zdGFydCwrXCRkaWZmX2xlbmd0aCBcJGZpbGUiLAorICAgICJi
bGFtZV9maWxlX2NtZCIgPT4gImdpdCBibGFtZSAtbCBcJGZpbGUiLAorICAgICJjb21taXRfcGF0
dGVybiIgPT4gIl5HaXRDb21taXQ6IChbMC05YS1mXXs0MCw0MH0pIiwKKyAgICAiYmxhbWVfY29t
bWl0X3BhdHRlcm4iID0+ICJeKFswLTlhLWZdKykgIiwKKyAgICAiYXV0aG9yX3BhdHRlcm4iID0+
ICJeR2l0QXV0aG9yOiAoLiopIiwKKyAgICAic3ViamVjdF9wYXR0ZXJuIiA9PiAiXkdpdFN1Ympl
Y3Q6ICguKikiLAorICAgICJzdGF0X3BhdHRlcm4iID0+ICJeKFxcZCspXFx0KFxcZCspXFx0XCRm
aWxlXCQiLAorICAgICJmaWxlX2V4aXN0c19jbWQiID0+ICJnaXQgbHMtZmlsZXMgXCRmaWxlIiwK
KyAgICAibGlzdF9maWxlc19jbWQiID0+ICJnaXQgbHMtZmlsZXMgXCRmaWxlIiwKKyk7CisKK215
ICVWQ1NfY21kc19oZyA9ICgKKyAgICAiZXhlY3V0ZV9jbWQiID0+IFwmaGdfZXhlY3V0ZV9jbWQs
CisgICAgImF2YWlsYWJsZSIgPT4gJyh3aGljaCgiaGciKSBuZSAiIikgJiYgKC1kICIuaGciKScs
CisgICAgImZpbmRfc2lnbmVyc19jbWQiID0+CisJImhnIGxvZyAtLWRhdGU9XCRlbWFpbF9oZ19z
aW5jZSAiIC4KKwkgICAgIi0tdGVtcGxhdGU9J0hnQ29tbWl0OiB7bm9kZX1cXG4iIC4KKwkgICAg
ICAgICAgICAgICAgIkhnQXV0aG9yOiB7YXV0aG9yfVxcbiIgLgorCQkJIkhnU3ViamVjdDoge2Rl
c2N9XFxuJyIgLgorCSAgICAiIC0tIFwkZmlsZSIsCisgICAgImZpbmRfY29tbWl0X3NpZ25lcnNf
Y21kIiA9PgorCSJoZyBsb2cgIiAuCisJICAgICItLXRlbXBsYXRlPSdIZ1N1YmplY3Q6IHtkZXNj
fVxcbiciIC4KKwkgICAgIiAtciBcJGNvbW1pdCIsCisgICAgImZpbmRfY29tbWl0X2F1dGhvcl9j
bWQiID0+CisJImhnIGxvZyAiIC4KKwkgICAgIi0tdGVtcGxhdGU9J0hnQ29tbWl0OiB7bm9kZX1c
XG4iIC4KKwkJICAgICAgICAiSGdBdXRob3I6IHthdXRob3J9XFxuIiAuCisJCQkiSGdTdWJqZWN0
OiB7ZGVzY3xmaXJzdGxpbmV9XFxuJyIgLgorCSAgICAiIC1yIFwkY29tbWl0IiwKKyAgICAiYmxh
bWVfcmFuZ2VfY21kIiA9PiAiIiwJCSMgbm90IHN1cHBvcnRlZAorICAgICJibGFtZV9maWxlX2Nt
ZCIgPT4gImhnIGJsYW1lIC1uIFwkZmlsZSIsCisgICAgImNvbW1pdF9wYXR0ZXJuIiA9PiAiXkhn
Q29tbWl0OiAoWzAtOWEtZl17NDAsNDB9KSIsCisgICAgImJsYW1lX2NvbW1pdF9wYXR0ZXJuIiA9
PiAiXihbIDAtOWEtZl0rKToiLAorICAgICJhdXRob3JfcGF0dGVybiIgPT4gIl5IZ0F1dGhvcjog
KC4qKSIsCisgICAgInN1YmplY3RfcGF0dGVybiIgPT4gIl5IZ1N1YmplY3Q6ICguKikiLAorICAg
ICJzdGF0X3BhdHRlcm4iID0+ICJeKFxcZCspXHQoXFxkKylcdFwkZmlsZVwkIiwKKyAgICAiZmls
ZV9leGlzdHNfY21kIiA9PiAiaGcgZmlsZXMgXCRmaWxlIiwKKyAgICAibGlzdF9maWxlc19jbWQi
ID0+ICJoZyBtYW5pZmVzdCAtUiBcJGZpbGUiLAorKTsKKworbXkgJGNvbmYgPSB3aGljaF9jb25m
KCIuZ2V0X21haW50YWluZXIuY29uZiIpOworaWYgKC1mICRjb25mKSB7CisgICAgbXkgQGNvbmZf
YXJnczsKKyAgICBvcGVuKG15ICRjb25mZmlsZSwgJzwnLCAiJGNvbmYiKQorCW9yIHdhcm4gIiRQ
OiBDYW4ndCBmaW5kIGEgcmVhZGFibGUgLmdldF9tYWludGFpbmVyLmNvbmYgZmlsZSAkIVxuIjsK
KworICAgIHdoaWxlICg8JGNvbmZmaWxlPikgeworCW15ICRsaW5lID0gJF87CisKKwkkbGluZSA9
fiBzL1xzKlxuPyQvL2c7CisJJGxpbmUgPX4gcy9eXHMqLy9nOworCSRsaW5lID1+IHMvXHMrLyAv
ZzsKKworCW5leHQgaWYgKCRsaW5lID1+IG0vXlxzKiMvKTsKKwluZXh0IGlmICgkbGluZSA9fiBt
L15ccyokLyk7CisKKwlteSBAd29yZHMgPSBzcGxpdCgiICIsICRsaW5lKTsKKwlmb3JlYWNoIG15
ICR3b3JkIChAd29yZHMpIHsKKwkgICAgbGFzdCBpZiAoJHdvcmQgPX4gbS9eIy8pOworCSAgICBw
dXNoIChAY29uZl9hcmdzLCAkd29yZCk7CisJfQorICAgIH0KKyAgICBjbG9zZSgkY29uZmZpbGUp
OworICAgIHVuc2hpZnQoQEFSR1YsIEBjb25mX2FyZ3MpIGlmIEBjb25mX2FyZ3M7Cit9CisKK215
IEBpZ25vcmVfZW1haWxzID0gKCk7CitteSAkaWdub3JlX2ZpbGUgPSB3aGljaF9jb25mKCIuZ2V0
X21haW50YWluZXIuaWdub3JlIik7CitpZiAoLWYgJGlnbm9yZV9maWxlKSB7CisgICAgb3Blbiht
eSAkaWdub3JlLCAnPCcsICIkaWdub3JlX2ZpbGUiKQorCW9yIHdhcm4gIiRQOiBDYW4ndCBmaW5k
IGEgcmVhZGFibGUgLmdldF9tYWludGFpbmVyLmlnbm9yZSBmaWxlICQhXG4iOworICAgIHdoaWxl
ICg8JGlnbm9yZT4pIHsKKwlteSAkbGluZSA9ICRfOworCisJJGxpbmUgPX4gcy9ccypcbj8kLy87
CisJJGxpbmUgPX4gcy9eXHMqLy87CisJJGxpbmUgPX4gcy9ccyskLy87CisJJGxpbmUgPX4gcy8j
LiokLy87CisKKwluZXh0IGlmICgkbGluZSA9fiBtL15ccyokLyk7CisJaWYgKHJmYzgyMl92YWxp
ZCgkbGluZSkpIHsKKwkgICAgcHVzaChAaWdub3JlX2VtYWlscywgJGxpbmUpOworCX0KKyAgICB9
CisgICAgY2xvc2UoJGlnbm9yZSk7Cit9CisKK2lmICgkI0FSR1YgPiAwKSB7CisgICAgZm9yZWFj
aCAoQEFSR1YpIHsKKyAgICAgICAgaWYgKCRfID1+IC9eLXsxLDJ9c2VsZi10ZXN0KD86PXwkKS8p
IHsKKyAgICAgICAgICAgIGRpZSAiJFA6IHVzaW5nIC0tc2VsZi10ZXN0IGRvZXMgbm90IGFsbG93
IGFueSBvdGhlciBvcHRpb24gb3IgYXJndW1lbnRcbiI7CisgICAgICAgIH0KKyAgICB9Cit9CisK
K2lmICghR2V0T3B0aW9ucygKKwkJJ2VtYWlsIScgPT4gXCRlbWFpbCwKKwkJJ2dpdCEnID0+IFwk
ZW1haWxfZ2l0LAorCQknZ2l0LWFsbC1zaWduYXR1cmUtdHlwZXMhJyA9PiBcJGVtYWlsX2dpdF9h
bGxfc2lnbmF0dXJlX3R5cGVzLAorCQknZ2l0LWJsYW1lIScgPT4gXCRlbWFpbF9naXRfYmxhbWUs
CisJCSdnaXQtYmxhbWUtc2lnbmF0dXJlcyEnID0+IFwkZW1haWxfZ2l0X2JsYW1lX3NpZ25hdHVy
ZXMsCisJCSdnaXQtZmFsbGJhY2shJyA9PiBcJGVtYWlsX2dpdF9mYWxsYmFjaywKKwkJJ2dpdC1t
aW4tc2lnbmF0dXJlcz1pJyA9PiBcJGVtYWlsX2dpdF9taW5fc2lnbmF0dXJlcywKKwkJJ2dpdC1t
YXgtbWFpbnRhaW5lcnM9aScgPT4gXCRlbWFpbF9naXRfbWF4X21haW50YWluZXJzLAorCQknZ2l0
LW1pbi1wZXJjZW50PWknID0+IFwkZW1haWxfZ2l0X21pbl9wZXJjZW50LAorCQknZ2l0LXNpbmNl
PXMnID0+IFwkZW1haWxfZ2l0X3NpbmNlLAorCQknaGctc2luY2U9cycgPT4gXCRlbWFpbF9oZ19z
aW5jZSwKKwkJJ2l8aW50ZXJhY3RpdmUhJyA9PiBcJGludGVyYWN0aXZlLAorCQkncmVtb3ZlLWR1
cGxpY2F0ZXMhJyA9PiBcJGVtYWlsX3JlbW92ZV9kdXBsaWNhdGVzLAorCQknbWFpbG1hcCEnID0+
IFwkZW1haWxfdXNlX21haWxtYXAsCisJCSdtIScgPT4gXCRlbWFpbF9tYWludGFpbmVyLAorCQkn
ciEnID0+IFwkZW1haWxfcmV2aWV3ZXIsCisJCSduIScgPT4gXCRlbWFpbF91c2VuYW1lLAorCQkn
bCEnID0+IFwkZW1haWxfbGlzdCwKKwkJJ2ZpeGVzIScgPT4gXCRlbWFpbF9maXhlcywKKwkJJ21v
ZGVyYXRlZCEnID0+IFwkZW1haWxfbW9kZXJhdGVkX2xpc3QsCisJCSdzIScgPT4gXCRlbWFpbF9z
dWJzY3JpYmVyX2xpc3QsCisJCSdtdWx0aWxpbmUhJyA9PiBcJG91dHB1dF9tdWx0aWxpbmUsCisJ
CSdyb2xlcyEnID0+IFwkb3V0cHV0X3JvbGVzLAorCQkncm9sZXN0YXRzIScgPT4gXCRvdXRwdXRf
cm9sZXN0YXRzLAorCQknc2VwYXJhdG9yPXMnID0+IFwkb3V0cHV0X3NlcGFyYXRvciwKKwkJJ3N1
YnN5c3RlbSEnID0+IFwkc3Vic3lzdGVtLAorCQknc3RhdHVzIScgPT4gXCRzdGF0dXMsCisJCSdz
Y20hJyA9PiBcJHNjbSwKKwkJJ3RyZWUhJyA9PiBcJHRyZWUsCisJCSd3ZWIhJyA9PiBcJHdlYiwK
KwkJJ2xldHRlcnM9cycgPT4gXCRsZXR0ZXJzLAorCQkncGF0dGVybi1kZXB0aD1pJyA9PiBcJHBh
dHRlcm5fZGVwdGgsCisJCSdrfGtleXdvcmRzIScgPT4gXCRrZXl3b3JkcywKKwkJJ3NlY3Rpb25z
IScgPT4gXCRzZWN0aW9ucywKKwkJJ2ZlfGZpbGUtZW1haWxzIScgPT4gXCRlbWFpbF9maWxlX2Vt
YWlscywKKwkJJ2Z8ZmlsZScgPT4gXCRmcm9tX2ZpbGVuYW1lLAorCQknZmluZC1tYWludGFpbmVy
LWZpbGVzJyA9PiBcJGZpbmRfbWFpbnRhaW5lcl9maWxlcywKKwkJJ21wYXRofG1haW50YWluZXIt
cGF0aD1zJyA9PiBcJG1haW50YWluZXJfcGF0aCwKKwkJJ3NlbGYtdGVzdDpzJyA9PiBcJHNlbGZf
dGVzdCwKKwkJJ3Z8dmVyc2lvbicgPT4gXCR2ZXJzaW9uLAorCQknaHxoZWxwfHVzYWdlJyA9PiBc
JGhlbHAsCisJCSkpIHsKKyAgICBkaWUgIiRQOiBpbnZhbGlkIGFyZ3VtZW50IC0gdXNlIC0taGVs
cCBpZiBuZWNlc3NhcnlcbiI7Cit9CisKK2lmICgkaGVscCAhPSAwKSB7CisgICAgdXNhZ2UoKTsK
KyAgICBleGl0IDA7Cit9CisKK2lmICgkdmVyc2lvbiAhPSAwKSB7CisgICAgcHJpbnQoIiR7UH0g
JHtWfVxuIik7CisgICAgZXhpdCAwOworfQorCitpZiAoZGVmaW5lZCAkc2VsZl90ZXN0KSB7Cisg
ICAgcmVhZF9hbGxfbWFpbnRhaW5lcl9maWxlcygpOworICAgIHNlbGZfdGVzdCgpOworICAgIGV4
aXQgMDsKK30KKworaWYgKC10IFNURElOICYmICFAQVJHVikgeworICAgICMgV2UncmUgdGFsa2lu
ZyB0byBhIHRlcm1pbmFsLCBidXQgaGF2ZSBubyBjb21tYW5kIGxpbmUgYXJndW1lbnRzLgorICAg
IGRpZSAiJFA6IG1pc3NpbmcgcGF0Y2hmaWxlIG9yIC1mIGZpbGUgLSB1c2UgLS1oZWxwIGlmIG5l
Y2Vzc2FyeVxuIjsKK30KKworJG91dHB1dF9tdWx0aWxpbmUgPSAwIGlmICgkb3V0cHV0X3NlcGFy
YXRvciBuZSAiLCAiKTsKKyRvdXRwdXRfcm9sZXN0YXRzID0gMSBpZiAoJGludGVyYWN0aXZlKTsK
KyRvdXRwdXRfcm9sZXMgPSAxIGlmICgkb3V0cHV0X3JvbGVzdGF0cyk7CisKK2lmICgkc2VjdGlv
bnMgfHwgJGxldHRlcnMgbmUgIiIpIHsKKyAgICAkc2VjdGlvbnMgPSAxOworICAgICRlbWFpbCA9
IDA7CisgICAgJGVtYWlsX2xpc3QgPSAwOworICAgICRzY20gPSAwOworICAgICRzdGF0dXMgPSAw
OworICAgICRzdWJzeXN0ZW0gPSAwOworICAgICR3ZWIgPSAwOworICAgICRrZXl3b3JkcyA9IDA7
CisgICAgJGludGVyYWN0aXZlID0gMDsKK30gZWxzZSB7CisgICAgbXkgJHNlbGVjdGlvbnMgPSAk
ZW1haWwgKyAkc2NtICsgJHN0YXR1cyArICRzdWJzeXN0ZW0gKyAkd2ViOworICAgIGlmICgkc2Vs
ZWN0aW9ucyA9PSAwKSB7CisJZGllICIkUDogIE1pc3NpbmcgcmVxdWlyZWQgb3B0aW9uOiBlbWFp
bCwgc2NtLCBzdGF0dXMsIHN1YnN5c3RlbSBvciB3ZWJcbiI7CisgICAgfQorfQorCitpZiAoJGVt
YWlsICYmCisgICAgKCRlbWFpbF9tYWludGFpbmVyICsgJGVtYWlsX3Jldmlld2VyICsKKyAgICAg
JGVtYWlsX2xpc3QgKyAkZW1haWxfc3Vic2NyaWJlcl9saXN0ICsKKyAgICAgJGVtYWlsX2dpdCAr
ICRlbWFpbF9naXRfYmxhbWUpID09IDApIHsKKyAgICBkaWUgIiRQOiBQbGVhc2Ugc2VsZWN0IGF0
IGxlYXN0IDEgZW1haWwgb3B0aW9uXG4iOworfQorCisjIyBSZWFkIE1BSU5UQUlORVJTIGZvciB0
eXBlL3ZhbHVlIHBhaXJzCisKK215IEB0eXBldmFsdWUgPSAoKTsKK215ICVrZXl3b3JkX2hhc2g7
CitteSBAbWZpbGVzID0gKCk7CitteSBAc2VsZl90ZXN0X2luZm8gPSAoKTsKKworc3ViIHJlYWRf
bWFpbnRhaW5lcl9maWxlIHsKKyAgICBteSAoJGZpbGUpID0gQF87CisKKyAgICBvcGVuIChteSAk
bWFpbnQsICc8JywgIiRmaWxlIikKKwlvciBkaWUgIiRQOiBDYW4ndCBvcGVuIE1BSU5UQUlORVJT
IGZpbGUgJyRmaWxlJzogJCFcbiI7CisgICAgbXkgJGkgPSAxOworICAgIHdoaWxlICg8JG1haW50
PikgeworCW15ICRsaW5lID0gJF87CisJY2hvbXAgJGxpbmU7CisKKwlpZiAoJGxpbmUgPX4gbS9e
KFtBLVpdKTpccyooLiopLykgeworCSAgICBteSAkdHlwZSA9ICQxOworCSAgICBteSAkdmFsdWUg
PSAkMjsKKworCSAgICAjI0ZpbGVuYW1lIHBhdHRlcm4gbWF0Y2hpbmcKKwkgICAgaWYgKCR0eXBl
IGVxICJGIiB8fCAkdHlwZSBlcSAiWCIpIHsKKwkJJHZhbHVlID1+IHNAXC5AXFxcLkBnOyAgICAg
ICAjI0NvbnZlcnQgLiB0byBcLgorCQkkdmFsdWUgPX4gcy9cKi9cLlwqL2c7ICAgICAgICMjQ29u
dmVydCAqIHRvIC4qCisJCSR2YWx1ZSA9fiBzL1w/L1wuL2c7ICAgICAgICAgIyNDb252ZXJ0ID8g
dG8gLgorCQkjI2lmIHBhdHRlcm4gaXMgYSBkaXJlY3RvcnkgYW5kIGl0IGxhY2tzIGEgdHJhaWxp
bmcgc2xhc2gsIGFkZCBvbmUKKwkJaWYgKCgtZCAkdmFsdWUpKSB7CisJCSAgICAkdmFsdWUgPX4g
c0AoW14vXSkkQCQxL0A7CisJCX0KKwkgICAgfSBlbHNpZiAoJHR5cGUgZXEgIksiKSB7CisJCSRr
ZXl3b3JkX2hhc2h7QHR5cGV2YWx1ZX0gPSAkdmFsdWU7CisJICAgIH0KKwkgICAgcHVzaChAdHlw
ZXZhbHVlLCAiJHR5cGU6JHZhbHVlIik7CisJfSBlbHNpZiAoISgvXlxzKiQvIHx8IC9eXHMqXCMv
KSkgeworCSAgICBwdXNoKEB0eXBldmFsdWUsICRsaW5lKTsKKwl9CisJaWYgKGRlZmluZWQgJHNl
bGZfdGVzdCkgeworCSAgICBwdXNoKEBzZWxmX3Rlc3RfaW5mbywge2ZpbGU9PiRmaWxlLCBsaW5l
bnI9PiRpLCBsaW5lPT4kbGluZX0pOworCX0KKwkkaSsrOworICAgIH0KKyAgICBjbG9zZSgkbWFp
bnQpOworfQorCitzdWIgZmluZF9pc19tYWludGFpbmVyX2ZpbGUgeworICAgIG15ICgkZmlsZSkg
PSAkXzsKKyAgICByZXR1cm4gaWYgKCRmaWxlICF+IG1AL01BSU5UQUlORVJTJEApOworICAgICRm
aWxlID0gJEZpbGU6OkZpbmQ6Om5hbWU7CisgICAgcmV0dXJuIGlmICghIC1mICRmaWxlKTsKKyAg
ICBwdXNoKEBtZmlsZXMsICRmaWxlKTsKK30KKworc3ViIGZpbmRfaWdub3JlX2dpdCB7CisgICAg
cmV0dXJuIGdyZXAgeyAkXyAhfiAvXlwuZ2l0JC87IH0gQF87Cit9CisKK3JlYWRfYWxsX21haW50
YWluZXJfZmlsZXMoKTsKKworc3ViIHJlYWRfYWxsX21haW50YWluZXJfZmlsZXMgeworICAgIG15
ICRwYXRoID0gIiR7bGtfcGF0aH1NQUlOVEFJTkVSUyI7CisgICAgaWYgKGRlZmluZWQgJG1haW50
YWluZXJfcGF0aCkgeworCSRwYXRoID0gJG1haW50YWluZXJfcGF0aDsKKwkjIFBlcmwgQ29va2Jv
b2sgdGlsZGUgZXhwYW5zaW9uIGlmIG5lY2Vzc2FyeQorCSRwYXRoID1+IHNAXn4oW14vXSopQCAk
MSA/IChnZXRwd25hbSgkMSkpWzddIDogKCAkRU5We0hPTUV9IHx8ICRFTlZ7TE9HRElSfSB8fCAo
Z2V0cHd1aWQoJDwpKVs3XSlAZXg7CisgICAgfQorCisgICAgaWYgKC1kICRwYXRoKSB7CisJJHBh
dGggLj0gJy8nIGlmICgkcGF0aCAhfiBtQC8kQCk7CisJaWYgKCRmaW5kX21haW50YWluZXJfZmls
ZXMpIHsKKwkgICAgZmluZCggeyB3YW50ZWQgPT4gXCZmaW5kX2lzX21haW50YWluZXJfZmlsZSwK
KwkJICAgIHByZXByb2Nlc3MgPT4gXCZmaW5kX2lnbm9yZV9naXQsCisJCSAgICBub19jaGRpciA9
PiAxLAorCQl9LCAiJHBhdGgiKTsKKwl9IGVsc2UgeworCSAgICBvcGVuZGlyKERJUiwgIiRwYXRo
Iikgb3IgZGllICQhOworCSAgICBteSBAZmlsZXMgPSByZWFkZGlyKERJUik7CisJICAgIGNsb3Nl
ZGlyKERJUik7CisJICAgIGZvcmVhY2ggbXkgJGZpbGUgKEBmaWxlcykgeworCQlwdXNoKEBtZmls
ZXMsICIkcGF0aCRmaWxlIikgaWYgKCRmaWxlICF+IC9eXC4vKTsKKwkgICAgfQorCX0KKyAgICB9
IGVsc2lmICgtZiAiJHBhdGgiKSB7CisJcHVzaChAbWZpbGVzLCAiJHBhdGgiKTsKKyAgICB9IGVs
c2UgeworCWRpZSAiJFA6IE1BSU5UQUlORVIgZmlsZSBub3QgZm91bmQgJyRwYXRoJ1xuIjsKKyAg
ICB9CisgICAgZGllICIkUDogTm8gTUFJTlRBSU5FUiBmaWxlcyBmb3VuZCBpbiAnJHBhdGgnXG4i
IGlmIChzY2FsYXIoQG1maWxlcykgPT0gMCk7CisgICAgZm9yZWFjaCBteSAkZmlsZSAoQG1maWxl
cykgeworCXJlYWRfbWFpbnRhaW5lcl9maWxlKCIkZmlsZSIpOworICAgIH0KK30KKworc3ViIG1h
aW50YWluZXJzX2luX2ZpbGUgeworICAgIG15ICgkZmlsZSkgPSBAXzsKKworICAgIHJldHVybiBp
ZiAoJGZpbGUgPX4gbUBcYk1BSU5UQUlORVJTJEApOworCisgICAgaWYgKC1mICRmaWxlICYmICgk
ZW1haWxfZmlsZV9lbWFpbHMgfHwgJGZpbGUgPX4gL1wueWFtbCQvKSkgeworCW9wZW4obXkgJGYs
ICc8JywgJGZpbGUpCisJICAgIG9yIGRpZSAiJFA6IENhbid0IG9wZW4gJGZpbGU6ICQhXG4iOwor
CW15ICR0ZXh0ID0gZG8geyBsb2NhbCgkLykgOyA8JGY+IH07CisJY2xvc2UoJGYpOworCisJbXkg
QHBvc3NfYWRkciA9ICR0ZXh0ID1+IG0kW0EtWmEtesOALcO/XCJcJyBcLFwuXCstXSpccypbXCxd
KlxzKltcKFw8XHtdezAsMX1bQS1aYS16MC05X1wuXCstXStcQFtBLVphLXowLTlcLi1dK1wuW0Et
WmEtejAtOV0rW1wpXD5cfV17MCwxfSRnOworCXB1c2goQGZpbGVfZW1haWxzLCBjbGVhbl9maWxl
X2VtYWlscyhAcG9zc19hZGRyKSk7CisgICAgfQorfQorCisjCisjIFJlYWQgbWFpbCBhZGRyZXNz
IG1hcAorIworCitteSAkbWFpbG1hcDsKKworcmVhZF9tYWlsbWFwKCk7CisKK3N1YiByZWFkX21h
aWxtYXAgeworICAgICRtYWlsbWFwID0geworCW5hbWVzID0+IHt9LAorCWFkZHJlc3NlcyA9PiB7
fQorICAgIH07CisKKyAgICByZXR1cm4gaWYgKCEkZW1haWxfdXNlX21haWxtYXAgfHwgISgtZiAi
JHtsa19wYXRofS5tYWlsbWFwIikpOworCisgICAgb3BlbihteSAkbWFpbG1hcF9maWxlLCAnPCcs
ICIke2xrX3BhdGh9Lm1haWxtYXAiKQorCW9yIHdhcm4gIiRQOiBDYW4ndCBvcGVuIC5tYWlsbWFw
OiAkIVxuIjsKKworICAgIHdoaWxlICg8JG1haWxtYXBfZmlsZT4pIHsKKwlzLyMuKiQvLzsgI3N0
cmlwIGNvbW1lbnRzCisJcy9eXHMrfFxzKyQvL2c7ICN0cmltCisKKwluZXh0IGlmICgvXlxzKiQv
KTsgI3NraXAgZW1wdHkgbGluZXMKKwkjZW50cmllcyBoYXZlIG9uZSBvZiB0aGUgZm9sbG93aW5n
IGZvcm1hdHM6CisJIyBuYW1lMSA8bWFpbDE+CisJIyA8bWFpbDE+IDxtYWlsMj4KKwkjIG5hbWUx
IDxtYWlsMT4gPG1haWwyPgorCSMgbmFtZTEgPG1haWwxPiBuYW1lMiA8bWFpbDI+CisJIyAoc2Vl
IG1hbiBnaXQtc2hvcnRsb2cpCisKKwlpZiAoL14oW148XSspPChbXj5dKyk+JC8pIHsKKwkgICAg
bXkgJHJlYWxfbmFtZSA9ICQxOworCSAgICBteSAkYWRkcmVzcyA9ICQyOworCisJICAgICRyZWFs
X25hbWUgPX4gcy9ccyskLy87CisJICAgICgkcmVhbF9uYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9l
bWFpbCgiJHJlYWxfbmFtZSA8JGFkZHJlc3M+Iik7CisJICAgICRtYWlsbWFwLT57bmFtZXN9LT57
JGFkZHJlc3N9ID0gJHJlYWxfbmFtZTsKKworCX0gZWxzaWYgKC9ePChbXj5dKyk+XHMqPChbXj5d
Kyk+JC8pIHsKKwkgICAgbXkgJHJlYWxfYWRkcmVzcyA9ICQxOworCSAgICBteSAkd3JvbmdfYWRk
cmVzcyA9ICQyOworCisJICAgICRtYWlsbWFwLT57YWRkcmVzc2VzfS0+eyR3cm9uZ19hZGRyZXNz
fSA9ICRyZWFsX2FkZHJlc3M7CisKKwl9IGVsc2lmICgvXiguKyk8KFtePl0rKT5ccyo8KFtePl0r
KT4kLykgeworCSAgICBteSAkcmVhbF9uYW1lID0gJDE7CisJICAgIG15ICRyZWFsX2FkZHJlc3Mg
PSAkMjsKKwkgICAgbXkgJHdyb25nX2FkZHJlc3MgPSAkMzsKKworCSAgICAkcmVhbF9uYW1lID1+
IHMvXHMrJC8vOworCSAgICAoJHJlYWxfbmFtZSwgJHJlYWxfYWRkcmVzcykgPQorCQlwYXJzZV9l
bWFpbCgiJHJlYWxfbmFtZSA8JHJlYWxfYWRkcmVzcz4iKTsKKwkgICAgJG1haWxtYXAtPntuYW1l
c30tPnskd3JvbmdfYWRkcmVzc30gPSAkcmVhbF9uYW1lOworCSAgICAkbWFpbG1hcC0+e2FkZHJl
c3Nlc30tPnskd3JvbmdfYWRkcmVzc30gPSAkcmVhbF9hZGRyZXNzOworCisJfSBlbHNpZiAoL14o
LispPChbXj5dKyk+XHMqKC4rKVxzKjwoW14+XSspPiQvKSB7CisJICAgIG15ICRyZWFsX25hbWUg
PSAkMTsKKwkgICAgbXkgJHJlYWxfYWRkcmVzcyA9ICQyOworCSAgICBteSAkd3JvbmdfbmFtZSA9
ICQzOworCSAgICBteSAkd3JvbmdfYWRkcmVzcyA9ICQ0OworCisJICAgICRyZWFsX25hbWUgPX4g
cy9ccyskLy87CisJICAgICgkcmVhbF9uYW1lLCAkcmVhbF9hZGRyZXNzKSA9CisJCXBhcnNlX2Vt
YWlsKCIkcmVhbF9uYW1lIDwkcmVhbF9hZGRyZXNzPiIpOworCisJICAgICR3cm9uZ19uYW1lID1+
IHMvXHMrJC8vOworCSAgICAoJHdyb25nX25hbWUsICR3cm9uZ19hZGRyZXNzKSA9CisJCXBhcnNl
X2VtYWlsKCIkd3JvbmdfbmFtZSA8JHdyb25nX2FkZHJlc3M+Iik7CisKKwkgICAgbXkgJHdyb25n
X2VtYWlsID0gZm9ybWF0X2VtYWlsKCR3cm9uZ19uYW1lLCAkd3JvbmdfYWRkcmVzcywgMSk7CisJ
ICAgICRtYWlsbWFwLT57bmFtZXN9LT57JHdyb25nX2VtYWlsfSA9ICRyZWFsX25hbWU7CisJICAg
ICRtYWlsbWFwLT57YWRkcmVzc2VzfS0+eyR3cm9uZ19lbWFpbH0gPSAkcmVhbF9hZGRyZXNzOwor
CX0KKyAgICB9CisgICAgY2xvc2UoJG1haWxtYXBfZmlsZSk7Cit9CisKKyMjIHVzZSB0aGUgZmls
ZW5hbWVzIG9uIHRoZSBjb21tYW5kIGxpbmUgb3IgZmluZCB0aGUgZmlsZW5hbWVzIGluIHRoZSBw
YXRjaGZpbGVzCisKK2lmICghQEFSR1YpIHsKKyAgICBwdXNoKEBBUkdWLCAiJlNURElOIik7Cit9
CisKK2ZvcmVhY2ggbXkgJGZpbGUgKEBBUkdWKSB7CisgICAgaWYgKCRmaWxlIG5lICImU1RESU4i
KSB7CisJJGZpbGUgPSBjYW5vbnBhdGgoJGZpbGUpOworCSMjaWYgJGZpbGUgaXMgYSBkaXJlY3Rv
cnkgYW5kIGl0IGxhY2tzIGEgdHJhaWxpbmcgc2xhc2gsIGFkZCBvbmUKKwlpZiAoKC1kICRmaWxl
KSkgeworCSAgICAkZmlsZSA9fiBzQChbXi9dKSRAJDEvQDsKKwl9IGVsc2lmICghKC1mICRmaWxl
KSkgeworCSAgICBkaWUgIiRQOiBmaWxlICcke2ZpbGV9JyBub3QgZm91bmRcbiI7CisJfQorICAg
IH0KKyAgICBpZiAoJGZyb21fZmlsZW5hbWUgJiYgKHZjc19leGlzdHMoKSAmJiAhdmNzX2ZpbGVf
ZXhpc3RzKCRmaWxlKSkpIHsKKwl3YXJuICIkUDogZmlsZSAnJGZpbGUnIG5vdCBmb3VuZCBpbiB2
ZXJzaW9uIGNvbnRyb2wgJCFcbiI7CisgICAgfQorICAgIGlmICgkZnJvbV9maWxlbmFtZSB8fCAo
JGZpbGUgbmUgIiZTVERJTiIgJiYgdmNzX2ZpbGVfZXhpc3RzKCRmaWxlKSkpIHsKKwkkZmlsZSA9
fiBzL15cUSR7Y3VyX3BhdGh9XEUvLzsJI3N0cmlwIGFueSBhYnNvbHV0ZSBwYXRoCisJJGZpbGUg
PX4gcy9eXFEke2xrX3BhdGh9XEUvLzsJI29yIHRoZSBwYXRoIHRvIHRoZSBsayB0cmVlCisJcHVz
aChAZmlsZXMsICRmaWxlKTsKKwlpZiAoJGZpbGUgbmUgIk1BSU5UQUlORVJTIiAmJiAtZiAkZmls
ZSAmJiAka2V5d29yZHMpIHsKKwkgICAgb3BlbihteSAkZiwgJzwnLCAkZmlsZSkKKwkJb3IgZGll
ICIkUDogQ2FuJ3Qgb3BlbiAkZmlsZTogJCFcbiI7CisJICAgIG15ICR0ZXh0ID0gZG8geyBsb2Nh
bCgkLykgOyA8JGY+IH07CisJICAgIGNsb3NlKCRmKTsKKwkgICAgaWYgKCRrZXl3b3Jkcykgewor
CQlmb3JlYWNoIG15ICRsaW5lIChrZXlzICVrZXl3b3JkX2hhc2gpIHsKKwkJICAgIGlmICgkdGV4
dCA9fiBtLyRrZXl3b3JkX2hhc2h7JGxpbmV9L3gpIHsKKwkJCXB1c2goQGtleXdvcmRfdHZpLCAk
bGluZSk7CisJCSAgICB9CisJCX0KKwkgICAgfQorCX0KKyAgICB9IGVsc2UgeworCW15ICRmaWxl
X2NudCA9IEBmaWxlczsKKwlteSAkbGFzdGZpbGU7CisKKwlvcGVuKG15ICRwYXRjaCwgIjwgJGZp
bGUiKQorCSAgICBvciBkaWUgIiRQOiBDYW4ndCBvcGVuICRmaWxlOiAkIVxuIjsKKworCSMgV2Ug
Y2FuIGNoZWNrIGFyYml0cmFyeSBpbmZvcm1hdGlvbiBiZWZvcmUgdGhlIHBhdGNoCisJIyBsaWtl
IHRoZSBjb21taXQgbWVzc2FnZSwgbWFpbCBoZWFkZXJzLCBldGMuLi4KKwkjIFRoaXMgYWxsb3dz
IHVzIHRvIG1hdGNoIGFyYml0cmFyeSBrZXl3b3JkcyBhZ2FpbnN0IGFueSBwYXJ0CisJIyBvZiBh
IGdpdCBmb3JtYXQtcGF0Y2ggZ2VuZXJhdGVkIGZpbGUgKHN1YmplY3QgdGFncywgZXRjLi4uKQor
CisJbXkgJHBhdGNoX3ByZWZpeCA9ICIiOwkJCSNQYXJzaW5nIHRoZSBpbnRybworCisJd2hpbGUg
KDwkcGF0Y2g+KSB7CisJICAgIG15ICRwYXRjaF9saW5lID0gJF87CisJICAgIGlmIChtL14gbW9k
ZSBjaGFuZ2UgWzAtN10rID0+IFswLTddKyAoXFMrKVxzKiQvKSB7CisJCW15ICRmaWxlbmFtZSA9
ICQxOworCQlwdXNoKEBmaWxlcywgJGZpbGVuYW1lKTsKKwkgICAgfSBlbHNpZiAobS9ecmVuYW1l
ICg/OmZyb218dG8pIChcUyspXHMqJC8pIHsKKwkJbXkgJGZpbGVuYW1lID0gJDE7CisJCXB1c2go
QGZpbGVzLCAkZmlsZW5hbWUpOworCSAgICB9IGVsc2lmIChtL15kaWZmIC0tZ2l0IGFcLyhcUysp
IGJcLyhcUyspXHMqJC8pIHsKKwkJbXkgJGZpbGVuYW1lMSA9ICQxOworCQlteSAkZmlsZW5hbWUy
ID0gJDI7CisJCXB1c2goQGZpbGVzLCAkZmlsZW5hbWUxKTsKKwkJcHVzaChAZmlsZXMsICRmaWxl
bmFtZTIpOworCSAgICB9IGVsc2lmIChtL15GaXhlczpccysoWzAtOWEtZkEtRl17Niw0MH0pLykg
eworCQlwdXNoKEBmaXhlcywgJDEpIGlmICgkZW1haWxfZml4ZXMpOworCSAgICB9IGVsc2lmICht
L15cK1wrXCtccysoXFMrKS8gb3IgbS9eLS0tXHMrKFxTKykvKSB7CisJCW15ICRmaWxlbmFtZSA9
ICQxOworCQkkZmlsZW5hbWUgPX4gc0BeW14vXSovQEA7CisJCSRmaWxlbmFtZSA9fiBzQFxuQEA7
CisJCSRsYXN0ZmlsZSA9ICRmaWxlbmFtZTsKKwkJcHVzaChAZmlsZXMsICRmaWxlbmFtZSk7CisJ
CSRwYXRjaF9wcmVmaXggPSAiXlsrLV0uKiI7CSNOb3cgcGFyc2luZyB0aGUgYWN0dWFsIHBhdGNo
CisJICAgIH0gZWxzaWYgKG0vXlxAXEAgLShcZCspLChcZCspLykgeworCQlpZiAoJGVtYWlsX2dp
dF9ibGFtZSkgeworCQkgICAgcHVzaChAcmFuZ2UsICIkbGFzdGZpbGU6JDE6JDIiKTsKKwkJfQor
CSAgICB9IGVsc2lmICgka2V5d29yZHMpIHsKKwkJZm9yZWFjaCBteSAkbGluZSAoa2V5cyAla2V5
d29yZF9oYXNoKSB7CisJCSAgICBpZiAoJHBhdGNoX2xpbmUgPX4gbS8ke3BhdGNoX3ByZWZpeH0k
a2V5d29yZF9oYXNoeyRsaW5lfS94KSB7CisJCQlwdXNoKEBrZXl3b3JkX3R2aSwgJGxpbmUpOwor
CQkgICAgfQorCQl9CisJICAgIH0KKwl9CisJY2xvc2UoJHBhdGNoKTsKKworCWlmICgkZmlsZV9j
bnQgPT0gQGZpbGVzKSB7CisJICAgIHdhcm4gIiRQOiBmaWxlICcke2ZpbGV9JyBkb2Vzbid0IGFw
cGVhciB0byBiZSBhIHBhdGNoLiAgIgorCQkuICJBZGQgLWYgdG8gb3B0aW9ucz9cbiI7CisJfQor
CUBmaWxlcyA9IHNvcnRfYW5kX3VuaXEoQGZpbGVzKTsKKyAgICB9Cit9CisKK0BmaWxlX2VtYWls
cyA9IHVuaXEoQGZpbGVfZW1haWxzKTsKK0BmaXhlcyA9IHVuaXEoQGZpeGVzKTsKKworbXkgJWVt
YWlsX2hhc2hfbmFtZTsKK215ICVlbWFpbF9oYXNoX2FkZHJlc3M7CitteSBAZW1haWxfdG8gPSAo
KTsKK215ICVoYXNoX2xpc3RfdG87CitteSBAbGlzdF90byA9ICgpOworbXkgQHNjbSA9ICgpOwor
bXkgQHdlYiA9ICgpOworbXkgQHN1YnN5c3RlbSA9ICgpOworbXkgQHN0YXR1cyA9ICgpOworbXkg
JWRlZHVwbGljYXRlX25hbWVfaGFzaCA9ICgpOworbXkgJWRlZHVwbGljYXRlX2FkZHJlc3NfaGFz
aCA9ICgpOworCitteSBAbWFpbnRhaW5lcnMgPSBnZXRfbWFpbnRhaW5lcnMoKTsKK2lmIChAbWFp
bnRhaW5lcnMpIHsKKyAgICBAbWFpbnRhaW5lcnMgPSBtZXJnZV9lbWFpbChAbWFpbnRhaW5lcnMp
OworICAgIG91dHB1dChAbWFpbnRhaW5lcnMpOworfQorCitpZiAoJHNjbSkgeworICAgIEBzY20g
PSB1bmlxKEBzY20pOworICAgIG91dHB1dChAc2NtKTsKK30KKworaWYgKCRzdGF0dXMpIHsKKyAg
ICBAc3RhdHVzID0gdW5pcShAc3RhdHVzKTsKKyAgICBvdXRwdXQoQHN0YXR1cyk7Cit9CisKK2lm
ICgkc3Vic3lzdGVtKSB7CisgICAgQHN1YnN5c3RlbSA9IHVuaXEoQHN1YnN5c3RlbSk7CisgICAg
b3V0cHV0KEBzdWJzeXN0ZW0pOworfQorCitpZiAoJHdlYikgeworICAgIEB3ZWIgPSB1bmlxKEB3
ZWIpOworICAgIG91dHB1dChAd2ViKTsKK30KKworZXhpdCgkZXhpdCk7CisKK3N1YiBzZWxmX3Rl
c3QgeworICAgIG15IEBsc2ZpbGVzID0gKCk7CisgICAgbXkgQGdvb2RfbGlua3MgPSAoKTsKKyAg
ICBteSBAYmFkX2xpbmtzID0gKCk7CisgICAgbXkgQHNlY3Rpb25faGVhZGVycyA9ICgpOworICAg
IG15ICRpbmRleCA9IDA7CisKKyAgICBAbHNmaWxlcyA9IHZjc19saXN0X2ZpbGVzKCRsa19wYXRo
KTsKKworICAgIGZvciBteSAkeCAoQHNlbGZfdGVzdF9pbmZvKSB7CisJJGluZGV4Kys7CisKKwkj
IyBTZWN0aW9uIGhlYWRlciBkdXBsaWNhdGlvbiBhbmQgbWlzc2luZyBzZWN0aW9uIGNvbnRlbnQK
KwlpZiAoKCRzZWxmX3Rlc3QgZXEgIiIgfHwgJHNlbGZfdGVzdCA9fiAvXGJzZWN0aW9uc1xiLykg
JiYKKwkgICAgJHgtPntsaW5lfSA9fiAvXlxTW146XS8gJiYKKwkgICAgZGVmaW5lZCAkc2VsZl90
ZXN0X2luZm9bJGluZGV4XSAmJgorCSAgICAkc2VsZl90ZXN0X2luZm9bJGluZGV4XS0+e2xpbmV9
ID1+IC9eKFtBLVpdKTpccypcUy8pIHsKKwkgICAgbXkgJGhhc19TID0gMDsKKwkgICAgbXkgJGhh
c19GID0gMDsKKwkgICAgbXkgJGhhc19NTCA9IDA7CisJICAgIG15ICRzdGF0dXMgPSAiIjsKKwkg
ICAgaWYgKGdyZXAobUBeXFEkeC0+e2xpbmV9XEVALCBAc2VjdGlvbl9oZWFkZXJzKSkgeworCQlw
cmludCgiJHgtPntmaWxlfTokeC0+e2xpbmVucn06IHdhcm5pbmc6IGR1cGxpY2F0ZSBzZWN0aW9u
IGhlYWRlclx0JHgtPntsaW5lfVxuIik7CisJICAgIH0gZWxzZSB7CisJCXB1c2goQHNlY3Rpb25f
aGVhZGVycywgJHgtPntsaW5lfSk7CisJICAgIH0KKwkgICAgbXkgJG5leHRsaW5lID0gJGluZGV4
OworCSAgICB3aGlsZSAoZGVmaW5lZCAkc2VsZl90ZXN0X2luZm9bJG5leHRsaW5lXSAmJgorCQkg
ICAkc2VsZl90ZXN0X2luZm9bJG5leHRsaW5lXS0+e2xpbmV9ID1+IC9eKFtBLVpdKTpccyooXFMu
KikvKSB7CisJCW15ICR0eXBlID0gJDE7CisJCW15ICR2YWx1ZSA9ICQyOworCQlpZiAoJHR5cGUg
ZXEgIlMiKSB7CisJCSAgICAkaGFzX1MgPSAxOworCQkgICAgJHN0YXR1cyA9ICR2YWx1ZTsKKwkJ
fSBlbHNpZiAoJHR5cGUgZXEgIkYiIHx8ICR0eXBlIGVxICJOIikgeworCQkgICAgJGhhc19GID0g
MTsKKwkJfSBlbHNpZiAoJHR5cGUgZXEgIk0iIHx8ICR0eXBlIGVxICJSIiB8fCAkdHlwZSBlcSAi
TCIpIHsKKwkJICAgICRoYXNfTUwgPSAxOworCQl9CisJCSRuZXh0bGluZSsrOworCSAgICB9CisJ
ICAgIGlmICghJGhhc19NTCAmJiAkc3RhdHVzICF+IC9vcnBoYW58b2Jzb2xldGUvaSkgeworCQlw
cmludCgiJHgtPntmaWxlfTokeC0+e2xpbmVucn06IHdhcm5pbmc6IHNlY3Rpb24gd2l0aG91dCBl
bWFpbCBhZGRyZXNzXHQkeC0+e2xpbmV9XG4iKTsKKwkgICAgfQorCSAgICBpZiAoISRoYXNfUykg
eworCQlwcmludCgiJHgtPntmaWxlfTokeC0+e2xpbmVucn06IHdhcm5pbmc6IHNlY3Rpb24gd2l0
aG91dCBzdGF0dXMgXHQkeC0+e2xpbmV9XG4iKTsKKwkgICAgfQorCSAgICBpZiAoISRoYXNfRikg
eworCQlwcmludCgiJHgtPntmaWxlfTokeC0+e2xpbmVucn06IHdhcm5pbmc6IHNlY3Rpb24gd2l0
aG91dCBmaWxlIHBhdHRlcm5cdCR4LT57bGluZX1cbiIpOworCSAgICB9CisJfQorCisJbmV4dCBp
ZiAoJHgtPntsaW5lfSAhfiAvXihbQS1aXSk6XHMqKC4qKS8pOworCisJbXkgJHR5cGUgPSAkMTsK
KwlteSAkdmFsdWUgPSAkMjsKKworCSMjIEZpbGVuYW1lIHBhdHRlcm4gbWF0Y2hpbmcKKwlpZiAo
KCR0eXBlIGVxICJGIiB8fCAkdHlwZSBlcSAiWCIpICYmCisJICAgICgkc2VsZl90ZXN0IGVxICIi
IHx8ICRzZWxmX3Rlc3QgPX4gL1xicGF0dGVybnNcYi8pKSB7CisJICAgICR2YWx1ZSA9fiBzQFwu
QFxcXC5AZzsgICAgICAgIyNDb252ZXJ0IC4gdG8gXC4KKwkgICAgJHZhbHVlID1+IHMvXCovXC5c
Ki9nOyAgICAgICAjI0NvbnZlcnQgKiB0byAuKgorCSAgICAkdmFsdWUgPX4gcy9cPy9cLi9nOyAg
ICAgICAgICMjQ29udmVydCA/IHRvIC4KKwkgICAgIyNpZiBwYXR0ZXJuIGlzIGEgZGlyZWN0b3J5
IGFuZCBpdCBsYWNrcyBhIHRyYWlsaW5nIHNsYXNoLCBhZGQgb25lCisJICAgIGlmICgoLWQgJHZh
bHVlKSkgeworCQkkdmFsdWUgPX4gc0AoW14vXSkkQCQxL0A7CisJICAgIH0KKwkgICAgaWYgKCFn
cmVwKG1AXiR2YWx1ZUAsIEBsc2ZpbGVzKSkgeworCQlwcmludCgiJHgtPntmaWxlfTokeC0+e2xp
bmVucn06IHdhcm5pbmc6IG5vIGZpbGUgbWF0Y2hlc1x0JHgtPntsaW5lfVxuIik7CisJICAgIH0K
KworCSMjIExpbmsgcmVhY2hhYmlsaXR5CisJfSBlbHNpZiAoKCR0eXBlIGVxICJXIiB8fCAkdHlw
ZSBlcSAiUSIgfHwgJHR5cGUgZXEgIkIiKSAmJgorCQkgJHZhbHVlID1+IC9eaHR0cHM/Oi8gJiYK
KwkJICgkc2VsZl90ZXN0IGVxICIiIHx8ICRzZWxmX3Rlc3QgPX4gL1xibGlua3NcYi8pKSB7CisJ
ICAgIG5leHQgaWYgKGdyZXAobUBeXFEkdmFsdWVcRSRALCBAZ29vZF9saW5rcykpOworCSAgICBt
eSAkaXNiYWQgPSAwOworCSAgICBpZiAoZ3JlcChtQF5cUSR2YWx1ZVxFJEAsIEBiYWRfbGlua3Mp
KSB7CisJICAgICAgICAkaXNiYWQgPSAxOworCSAgICB9IGVsc2UgeworCQlteSAkb3V0cHV0ID0g
YHdnZXQgLS1zcGlkZXIgLXEgLS1uby1jaGVjay1jZXJ0aWZpY2F0ZSAtLXRpbWVvdXQgMTAgLS10
cmllcyAxICR2YWx1ZWA7CisJCWlmICgkPyA9PSAwKSB7CisJCSAgICBwdXNoKEBnb29kX2xpbmtz
LCAkdmFsdWUpOworCQl9IGVsc2UgeworCQkgICAgcHVzaChAYmFkX2xpbmtzLCAkdmFsdWUpOwor
CQkgICAgJGlzYmFkID0gMTsKKwkJfQorCSAgICB9CisJICAgIGlmICgkaXNiYWQpIHsKKwkgICAg
ICAgIHByaW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogcG9zc2libGUgYmFk
IGxpbmtcdCR4LT57bGluZX1cbiIpOworCSAgICB9CisKKwkjIyBTQ00gcmVhY2hhYmlsaXR5CisJ
fSBlbHNpZiAoJHR5cGUgZXEgIlQiICYmCisJCSAoJHNlbGZfdGVzdCBlcSAiIiB8fCAkc2VsZl90
ZXN0ID1+IC9cYnNjbVxiLykpIHsKKwkgICAgbmV4dCBpZiAoZ3JlcChtQF5cUSR2YWx1ZVxFJEAs
IEBnb29kX2xpbmtzKSk7CisJICAgIG15ICRpc2JhZCA9IDA7CisJICAgIGlmIChncmVwKG1AXlxR
JHZhbHVlXEUkQCwgQGJhZF9saW5rcykpIHsKKwkgICAgICAgICRpc2JhZCA9IDE7CisgICAgICAg
ICAgICB9IGVsc2lmICgkdmFsdWUgIX4gL14oPzpnaXR8cXVpbHR8aGcpXHMrXFMvKSB7CisJCXBy
aW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogbWFsZm9ybWVkIGVudHJ5XHQk
eC0+e2xpbmV9XG4iKTsKKwkgICAgfSBlbHNpZiAoJHZhbHVlID1+IC9eZ2l0XHMrKFxTKykoXHMr
KFteXChdK1xTKykpPy8pIHsKKwkJbXkgJHVybCA9ICQxOworCQlteSAkYnJhbmNoID0gIiI7CisJ
CSRicmFuY2ggPSAkMyBpZiAkMzsKKwkJbXkgJG91dHB1dCA9IGBnaXQgbHMtcmVtb3RlIC0tZXhp
dC1jb2RlIC1oICIkdXJsIiAkYnJhbmNoID4gL2Rldi9udWxsIDI+JjFgOworCQlpZiAoJD8gPT0g
MCkgeworCQkgICAgcHVzaChAZ29vZF9saW5rcywgJHZhbHVlKTsKKwkJfSBlbHNlIHsKKwkJICAg
IHB1c2goQGJhZF9saW5rcywgJHZhbHVlKTsKKwkJICAgICRpc2JhZCA9IDE7CisJCX0KKwkgICAg
fSBlbHNpZiAoJHZhbHVlID1+IC9eKD86cXVpbHR8aGcpXHMrKGh0dHBzPzpcUyspLykgeworCQlt
eSAkdXJsID0gJDE7CisJCW15ICRvdXRwdXQgPSBgd2dldCAtLXNwaWRlciAtcSAtLW5vLWNoZWNr
LWNlcnRpZmljYXRlIC0tdGltZW91dCAxMCAtLXRyaWVzIDEgJHVybGA7CisJCWlmICgkPyA9PSAw
KSB7CisJCSAgICBwdXNoKEBnb29kX2xpbmtzLCAkdmFsdWUpOworCQl9IGVsc2UgeworCQkgICAg
cHVzaChAYmFkX2xpbmtzLCAkdmFsdWUpOworCQkgICAgJGlzYmFkID0gMTsKKwkJfQorCSAgICB9
CisJICAgIGlmICgkaXNiYWQpIHsKKwkJcHJpbnQoIiR4LT57ZmlsZX06JHgtPntsaW5lbnJ9OiB3
YXJuaW5nOiBwb3NzaWJsZSBiYWQgbGlua1x0JHgtPntsaW5lfVxuIik7CisJICAgIH0KKwl9Cisg
ICAgfQorfQorCitzdWIgaWdub3JlX2VtYWlsX2FkZHJlc3MgeworICAgIG15ICgkYWRkcmVzcykg
PSBAXzsKKworICAgIGZvcmVhY2ggbXkgJGlnbm9yZSAoQGlnbm9yZV9lbWFpbHMpIHsKKwlyZXR1
cm4gMSBpZiAoJGlnbm9yZSBlcSAkYWRkcmVzcyk7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9
CisKK3N1YiByYW5nZV9pc19tYWludGFpbmVkIHsKKyAgICBteSAoJHN0YXJ0LCAkZW5kKSA9IEBf
OworCisgICAgZm9yIChteSAkaSA9ICRzdGFydDsgJGkgPCAkZW5kOyAkaSsrKSB7CisJbXkgJGxp
bmUgPSAkdHlwZXZhbHVlWyRpXTsKKwlpZiAoJGxpbmUgPX4gbS9eKFtBLVpdKTpccyooLiopLykg
eworCSAgICBteSAkdHlwZSA9ICQxOworCSAgICBteSAkdmFsdWUgPSAkMjsKKwkgICAgaWYgKCR0
eXBlIGVxICdTJykgeworCQlpZiAoJHZhbHVlID1+IC8obWFpbnRhaW58c3VwcG9ydCkvaSkgewor
CQkgICAgcmV0dXJuIDE7CisJCX0KKwkgICAgfQorCX0KKyAgICB9CisgICAgcmV0dXJuIDA7Cit9
CisKK3N1YiByYW5nZV9oYXNfbWFpbnRhaW5lciB7CisgICAgbXkgKCRzdGFydCwgJGVuZCkgPSBA
XzsKKworICAgIGZvciAobXkgJGkgPSAkc3RhcnQ7ICRpIDwgJGVuZDsgJGkrKykgeworCW15ICRs
aW5lID0gJHR5cGV2YWx1ZVskaV07CisJaWYgKCRsaW5lID1+IG0vXihbQS1aXSk6XHMqKC4qKS8p
IHsKKwkgICAgbXkgJHR5cGUgPSAkMTsKKwkgICAgbXkgJHZhbHVlID0gJDI7CisJICAgIGlmICgk
dHlwZSBlcSAnTScpIHsKKwkJcmV0dXJuIDE7CisJICAgIH0KKwl9CisgICAgfQorICAgIHJldHVy
biAwOworfQorCitzdWIgZ2V0X21haW50YWluZXJzIHsKKyAgICAlZW1haWxfaGFzaF9uYW1lID0g
KCk7CisgICAgJWVtYWlsX2hhc2hfYWRkcmVzcyA9ICgpOworICAgICVjb21taXRfYXV0aG9yX2hh
c2ggPSAoKTsKKyAgICAlY29tbWl0X3NpZ25lcl9oYXNoID0gKCk7CisgICAgQGVtYWlsX3RvID0g
KCk7CisgICAgJWhhc2hfbGlzdF90byA9ICgpOworICAgIEBsaXN0X3RvID0gKCk7CisgICAgQHNj
bSA9ICgpOworICAgIEB3ZWIgPSAoKTsKKyAgICBAc3Vic3lzdGVtID0gKCk7CisgICAgQHN0YXR1
cyA9ICgpOworICAgICVkZWR1cGxpY2F0ZV9uYW1lX2hhc2ggPSAoKTsKKyAgICAlZGVkdXBsaWNh
dGVfYWRkcmVzc19oYXNoID0gKCk7CisgICAgaWYgKCRlbWFpbF9naXRfYWxsX3NpZ25hdHVyZV90
eXBlcykgeworCSRzaWduYXR1cmVfcGF0dGVybiA9ICIoLis/KVtCYl1bWXldOiI7CisgICAgfSBl
bHNlIHsKKwkkc2lnbmF0dXJlX3BhdHRlcm4gPSAiXCgiIC4gam9pbigifCIsIEBzaWduYXR1cmVf
dGFncykgLiAiXCkiOworICAgIH0KKworICAgICMgRmluZCByZXNwb25zaWJsZSBwYXJ0aWVzCisK
KyAgICBteSAlZXhhY3RfcGF0dGVybl9tYXRjaF9oYXNoID0gKCk7CisKKyAgICBmb3JlYWNoIG15
ICRmaWxlIChAZmlsZXMpIHsKKworCW15ICVoYXNoOworCW15ICR0dmkgPSBmaW5kX2ZpcnN0X3Nl
Y3Rpb24oKTsKKwl3aGlsZSAoJHR2aSA8IEB0eXBldmFsdWUpIHsKKwkgICAgbXkgJHN0YXJ0ID0g
ZmluZF9zdGFydGluZ19pbmRleCgkdHZpKTsKKwkgICAgbXkgJGVuZCA9IGZpbmRfZW5kaW5nX2lu
ZGV4KCR0dmkpOworCSAgICBteSAkZXhjbHVkZSA9IDA7CisJICAgIG15ICRpOworCisJICAgICNE
byBub3QgbWF0Y2ggZXhjbHVkZWQgZmlsZSBwYXR0ZXJucworCisJICAgIGZvciAoJGkgPSAkc3Rh
cnQ7ICRpIDwgJGVuZDsgJGkrKykgeworCQlteSAkbGluZSA9ICR0eXBldmFsdWVbJGldOworCQlp
ZiAoJGxpbmUgPX4gbS9eKFtBLVpdKTpccyooLiopLykgeworCQkgICAgbXkgJHR5cGUgPSAkMTsK
KwkJICAgIG15ICR2YWx1ZSA9ICQyOworCQkgICAgaWYgKCR0eXBlIGVxICdYJykgeworCQkJaWYg
KGZpbGVfbWF0Y2hfcGF0dGVybigkZmlsZSwgJHZhbHVlKSkgeworCQkJICAgICRleGNsdWRlID0g
MTsKKwkJCSAgICBsYXN0OworCQkJfQorCQkgICAgfQorCQl9CisJICAgIH0KKworCSAgICBpZiAo
ISRleGNsdWRlKSB7CisJCWZvciAoJGkgPSAkc3RhcnQ7ICRpIDwgJGVuZDsgJGkrKykgeworCQkg
ICAgbXkgJGxpbmUgPSAkdHlwZXZhbHVlWyRpXTsKKwkJICAgIGlmICgkbGluZSA9fiBtL14oW0Et
Wl0pOlxzKiguKikvKSB7CisJCQlteSAkdHlwZSA9ICQxOworCQkJbXkgJHZhbHVlID0gJDI7CisJ
CQlpZiAoJHR5cGUgZXEgJ0YnKSB7CisJCQkgICAgaWYgKGZpbGVfbWF0Y2hfcGF0dGVybigkZmls
ZSwgJHZhbHVlKSkgeworCQkJCW15ICR2YWx1ZV9wZCA9ICgkdmFsdWUgPX4gdHJAL0BAKTsKKwkJ
CQlteSAkZmlsZV9wZCA9ICgkZmlsZSAgPX4gdHJAL0BAKTsKKwkJCQkkdmFsdWVfcGQrKyBpZiAo
c3Vic3RyKCR2YWx1ZSwtMSwxKSBuZSAiLyIpOworCQkJCSR2YWx1ZV9wZCA9IC0xIGlmICgkdmFs
dWUgPX4gL15cLlwqLyk7CisJCQkJaWYgKCR2YWx1ZV9wZCA+PSAkZmlsZV9wZCAmJgorCQkJCSAg
ICByYW5nZV9pc19tYWludGFpbmVkKCRzdGFydCwgJGVuZCkgJiYKKwkJCQkgICAgcmFuZ2VfaGFz
X21haW50YWluZXIoJHN0YXJ0LCAkZW5kKSkgeworCQkJCSAgICAkZXhhY3RfcGF0dGVybl9tYXRj
aF9oYXNoeyRmaWxlfSA9IDE7CisJCQkJfQorCQkJCWlmICgkcGF0dGVybl9kZXB0aCA9PSAwIHx8
CisJCQkJICAgICgoJGZpbGVfcGQgLSAkdmFsdWVfcGQpIDwgJHBhdHRlcm5fZGVwdGgpKSB7CisJ
CQkJICAgICRoYXNoeyR0dml9ID0gJHZhbHVlX3BkOworCQkJCX0KKwkJCSAgICB9CisJCQl9IGVs
c2lmICgkdHlwZSBlcSAnTicpIHsKKwkJCSAgICBpZiAoJGZpbGUgPX4gbS8kdmFsdWUveCkgewor
CQkJCSRoYXNoeyR0dml9ID0gMDsKKwkJCSAgICB9CisJCQl9CisJCSAgICB9CisJCX0KKwkgICAg
fQorCSAgICAkdHZpID0gJGVuZCArIDE7CisJfQorCisJZm9yZWFjaCBteSAkbGluZSAoc29ydCB7
JGhhc2h7JGJ9IDw9PiAkaGFzaHskYX19IGtleXMgJWhhc2gpIHsKKwkgICAgYWRkX2NhdGVnb3Jp
ZXMoJGxpbmUpOworCSAgICBpZiAoJHNlY3Rpb25zKSB7CisJCW15ICRpOworCQlteSAkc3RhcnQg
PSBmaW5kX3N0YXJ0aW5nX2luZGV4KCRsaW5lKTsKKwkJbXkgJGVuZCA9IGZpbmRfZW5kaW5nX2lu
ZGV4KCRsaW5lKTsKKwkJZm9yICgkaSA9ICRzdGFydDsgJGkgPCAkZW5kOyAkaSsrKSB7CisJCSAg
ICBteSAkbGluZSA9ICR0eXBldmFsdWVbJGldOworCQkgICAgaWYgKCRsaW5lID1+IC9eW0ZYXTov
KSB7CQkjI1Jlc3RvcmUgZmlsZSBwYXR0ZXJucworCQkJJGxpbmUgPX4gcy8oW15cXF0pXC4oW15c
Kl0pLyQxXD8kMi9nOworCQkJJGxpbmUgPX4gcy8oW15cXF0pXC4kLyQxXD8vZzsJIyNDb252ZXJ0
IC4gYmFjayB0byA/CisJCQkkbGluZSA9fiBzL1xcXC4vXC4vZzsgICAgICAgCSMjQ29udmVydCBc
LiB0byAuCisJCQkkbGluZSA9fiBzL1wuXCovXCovZzsgICAgICAgCSMjQ29udmVydCAuKiB0byAq
CisJCSAgICB9CisJCSAgICBteSAkY291bnQgPSAkbGluZSA9fiBzL14oW0EtWl0pOi8kMTpcdC9n
OworCQkgICAgaWYgKCRsZXR0ZXJzIGVxICIiIHx8ICghJGNvdW50IHx8ICRsZXR0ZXJzID1+IC8k
MS9pKSkgeworCQkJcHJpbnQoIiRsaW5lXG4iKTsKKwkJICAgIH0KKwkJfQorCQlwcmludCgiXG4i
KTsKKwkgICAgfQorCX0KKworCW1haW50YWluZXJzX2luX2ZpbGUoJGZpbGUpOworICAgIH0KKwor
ICAgIGlmICgka2V5d29yZHMpIHsKKwlAa2V5d29yZF90dmkgPSBzb3J0X2FuZF91bmlxKEBrZXl3
b3JkX3R2aSk7CisJZm9yZWFjaCBteSAkbGluZSAoQGtleXdvcmRfdHZpKSB7CisJICAgIGFkZF9j
YXRlZ29yaWVzKCRsaW5lKTsKKwl9CisgICAgfQorCisgICAgZm9yZWFjaCBteSAkZW1haWwgKEBl
bWFpbF90bywgQGxpc3RfdG8pIHsKKwkkZW1haWwtPlswXSA9IGRlZHVwbGljYXRlX2VtYWlsKCRl
bWFpbC0+WzBdKTsKKyAgICB9CisKKyAgICBmb3JlYWNoIG15ICRmaWxlIChAZmlsZXMpIHsKKwlp
ZiAoJGVtYWlsICYmCisJICAgICgkZW1haWxfZ2l0IHx8CisJICAgICAoJGVtYWlsX2dpdF9mYWxs
YmFjayAmJgorCSAgICAgICRmaWxlICF+IC9NQUlOVEFJTkVSUyQvICYmCisJICAgICAgISRleGFj
dF9wYXR0ZXJuX21hdGNoX2hhc2h7JGZpbGV9KSkpIHsKKwkgICAgdmNzX2ZpbGVfc2lnbm9mZnMo
JGZpbGUpOworCX0KKwlpZiAoJGVtYWlsICYmICRlbWFpbF9naXRfYmxhbWUpIHsKKwkgICAgdmNz
X2ZpbGVfYmxhbWUoJGZpbGUpOworCX0KKyAgICB9CisKKyAgICBpZiAoJGVtYWlsKSB7CisJZm9y
ZWFjaCBteSAkZW1haWwgKEBmaWxlX2VtYWlscykgeworCSAgICBteSAoJG5hbWUsICRhZGRyZXNz
KSA9IHBhcnNlX2VtYWlsKCRlbWFpbCk7CisKKwkgICAgbXkgJHRtcF9lbWFpbCA9IGZvcm1hdF9l
bWFpbCgkbmFtZSwgJGFkZHJlc3MsICRlbWFpbF91c2VuYW1lKTsKKwkgICAgcHVzaF9lbWFpbF9h
ZGRyZXNzKCR0bXBfZW1haWwsICcnKTsKKwkgICAgYWRkX3JvbGUoJHRtcF9lbWFpbCwgJ2luIGZp
bGUnKTsKKwl9CisgICAgfQorCisgICAgZm9yZWFjaCBteSAkZml4IChAZml4ZXMpIHsKKwl2Y3Nf
YWRkX2NvbW1pdF9zaWduZXJzKCRmaXgsICJibGFtZWRfZml4ZXMiKTsKKyAgICB9CisKKyAgICBt
eSBAdG8gPSAoKTsKKyAgICBpZiAoJGVtYWlsIHx8ICRlbWFpbF9saXN0KSB7CisJaWYgKCRlbWFp
bCkgeworCSAgICBAdG8gPSAoQHRvLCBAZW1haWxfdG8pOworCX0KKwlpZiAoJGVtYWlsX2xpc3Qp
IHsKKwkgICAgQHRvID0gKEB0bywgQGxpc3RfdG8pOworCX0KKyAgICB9CisKKyAgICBpZiAoJGlu
dGVyYWN0aXZlKSB7CisJQHRvID0gaW50ZXJhY3RpdmVfZ2V0X21haW50YWluZXJzKFxAdG8pOwor
ICAgIH0KKworICAgIHJldHVybiBAdG87Cit9CisKK3N1YiBmaWxlX21hdGNoX3BhdHRlcm4gewor
ICAgIG15ICgkZmlsZSwgJHBhdHRlcm4pID0gQF87CisgICAgaWYgKHN1YnN0cigkcGF0dGVybiwg
LTEpIGVxICIvIikgeworCWlmICgkZmlsZSA9fiBtQF4kcGF0dGVybkApIHsKKwkgICAgcmV0dXJu
IDE7CisJfQorICAgIH0gZWxzZSB7CisJaWYgKCRmaWxlID1+IG1AXiRwYXR0ZXJuQCkgeworCSAg
ICBteSAkczEgPSAoJGZpbGUgPX4gdHJAL0BAKTsKKwkgICAgbXkgJHMyID0gKCRwYXR0ZXJuID1+
IHRyQC9AQCk7CisJICAgIGlmICgkczEgPT0gJHMyKSB7CisJCXJldHVybiAxOworCSAgICB9CisJ
fQorICAgIH0KKyAgICByZXR1cm4gMDsKK30KKworc3ViIHVzYWdlIHsKKyAgICBwcmludCA8PEVP
VDsKK3VzYWdlOiAkUCBbb3B0aW9uc10gcGF0Y2hmaWxlCisgICAgICAgJFAgW29wdGlvbnNdIC1m
IGZpbGV8ZGlyZWN0b3J5Cit2ZXJzaW9uOiAkVgorCitNQUlOVEFJTkVSIGZpZWxkIHNlbGVjdGlv
biBvcHRpb25zOgorICAtLWVtYWlsID0+IHByaW50IGVtYWlsIGFkZHJlc3MoZXMpIGlmIGFueQor
ICAgIC0tZ2l0ID0+IGluY2x1ZGUgcmVjZW50IGdpdCBcKi1ieTogc2lnbmVycworICAgIC0tZ2l0
LWFsbC1zaWduYXR1cmUtdHlwZXMgPT4gaW5jbHVkZSBzaWduZXJzIHJlZ2FyZGxlc3Mgb2Ygc2ln
bmF0dXJlIHR5cGUKKyAgICAgICAgb3IgdXNlIG9ubHkgJHtzaWduYXR1cmVfcGF0dGVybn0gc2ln
bmVycyAoZGVmYXVsdDogJGVtYWlsX2dpdF9hbGxfc2lnbmF0dXJlX3R5cGVzKQorICAgIC0tZ2l0
LWZhbGxiYWNrID0+IHVzZSBnaXQgd2hlbiBubyBleGFjdCBNQUlOVEFJTkVSUyBwYXR0ZXJuIChk
ZWZhdWx0OiAkZW1haWxfZ2l0X2ZhbGxiYWNrKQorICAgIC0tZ2l0LW1pbi1zaWduYXR1cmVzID0+
IG51bWJlciBvZiBzaWduYXR1cmVzIHJlcXVpcmVkIChkZWZhdWx0OiAkZW1haWxfZ2l0X21pbl9z
aWduYXR1cmVzKQorICAgIC0tZ2l0LW1heC1tYWludGFpbmVycyA9PiBtYXhpbXVtIG1haW50YWlu
ZXJzIHRvIGFkZCAoZGVmYXVsdDogJGVtYWlsX2dpdF9tYXhfbWFpbnRhaW5lcnMpCisgICAgLS1n
aXQtbWluLXBlcmNlbnQgPT4gbWluaW11bSBwZXJjZW50YWdlIG9mIGNvbW1pdHMgcmVxdWlyZWQg
KGRlZmF1bHQ6ICRlbWFpbF9naXRfbWluX3BlcmNlbnQpCisgICAgLS1naXQtYmxhbWUgPT4gdXNl
IGdpdCBibGFtZSB0byBmaW5kIG1vZGlmaWVkIGNvbW1pdHMgZm9yIHBhdGNoIG9yIGZpbGUKKyAg
ICAtLWdpdC1ibGFtZS1zaWduYXR1cmVzID0+IHdoZW4gdXNlZCB3aXRoIC0tZ2l0LWJsYW1lLCBh
bHNvIGluY2x1ZGUgYWxsIGNvbW1pdCBzaWduZXJzCisgICAgLS1naXQtc2luY2UgPT4gZ2l0IGhp
c3RvcnkgdG8gdXNlIChkZWZhdWx0OiAkZW1haWxfZ2l0X3NpbmNlKQorICAgIC0taGctc2luY2Ug
PT4gaGcgaGlzdG9yeSB0byB1c2UgKGRlZmF1bHQ6ICRlbWFpbF9oZ19zaW5jZSkKKyAgICAtLWlu
dGVyYWN0aXZlID0+IGRpc3BsYXkgYSBtZW51IChtb3N0bHkgdXNlZnVsIGlmIHVzZWQgd2l0aCB0
aGUgLS1naXQgb3B0aW9uKQorICAgIC0tbSA9PiBpbmNsdWRlIG1haW50YWluZXIocykgaWYgYW55
CisgICAgLS1yID0+IGluY2x1ZGUgcmV2aWV3ZXIocykgaWYgYW55CisgICAgLS1uID0+IGluY2x1
ZGUgbmFtZSAnRnVsbCBOYW1lIDxhZGRyXEBkb21haW4udGxkPicKKyAgICAtLWwgPT4gaW5jbHVk
ZSBsaXN0KHMpIGlmIGFueQorICAgIC0tbW9kZXJhdGVkID0+IGluY2x1ZGUgbW9kZXJhdGVkIGxp
c3RzKHMpIGlmIGFueSAoZGVmYXVsdDogdHJ1ZSkKKyAgICAtLXMgPT4gaW5jbHVkZSBzdWJzY3Jp
YmVyIG9ubHkgbGlzdChzKSBpZiBhbnkgKGRlZmF1bHQ6IGZhbHNlKQorICAgIC0tcmVtb3ZlLWR1
cGxpY2F0ZXMgPT4gbWluaW1pemUgZHVwbGljYXRlIGVtYWlsIG5hbWVzL2FkZHJlc3NlcworICAg
IC0tcm9sZXMgPT4gc2hvdyByb2xlcyAoc3RhdHVzOnN1YnN5c3RlbSwgZ2l0LXNpZ25lciwgbGlz
dCwgZXRjLi4uKQorICAgIC0tcm9sZXN0YXRzID0+IHNob3cgcm9sZXMgYW5kIHN0YXRpc3RpY3Mg
KGNvbW1pdHMvdG90YWxfY29tbWl0cywgJSkKKyAgICAtLWZpbGUtZW1haWxzID0+IGFkZCBlbWFp
bCBhZGRyZXNzZXMgZm91bmQgaW4gLWYgZmlsZSAoZGVmYXVsdDogMCAob2ZmKSkKKyAgICAtLWZp
eGVzID0+IGZvciBwYXRjaGVzLCBhZGQgc2lnbmF0dXJlcyBvZiBjb21taXRzIHdpdGggJ0ZpeGVz
OiA8Y29tbWl0PicgKGRlZmF1bHQ6IDEgKG9uKSkKKyAgLS1zY20gPT4gcHJpbnQgU0NNIHRyZWUo
cykgaWYgYW55CisgIC0tc3RhdHVzID0+IHByaW50IHN0YXR1cyBpZiBhbnkKKyAgLS1zdWJzeXN0
ZW0gPT4gcHJpbnQgc3Vic3lzdGVtIG5hbWUgaWYgYW55CisgIC0td2ViID0+IHByaW50IHdlYnNp
dGUocykgaWYgYW55CisKK091dHB1dCB0eXBlIG9wdGlvbnM6CisgIC0tc2VwYXJhdG9yIFssIF0g
PT4gc2VwYXJhdG9yIGZvciBtdWx0aXBsZSBlbnRyaWVzIG9uIDEgbGluZQorICAgIHVzaW5nIC0t
c2VwYXJhdG9yIGFsc28gc2V0cyAtLW5vbXVsdGlsaW5lIGlmIC0tc2VwYXJhdG9yIGlzIG5vdCBb
LCBdCisgIC0tbXVsdGlsaW5lID0+IHByaW50IDEgZW50cnkgcGVyIGxpbmUKKworT3RoZXIgb3B0
aW9uczoKKyAgLS1wYXR0ZXJuLWRlcHRoID0+IE51bWJlciBvZiBwYXR0ZXJuIGRpcmVjdG9yeSB0
cmF2ZXJzYWxzIChkZWZhdWx0OiAwIChhbGwpKQorICAtLWtleXdvcmRzID0+IHNjYW4gcGF0Y2gg
Zm9yIGtleXdvcmRzIChkZWZhdWx0OiAka2V5d29yZHMpCisgIC0tc2VjdGlvbnMgPT4gcHJpbnQg
YWxsIG9mIHRoZSBzdWJzeXN0ZW0gc2VjdGlvbnMgd2l0aCBwYXR0ZXJuIG1hdGNoZXMKKyAgLS1s
ZXR0ZXJzID0+IHByaW50IGFsbCBtYXRjaGluZyAnbGV0dGVyJyB0eXBlcyBmcm9tIGFsbCBtYXRj
aGluZyBzZWN0aW9ucworICAtLW1haWxtYXAgPT4gdXNlIC5tYWlsbWFwIGZpbGUgKGRlZmF1bHQ6
ICRlbWFpbF91c2VfbWFpbG1hcCkKKyAgLS1uby10cmVlID0+IHJ1biB3aXRob3V0IGEga3ZtLXVz
ZXItc3BhY2UgdHJlZQorICAtLXNlbGYtdGVzdCA9PiBzaG93IHBvdGVudGlhbCBpc3N1ZXMgd2l0
aCBNQUlOVEFJTkVSUyBmaWxlIGNvbnRlbnQKKyAgLS12ZXJzaW9uID0+IHNob3cgdmVyc2lvbgor
ICAtLWhlbHAgPT4gc2hvdyB0aGlzIGhlbHAgaW5mb3JtYXRpb24KKworRGVmYXVsdCBvcHRpb25z
OgorICBbLS1lbWFpbCAtLXRyZWUgLS1ub2dpdCAtLWdpdC1mYWxsYmFjayAtLW0gLS1yIC0tbiAt
LWwgLS1tdWx0aWxpbmUKKyAgIC0tcGF0dGVybi1kZXB0aD0wIC0tcmVtb3ZlLWR1cGxpY2F0ZXMg
LS1yb2xlc3RhdHNdCisKK05vdGVzOgorICBVc2luZyAiLWYgZGlyZWN0b3J5IiBtYXkgZ2l2ZSB1
bmV4cGVjdGVkIHJlc3VsdHM6CisgICAgICBVc2VkIHdpdGggIi0tZ2l0IiwgZ2l0IHNpZ25hdG9y
cyBmb3IgX2FsbF8gZmlsZXMgaW4gYW5kIGJlbG93CisgICAgICAgICAgZGlyZWN0b3J5IGFyZSBl
eGFtaW5lZCBhcyBnaXQgcmVjdXJzZXMgZGlyZWN0b3JpZXMuCisgICAgICAgICAgQW55IHNwZWNp
ZmllZCBYOiAoZXhjbHVkZSkgcGF0dGVybiBtYXRjaGVzIGFyZSBfbm90XyBpZ25vcmVkLgorICAg
ICAgVXNlZCB3aXRoICItLW5vZ2l0IiwgZGlyZWN0b3J5IGlzIHVzZWQgYXMgYSBwYXR0ZXJuIG1h
dGNoLAorICAgICAgICAgIG5vIGluZGl2aWR1YWwgZmlsZSB3aXRoaW4gdGhlIGRpcmVjdG9yeSBv
ciBzdWJkaXJlY3RvcnkKKyAgICAgICAgICBpcyBtYXRjaGVkLgorICAgICAgVXNlZCB3aXRoICIt
LWdpdC1ibGFtZSIsIGRvZXMgbm90IGl0ZXJhdGUgYWxsIGZpbGVzIGluIGRpcmVjdG9yeQorICBV
c2luZyAiLS1naXQtYmxhbWUiIGlzIHNsb3cgYW5kIG1heSBhZGQgb2xkIGNvbW1pdHRlcnMgYW5k
IGF1dGhvcnMKKyAgICAgIHRoYXQgYXJlIG5vIGxvbmdlciBhY3RpdmUgbWFpbnRhaW5lcnMgdG8g
dGhlIG91dHB1dC4KKyAgVXNpbmcgIi0tcm9sZXMiIG9yICItLXJvbGVzdGF0cyIgd2l0aCBnaXQg
c2VuZC1lbWFpbCAtLWNjLWNtZCBvciBhbnkKKyAgICAgIG90aGVyIGF1dG9tYXRlZCB0b29scyB0
aGF0IGV4cGVjdCBvbmx5IFsibmFtZSJdIDxlbWFpbCBhZGRyZXNzPgorICAgICAgbWF5IG5vdCB3
b3JrIGJlY2F1c2Ugb2YgYWRkaXRpb25hbCBvdXRwdXQgYWZ0ZXIgPGVtYWlsIGFkZHJlc3M+Lgor
ICBVc2luZyAiLS1yb2xlc3RhdHMiIGFuZCAiLS1naXQtYmxhbWUiIHNob3dzIHRoZSAjL3RvdGFs
PSUgY29tbWl0cywKKyAgICAgIG5vdCB0aGUgcGVyY2VudGFnZSBvZiB0aGUgZW50aXJlIGZpbGUg
YXV0aG9yZWQuICAjIG9mIGNvbW1pdHMgaXMKKyAgICAgIG5vdCBhIGdvb2QgbWVhc3VyZSBvZiBh
bW91bnQgb2YgY29kZSBhdXRob3JlZC4gIDEgbWFqb3IgY29tbWl0IG1heQorICAgICAgY29udGFp
biBhIHRob3VzYW5kIGxpbmVzLCA1IHRyaXZpYWwgY29tbWl0cyBtYXkgbW9kaWZ5IGEgc2luZ2xl
IGxpbmUuCisgIElmIGdpdCBpcyBub3QgaW5zdGFsbGVkLCBidXQgbWVyY3VyaWFsIChoZykgaXMg
aW5zdGFsbGVkIGFuZCBhbiAuaGcKKyAgICAgIHJlcG9zaXRvcnkgZXhpc3RzLCB0aGUgZm9sbG93
aW5nIG9wdGlvbnMgYXBwbHkgdG8gbWVyY3VyaWFsOgorICAgICAgICAgIC0tZ2l0LAorICAgICAg
ICAgIC0tZ2l0LW1pbi1zaWduYXR1cmVzLCAtLWdpdC1tYXgtbWFpbnRhaW5lcnMsIC0tZ2l0LW1p
bi1wZXJjZW50LCBhbmQKKyAgICAgICAgICAtLWdpdC1ibGFtZQorICAgICAgVXNlIC0taGctc2lu
Y2Ugbm90IC0tZ2l0LXNpbmNlIHRvIGNvbnRyb2wgZGF0ZSBzZWxlY3Rpb24KKyAgRmlsZSAiLmdl
dF9tYWludGFpbmVyLmNvbmYiLCBpZiBpdCBleGlzdHMgaW4gdGhlIGt2bS11bml0LXRlc3RzIHNv
dXJjZSByb290CisgICAgICBkaXJlY3RvcnksIGNhbiBjaGFuZ2Ugd2hhdGV2ZXIgZ2V0X21haW50
YWluZXIgZGVmYXVsdHMgYXJlIGRlc2lyZWQuCisgICAgICBFbnRyaWVzIGluIHRoaXMgZmlsZSBj
YW4gYmUgYW55IGNvbW1hbmQgbGluZSBhcmd1bWVudC4KKyAgICAgIFRoaXMgZmlsZSBpcyBwcmVw
ZW5kZWQgdG8gYW55IGFkZGl0aW9uYWwgY29tbWFuZCBsaW5lIGFyZ3VtZW50cy4KKyAgICAgIE11
bHRpcGxlIGxpbmVzIGFuZCAjIGNvbW1lbnRzIGFyZSBhbGxvd2VkLgorICBNb3N0IG9wdGlvbnMg
aGF2ZSBib3RoIHBvc2l0aXZlIGFuZCBuZWdhdGl2ZSBmb3Jtcy4KKyAgICAgIFRoZSBuZWdhdGl2
ZSBmb3JtcyBmb3IgLS08Zm9vPiBhcmUgLS1ubzxmb28+IGFuZCAtLW5vLTxmb28+LgorCitFT1QK
K30KKworc3ViIHBhcnNlX2VtYWlsIHsKKyAgICBteSAoJGZvcm1hdHRlZF9lbWFpbCkgPSBAXzsK
KworICAgIG15ICRuYW1lID0gIiI7CisgICAgbXkgJGFkZHJlc3MgPSAiIjsKKworICAgIGlmICgk
Zm9ybWF0dGVkX2VtYWlsID1+IC9eKFtePF0rKTwoLitcQC4qKT4uKiQvKSB7CisJJG5hbWUgPSAk
MTsKKwkkYWRkcmVzcyA9ICQyOworICAgIH0gZWxzaWYgKCRmb3JtYXR0ZWRfZW1haWwgPX4gL15c
cyo8KC4rXEBcUyopPi4qJC8pIHsKKwkkYWRkcmVzcyA9ICQxOworICAgIH0gZWxzaWYgKCRmb3Jt
YXR0ZWRfZW1haWwgPX4gL14oLitcQFxTKikuKiQvKSB7CisJJGFkZHJlc3MgPSAkMTsKKyAgICB9
CisKKyAgICAkbmFtZSA9fiBzL15ccyt8XHMrJC8vZzsKKyAgICAkbmFtZSA9fiBzL15cInxcIiQv
L2c7CisgICAgJGFkZHJlc3MgPX4gcy9eXHMrfFxzKyQvL2c7CisKKyAgICBpZiAoJG5hbWUgPX4g
L1teXHcgXC1dL2kpIHsgIAkgIyNoYXMgIm11c3QgcXVvdGUiIGNoYXJzCisJJG5hbWUgPX4gcy8o
PzwhXFwpIi9cXCIvZzsgICAgICAgIyNlc2NhcGUgcXVvdGVzCisJJG5hbWUgPSAiXCIkbmFtZVwi
IjsKKyAgICB9CisKKyAgICByZXR1cm4gKCRuYW1lLCAkYWRkcmVzcyk7Cit9CisKK3N1YiBmb3Jt
YXRfZW1haWwgeworICAgIG15ICgkbmFtZSwgJGFkZHJlc3MsICR1c2VuYW1lKSA9IEBfOworCisg
ICAgbXkgJGZvcm1hdHRlZF9lbWFpbDsKKworICAgICRuYW1lID1+IHMvXlxzK3xccyskLy9nOwor
ICAgICRuYW1lID1+IHMvXlwifFwiJC8vZzsKKyAgICAkYWRkcmVzcyA9fiBzL15ccyt8XHMrJC8v
ZzsKKworICAgIGlmICgkbmFtZSA9fiAvW15cdyBcLV0vaSkgeyAgICAgICAgICAjI2hhcyAibXVz
dCBxdW90ZSIgY2hhcnMKKwkkbmFtZSA9fiBzLyg/PCFcXCkiL1xcIi9nOyAgICAgICAjI2VzY2Fw
ZSBxdW90ZXMKKwkkbmFtZSA9ICJcIiRuYW1lXCIiOworICAgIH0KKworICAgIGlmICgkdXNlbmFt
ZSkgeworCWlmICgiJG5hbWUiIGVxICIiKSB7CisJICAgICRmb3JtYXR0ZWRfZW1haWwgPSAiJGFk
ZHJlc3MiOworCX0gZWxzZSB7CisJICAgICRmb3JtYXR0ZWRfZW1haWwgPSAiJG5hbWUgPCRhZGRy
ZXNzPiI7CisJfQorICAgIH0gZWxzZSB7CisJJGZvcm1hdHRlZF9lbWFpbCA9ICRhZGRyZXNzOwor
ICAgIH0KKworICAgIHJldHVybiAkZm9ybWF0dGVkX2VtYWlsOworfQorCitzdWIgZmluZF9maXJz
dF9zZWN0aW9uIHsKKyAgICBteSAkaW5kZXggPSAwOworCisgICAgd2hpbGUgKCRpbmRleCA8IEB0
eXBldmFsdWUpIHsKKwlteSAkdHYgPSAkdHlwZXZhbHVlWyRpbmRleF07CisJaWYgKCgkdHYgPX4g
bS9eKFtBLVpdKTpccyooLiopLykpIHsKKwkgICAgbGFzdDsKKwl9CisJJGluZGV4Kys7CisgICAg
fQorCisgICAgcmV0dXJuICRpbmRleDsKK30KKworc3ViIGZpbmRfc3RhcnRpbmdfaW5kZXggewor
ICAgIG15ICgkaW5kZXgpID0gQF87CisKKyAgICB3aGlsZSAoJGluZGV4ID4gMCkgeworCW15ICR0
diA9ICR0eXBldmFsdWVbJGluZGV4XTsKKwlpZiAoISgkdHYgPX4gbS9eKFtBLVpdKTpccyooLiop
LykpIHsKKwkgICAgbGFzdDsKKwl9CisJJGluZGV4LS07CisgICAgfQorCisgICAgcmV0dXJuICRp
bmRleDsKK30KKworc3ViIGZpbmRfZW5kaW5nX2luZGV4IHsKKyAgICBteSAoJGluZGV4KSA9IEBf
OworCisgICAgd2hpbGUgKCRpbmRleCA8IEB0eXBldmFsdWUpIHsKKwlteSAkdHYgPSAkdHlwZXZh
bHVlWyRpbmRleF07CisJaWYgKCEoJHR2ID1+IG0vXihbQS1aXSk6XHMqKC4qKS8pKSB7CisJICAg
IGxhc3Q7CisJfQorCSRpbmRleCsrOworICAgIH0KKworICAgIHJldHVybiAkaW5kZXg7Cit9CisK
K3N1YiBnZXRfc3Vic3lzdGVtX25hbWUgeworICAgIG15ICgkaW5kZXgpID0gQF87CisKKyAgICBt
eSAkc3RhcnQgPSBmaW5kX3N0YXJ0aW5nX2luZGV4KCRpbmRleCk7CisKKyAgICBteSAkc3Vic3lz
dGVtID0gJHR5cGV2YWx1ZVskc3RhcnRdOworICAgIGlmICgkb3V0cHV0X3NlY3Rpb25fbWF4bGVu
ICYmIGxlbmd0aCgkc3Vic3lzdGVtKSA+ICRvdXRwdXRfc2VjdGlvbl9tYXhsZW4pIHsKKwkkc3Vi
c3lzdGVtID0gc3Vic3RyKCRzdWJzeXN0ZW0sIDAsICRvdXRwdXRfc2VjdGlvbl9tYXhsZW4gLSAz
KTsKKwkkc3Vic3lzdGVtID1+IHMvXHMqJC8vOworCSRzdWJzeXN0ZW0gPSAkc3Vic3lzdGVtIC4g
Ii4uLiI7CisgICAgfQorICAgIHJldHVybiAkc3Vic3lzdGVtOworfQorCitzdWIgZ2V0X21haW50
YWluZXJfcm9sZSB7CisgICAgbXkgKCRpbmRleCkgPSBAXzsKKworICAgIG15ICRpOworICAgIG15
ICRzdGFydCA9IGZpbmRfc3RhcnRpbmdfaW5kZXgoJGluZGV4KTsKKyAgICBteSAkZW5kID0gZmlu
ZF9lbmRpbmdfaW5kZXgoJGluZGV4KTsKKworICAgIG15ICRyb2xlID0gInVua25vd24iOworICAg
IG15ICRzdWJzeXN0ZW0gPSBnZXRfc3Vic3lzdGVtX25hbWUoJGluZGV4KTsKKworICAgIGZvciAo
JGkgPSAkc3RhcnQgKyAxOyAkaSA8ICRlbmQ7ICRpKyspIHsKKwlteSAkdHYgPSAkdHlwZXZhbHVl
WyRpXTsKKwlpZiAoJHR2ID1+IG0vXihbQS1aXSk6XHMqKC4qKS8pIHsKKwkgICAgbXkgJHB0eXBl
ID0gJDE7CisJICAgIG15ICRwdmFsdWUgPSAkMjsKKwkgICAgaWYgKCRwdHlwZSBlcSAiUyIpIHsK
KwkJJHJvbGUgPSAkcHZhbHVlOworCSAgICB9CisJfQorICAgIH0KKworICAgICRyb2xlID0gbGMo
JHJvbGUpOworICAgIGlmICAgICAgKCRyb2xlIGVxICJzdXBwb3J0ZWQiKSB7CisJJHJvbGUgPSAi
c3VwcG9ydGVyIjsKKyAgICB9IGVsc2lmICgkcm9sZSBlcSAibWFpbnRhaW5lZCIpIHsKKwkkcm9s
ZSA9ICJtYWludGFpbmVyIjsKKyAgICB9IGVsc2lmICgkcm9sZSBlcSAib2RkIGZpeGVzIikgewor
CSRyb2xlID0gIm9kZCBmaXhlciI7CisgICAgfSBlbHNpZiAoJHJvbGUgZXEgIm9ycGhhbiIpIHsK
Kwkkcm9sZSA9ICJvcnBoYW4gbWluZGVyIjsKKyAgICB9IGVsc2lmICgkcm9sZSBlcSAib2Jzb2xl
dGUiKSB7CisJJHJvbGUgPSAib2Jzb2xldGUgbWluZGVyIjsKKyAgICB9IGVsc2lmICgkcm9sZSBl
cSAiYnVyaWVkIGFsaXZlIGluIHJlcG9ydGVycyIpIHsKKwkkcm9sZSA9ICJjaGllZiBwZW5ndWlu
IjsKKyAgICB9CisKKyAgICByZXR1cm4gJHJvbGUgLiAiOiIgLiAkc3Vic3lzdGVtOworfQorCitz
dWIgZ2V0X2xpc3Rfcm9sZSB7CisgICAgbXkgKCRpbmRleCkgPSBAXzsKKworICAgIG15ICRzdWJz
eXN0ZW0gPSBnZXRfc3Vic3lzdGVtX25hbWUoJGluZGV4KTsKKworICAgIGlmICgkc3Vic3lzdGVt
IGVxICJUSEUgUkVTVCIpIHsKKwkkc3Vic3lzdGVtID0gIiI7CisgICAgfQorCisgICAgcmV0dXJu
ICRzdWJzeXN0ZW07Cit9CisKK3N1YiBhZGRfY2F0ZWdvcmllcyB7CisgICAgbXkgKCRpbmRleCkg
PSBAXzsKKworICAgIG15ICRpOworICAgIG15ICRzdGFydCA9IGZpbmRfc3RhcnRpbmdfaW5kZXgo
JGluZGV4KTsKKyAgICBteSAkZW5kID0gZmluZF9lbmRpbmdfaW5kZXgoJGluZGV4KTsKKworICAg
IHB1c2goQHN1YnN5c3RlbSwgJHR5cGV2YWx1ZVskc3RhcnRdKTsKKworICAgIGZvciAoJGkgPSAk
c3RhcnQgKyAxOyAkaSA8ICRlbmQ7ICRpKyspIHsKKwlteSAkdHYgPSAkdHlwZXZhbHVlWyRpXTsK
KwlpZiAoJHR2ID1+IG0vXihbQS1aXSk6XHMqKC4qKS8pIHsKKwkgICAgbXkgJHB0eXBlID0gJDE7
CisJICAgIG15ICRwdmFsdWUgPSAkMjsKKwkgICAgaWYgKCRwdHlwZSBlcSAiTCIpIHsKKwkJbXkg
JGxpc3RfYWRkcmVzcyA9ICRwdmFsdWU7CisJCW15ICRsaXN0X2FkZGl0aW9uYWwgPSAiIjsKKwkJ
bXkgJGxpc3Rfcm9sZSA9IGdldF9saXN0X3JvbGUoJGkpOworCisJCWlmICgkbGlzdF9yb2xlIG5l
ICIiKSB7CisJCSAgICAkbGlzdF9yb2xlID0gIjoiIC4gJGxpc3Rfcm9sZTsKKwkJfQorCQlpZiAo
JGxpc3RfYWRkcmVzcyA9fiBtLyhbXlxzXSspXHMrKC4qKSQvKSB7CisJCSAgICAkbGlzdF9hZGRy
ZXNzID0gJDE7CisJCSAgICAkbGlzdF9hZGRpdGlvbmFsID0gJDI7CisJCX0KKwkJaWYgKCRsaXN0
X2FkZGl0aW9uYWwgPX4gbS9zdWJzY3JpYmVycy1vbmx5LykgeworCQkgICAgaWYgKCRlbWFpbF9z
dWJzY3JpYmVyX2xpc3QpIHsKKwkJCWlmICghJGhhc2hfbGlzdF90b3tsYygkbGlzdF9hZGRyZXNz
KX0pIHsKKwkJCSAgICAkaGFzaF9saXN0X3Rve2xjKCRsaXN0X2FkZHJlc3MpfSA9IDE7CisJCQkg
ICAgcHVzaChAbGlzdF90bywgWyRsaXN0X2FkZHJlc3MsCisJCQkJCSAgICAic3Vic2NyaWJlciBs
aXN0JHtsaXN0X3JvbGV9Il0pOworCQkJfQorCQkgICAgfQorCQl9IGVsc2UgeworCQkgICAgaWYg
KCRlbWFpbF9saXN0KSB7CisJCQlpZiAoISRoYXNoX2xpc3RfdG97bGMoJGxpc3RfYWRkcmVzcyl9
KSB7CisJCQkgICAgaWYgKCRsaXN0X2FkZGl0aW9uYWwgPX4gbS9tb2RlcmF0ZWQvKSB7CisJCQkJ
aWYgKCRlbWFpbF9tb2RlcmF0ZWRfbGlzdCkgeworCQkJCSAgICAkaGFzaF9saXN0X3Rve2xjKCRs
aXN0X2FkZHJlc3MpfSA9IDE7CisJCQkJICAgIHB1c2goQGxpc3RfdG8sIFskbGlzdF9hZGRyZXNz
LAorCQkJCQkJICAgICJtb2RlcmF0ZWQgbGlzdCR7bGlzdF9yb2xlfSJdKTsKKwkJCQl9CisJCQkg
ICAgfSBlbHNlIHsKKwkJCQkkaGFzaF9saXN0X3Rve2xjKCRsaXN0X2FkZHJlc3MpfSA9IDE7CisJ
CQkJcHVzaChAbGlzdF90bywgWyRsaXN0X2FkZHJlc3MsCisJCQkJCQkib3BlbiBsaXN0JHtsaXN0
X3JvbGV9Il0pOworCQkJICAgIH0KKwkJCX0KKwkJICAgIH0KKwkJfQorCSAgICB9IGVsc2lmICgk
cHR5cGUgZXEgIk0iKSB7CisJCWlmICgkZW1haWxfbWFpbnRhaW5lcikgeworCQkgICAgbXkgJHJv
bGUgPSBnZXRfbWFpbnRhaW5lcl9yb2xlKCRpKTsKKwkJICAgIHB1c2hfZW1haWxfYWRkcmVzc2Vz
KCRwdmFsdWUsICRyb2xlKTsKKwkJfQorCSAgICB9IGVsc2lmICgkcHR5cGUgZXEgIlIiKSB7CisJ
CWlmICgkZW1haWxfcmV2aWV3ZXIpIHsKKwkJICAgIG15ICRzdWJzeXN0ZW0gPSBnZXRfc3Vic3lz
dGVtX25hbWUoJGkpOworCQkgICAgcHVzaF9lbWFpbF9hZGRyZXNzZXMoJHB2YWx1ZSwgInJldmll
d2VyOiRzdWJzeXN0ZW0iKTsKKwkJfQorCSAgICB9IGVsc2lmICgkcHR5cGUgZXEgIlQiKSB7CisJ
CXB1c2goQHNjbSwgJHB2YWx1ZSk7CisJICAgIH0gZWxzaWYgKCRwdHlwZSBlcSAiVyIpIHsKKwkJ
cHVzaChAd2ViLCAkcHZhbHVlKTsKKwkgICAgfSBlbHNpZiAoJHB0eXBlIGVxICJTIikgeworCQlw
dXNoKEBzdGF0dXMsICRwdmFsdWUpOworCSAgICB9CisJfQorICAgIH0KK30KKworc3ViIGVtYWls
X2ludXNlIHsKKyAgICBteSAoJG5hbWUsICRhZGRyZXNzKSA9IEBfOworCisgICAgcmV0dXJuIDEg
aWYgKCgkbmFtZSBlcSAiIikgJiYgKCRhZGRyZXNzIGVxICIiKSk7CisgICAgcmV0dXJuIDEgaWYg
KCgkbmFtZSBuZSAiIikgJiYgZXhpc3RzKCRlbWFpbF9oYXNoX25hbWV7bGMoJG5hbWUpfSkpOwor
ICAgIHJldHVybiAxIGlmICgoJGFkZHJlc3MgbmUgIiIpICYmIGV4aXN0cygkZW1haWxfaGFzaF9h
ZGRyZXNze2xjKCRhZGRyZXNzKX0pKTsKKworICAgIHJldHVybiAwOworfQorCitzdWIgcHVzaF9l
bWFpbF9hZGRyZXNzIHsKKyAgICBteSAoJGxpbmUsICRyb2xlKSA9IEBfOworCisgICAgbXkgKCRu
YW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFpbCgkbGluZSk7CisKKyAgICBpZiAoJGFkZHJlc3Mg
ZXEgIiIpIHsKKwlyZXR1cm4gMDsKKyAgICB9CisKKyAgICBpZiAoISRlbWFpbF9yZW1vdmVfZHVw
bGljYXRlcykgeworCXB1c2goQGVtYWlsX3RvLCBbZm9ybWF0X2VtYWlsKCRuYW1lLCAkYWRkcmVz
cywgJGVtYWlsX3VzZW5hbWUpLCAkcm9sZV0pOworICAgIH0gZWxzaWYgKCFlbWFpbF9pbnVzZSgk
bmFtZSwgJGFkZHJlc3MpKSB7CisJcHVzaChAZW1haWxfdG8sIFtmb3JtYXRfZW1haWwoJG5hbWUs
ICRhZGRyZXNzLCAkZW1haWxfdXNlbmFtZSksICRyb2xlXSk7CisJJGVtYWlsX2hhc2hfbmFtZXts
YygkbmFtZSl9KysgaWYgKCRuYW1lIG5lICIiKTsKKwkkZW1haWxfaGFzaF9hZGRyZXNze2xjKCRh
ZGRyZXNzKX0rKzsKKyAgICB9CisKKyAgICByZXR1cm4gMTsKK30KKworc3ViIHB1c2hfZW1haWxf
YWRkcmVzc2VzIHsKKyAgICBteSAoJGFkZHJlc3MsICRyb2xlKSA9IEBfOworCisgICAgbXkgQGFk
ZHJlc3NfbGlzdCA9ICgpOworCisgICAgaWYgKHJmYzgyMl92YWxpZCgkYWRkcmVzcykpIHsKKwlw
dXNoX2VtYWlsX2FkZHJlc3MoJGFkZHJlc3MsICRyb2xlKTsKKyAgICB9IGVsc2lmIChAYWRkcmVz
c19saXN0ID0gcmZjODIyX3ZhbGlkbGlzdCgkYWRkcmVzcykpIHsKKwlteSAkYXJyYXlfY291bnQg
PSBzaGlmdChAYWRkcmVzc19saXN0KTsKKwl3aGlsZSAobXkgJGVudHJ5ID0gc2hpZnQoQGFkZHJl
c3NfbGlzdCkpIHsKKwkgICAgcHVzaF9lbWFpbF9hZGRyZXNzKCRlbnRyeSwgJHJvbGUpOworCX0K
KyAgICB9IGVsc2UgeworCWlmICghcHVzaF9lbWFpbF9hZGRyZXNzKCRhZGRyZXNzLCAkcm9sZSkp
IHsKKwkgICAgd2FybigiSW52YWxpZCBNQUlOVEFJTkVSUyBhZGRyZXNzOiAnIiAuICRhZGRyZXNz
IC4gIidcbiIpOworCX0KKyAgICB9Cit9CisKK3N1YiBhZGRfcm9sZSB7CisgICAgbXkgKCRsaW5l
LCAkcm9sZSkgPSBAXzsKKworICAgIG15ICgkbmFtZSwgJGFkZHJlc3MpID0gcGFyc2VfZW1haWwo
JGxpbmUpOworICAgIG15ICRlbWFpbCA9IGZvcm1hdF9lbWFpbCgkbmFtZSwgJGFkZHJlc3MsICRl
bWFpbF91c2VuYW1lKTsKKworICAgIGZvcmVhY2ggbXkgJGVudHJ5IChAZW1haWxfdG8pIHsKKwlp
ZiAoJGVtYWlsX3JlbW92ZV9kdXBsaWNhdGVzKSB7CisJICAgIG15ICgkZW50cnlfbmFtZSwgJGVu
dHJ5X2FkZHJlc3MpID0gcGFyc2VfZW1haWwoJGVudHJ5LT5bMF0pOworCSAgICBpZiAoKCRuYW1l
IGVxICRlbnRyeV9uYW1lIHx8ICRhZGRyZXNzIGVxICRlbnRyeV9hZGRyZXNzKQorCQkmJiAoJHJv
bGUgZXEgIiIgfHwgISgkZW50cnktPlsxXSA9fiBtLyRyb2xlLykpCisJICAgICkgeworCQlpZiAo
JGVudHJ5LT5bMV0gZXEgIiIpIHsKKwkJICAgICRlbnRyeS0+WzFdID0gIiRyb2xlIjsKKwkJfSBl
bHNlIHsKKwkJICAgICRlbnRyeS0+WzFdID0gIiRlbnRyeS0+WzFdLCRyb2xlIjsKKwkJfQorCSAg
ICB9CisJfSBlbHNlIHsKKwkgICAgaWYgKCRlbWFpbCBlcSAkZW50cnktPlswXQorCQkmJiAoJHJv
bGUgZXEgIiIgfHwgISgkZW50cnktPlsxXSA9fiBtLyRyb2xlLykpCisJICAgICkgeworCQlpZiAo
JGVudHJ5LT5bMV0gZXEgIiIpIHsKKwkJICAgICRlbnRyeS0+WzFdID0gIiRyb2xlIjsKKwkJfSBl
bHNlIHsKKwkJICAgICRlbnRyeS0+WzFdID0gIiRlbnRyeS0+WzFdLCRyb2xlIjsKKwkJfQorCSAg
ICB9CisJfQorICAgIH0KK30KKworc3ViIHdoaWNoIHsKKyAgICBteSAoJGJpbikgPSBAXzsKKwor
ICAgIGZvcmVhY2ggbXkgJHBhdGggKHNwbGl0KC86LywgJEVOVntQQVRIfSkpIHsKKwlpZiAoLWUg
IiRwYXRoLyRiaW4iKSB7CisJICAgIHJldHVybiAiJHBhdGgvJGJpbiI7CisJfQorICAgIH0KKwor
ICAgIHJldHVybiAiIjsKK30KKworc3ViIHdoaWNoX2NvbmYgeworICAgIG15ICgkY29uZikgPSBA
XzsKKworICAgIGZvcmVhY2ggbXkgJHBhdGggKHNwbGl0KC86LywgIi46JEVOVntIT01FfTouc2Ny
aXB0cyIpKSB7CisJaWYgKC1lICIkcGF0aC8kY29uZiIpIHsKKwkgICAgcmV0dXJuICIkcGF0aC8k
Y29uZiI7CisJfQorICAgIH0KKworICAgIHJldHVybiAiIjsKK30KKworc3ViIG1haWxtYXBfZW1h
aWwgeworICAgIG15ICgkbGluZSkgPSBAXzsKKworICAgIG15ICgkbmFtZSwgJGFkZHJlc3MpID0g
cGFyc2VfZW1haWwoJGxpbmUpOworICAgIG15ICRlbWFpbCA9IGZvcm1hdF9lbWFpbCgkbmFtZSwg
JGFkZHJlc3MsIDEpOworICAgIG15ICRyZWFsX25hbWUgPSAkbmFtZTsKKyAgICBteSAkcmVhbF9h
ZGRyZXNzID0gJGFkZHJlc3M7CisKKyAgICBpZiAoZXhpc3RzICRtYWlsbWFwLT57bmFtZXN9LT57
JGVtYWlsfSB8fAorCWV4aXN0cyAkbWFpbG1hcC0+e2FkZHJlc3Nlc30tPnskZW1haWx9KSB7CisJ
aWYgKGV4aXN0cyAkbWFpbG1hcC0+e25hbWVzfS0+eyRlbWFpbH0pIHsKKwkgICAgJHJlYWxfbmFt
ZSA9ICRtYWlsbWFwLT57bmFtZXN9LT57JGVtYWlsfTsKKwl9CisJaWYgKGV4aXN0cyAkbWFpbG1h
cC0+e2FkZHJlc3Nlc30tPnskZW1haWx9KSB7CisJICAgICRyZWFsX2FkZHJlc3MgPSAkbWFpbG1h
cC0+e2FkZHJlc3Nlc30tPnskZW1haWx9OworCX0KKyAgICB9IGVsc2UgeworCWlmIChleGlzdHMg
JG1haWxtYXAtPntuYW1lc30tPnskYWRkcmVzc30pIHsKKwkgICAgJHJlYWxfbmFtZSA9ICRtYWls
bWFwLT57bmFtZXN9LT57JGFkZHJlc3N9OworCX0KKwlpZiAoZXhpc3RzICRtYWlsbWFwLT57YWRk
cmVzc2VzfS0+eyRhZGRyZXNzfSkgeworCSAgICAkcmVhbF9hZGRyZXNzID0gJG1haWxtYXAtPnth
ZGRyZXNzZXN9LT57JGFkZHJlc3N9OworCX0KKyAgICB9CisgICAgcmV0dXJuIGZvcm1hdF9lbWFp
bCgkcmVhbF9uYW1lLCAkcmVhbF9hZGRyZXNzLCAxKTsKK30KKworc3ViIG1haWxtYXAgeworICAg
IG15IChAYWRkcmVzc2VzKSA9IEBfOworCisgICAgbXkgQG1hcHBlZF9lbWFpbHMgPSAoKTsKKyAg
ICBmb3JlYWNoIG15ICRsaW5lIChAYWRkcmVzc2VzKSB7CisJcHVzaChAbWFwcGVkX2VtYWlscywg
bWFpbG1hcF9lbWFpbCgkbGluZSkpOworICAgIH0KKyAgICBtZXJnZV9ieV9yZWFsbmFtZShAbWFw
cGVkX2VtYWlscykgaWYgKCRlbWFpbF91c2VfbWFpbG1hcCk7CisgICAgcmV0dXJuIEBtYXBwZWRf
ZW1haWxzOworfQorCitzdWIgbWVyZ2VfYnlfcmVhbG5hbWUgeworICAgIG15ICVhZGRyZXNzX21h
cDsKKyAgICBteSAoQGVtYWlscykgPSBAXzsKKworICAgIGZvcmVhY2ggbXkgJGVtYWlsIChAZW1h
aWxzKSB7CisJbXkgKCRuYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFpbCgkZW1haWwpOworCWlm
IChleGlzdHMgJGFkZHJlc3NfbWFweyRuYW1lfSkgeworCSAgICAkYWRkcmVzcyA9ICRhZGRyZXNz
X21hcHskbmFtZX07CisJICAgICRlbWFpbCA9IGZvcm1hdF9lbWFpbCgkbmFtZSwgJGFkZHJlc3Ms
IDEpOworCX0gZWxzZSB7CisJICAgICRhZGRyZXNzX21hcHskbmFtZX0gPSAkYWRkcmVzczsKKwl9
CisgICAgfQorfQorCitzdWIgZ2l0X2V4ZWN1dGVfY21kIHsKKyAgICBteSAoJGNtZCkgPSBAXzsK
KyAgICBteSBAbGluZXMgPSAoKTsKKworICAgIG15ICRvdXRwdXQgPSBgJGNtZGA7CisgICAgJG91
dHB1dCA9fiBzL15ccyovL2dtOworICAgIEBsaW5lcyA9IHNwbGl0KCJcbiIsICRvdXRwdXQpOwor
CisgICAgcmV0dXJuIEBsaW5lczsKK30KKworc3ViIGhnX2V4ZWN1dGVfY21kIHsKKyAgICBteSAo
JGNtZCkgPSBAXzsKKyAgICBteSBAbGluZXMgPSAoKTsKKworICAgIG15ICRvdXRwdXQgPSBgJGNt
ZGA7CisgICAgQGxpbmVzID0gc3BsaXQoIlxuIiwgJG91dHB1dCk7CisKKyAgICByZXR1cm4gQGxp
bmVzOworfQorCitzdWIgZXh0cmFjdF9mb3JtYXR0ZWRfc2lnbmF0dXJlcyB7CisgICAgbXkgKEBz
aWduYXR1cmVfbGluZXMpID0gQF87CisKKyAgICBteSBAdHlwZSA9IEBzaWduYXR1cmVfbGluZXM7
CisKKyAgICBzL1xzKiguKik6LiovJDEvIGZvciAoQHR5cGUpOworCisgICAgIyBjdXQgLWYyLSAt
ZCI6IgorICAgIHMvXHMqLio6XHMqKC4rKVxzKi8kMS8gZm9yIChAc2lnbmF0dXJlX2xpbmVzKTsK
KworIyMgUmVmb3JtYXQgZW1haWwgYWRkcmVzc2VzICh3aXRoIG5hbWVzKSB0byBhdm9pZCBiYWRs
eSB3cml0dGVuIHNpZ25hdHVyZXMKKworICAgIGZvcmVhY2ggbXkgJHNpZ25lciAoQHNpZ25hdHVy
ZV9saW5lcykgeworCSRzaWduZXIgPSBkZWR1cGxpY2F0ZV9lbWFpbCgkc2lnbmVyKTsKKyAgICB9
CisKKyAgICByZXR1cm4gKFxAdHlwZSwgXEBzaWduYXR1cmVfbGluZXMpOworfQorCitzdWIgdmNz
X2ZpbmRfc2lnbmVycyB7CisgICAgbXkgKCRjbWQsICRmaWxlKSA9IEBfOworICAgIG15ICRjb21t
aXRzOworICAgIG15IEBsaW5lcyA9ICgpOworICAgIG15IEBzaWduYXR1cmVzID0gKCk7CisgICAg
bXkgQGF1dGhvcnMgPSAoKTsKKyAgICBteSBAc3RhdHMgPSAoKTsKKworICAgIEBsaW5lcyA9ICZ7
JFZDU19jbWRzeyJleGVjdXRlX2NtZCJ9fSgkY21kKTsKKworICAgIG15ICRwYXR0ZXJuID0gJFZD
U19jbWRzeyJjb21taXRfcGF0dGVybiJ9OworICAgIG15ICRhdXRob3JfcGF0dGVybiA9ICRWQ1Nf
Y21kc3siYXV0aG9yX3BhdHRlcm4ifTsKKyAgICBteSAkc3RhdF9wYXR0ZXJuID0gJFZDU19jbWRz
eyJzdGF0X3BhdHRlcm4ifTsKKworICAgICRzdGF0X3BhdHRlcm4gPX4gcy8oXCRcdyspLyQxL2Vl
ZzsJCSNpbnRlcnBvbGF0ZSAkc3RhdF9wYXR0ZXJuCisKKyAgICAkY29tbWl0cyA9IGdyZXAoLyRw
YXR0ZXJuLywgQGxpbmVzKTsJIyBvZiBjb21taXRzCisKKyAgICBAYXV0aG9ycyA9IGdyZXAoLyRh
dXRob3JfcGF0dGVybi8sIEBsaW5lcyk7CisgICAgQHNpZ25hdHVyZXMgPSBncmVwKC9eWyBcdF0q
JHtzaWduYXR1cmVfcGF0dGVybn0uKlxALiokLywgQGxpbmVzKTsKKyAgICBAc3RhdHMgPSBncmVw
KC8kc3RhdF9wYXR0ZXJuLywgQGxpbmVzKTsKKworIyAgICBwcmludCgic3RhdHM6IDxAc3RhdHM+
XG4iKTsKKworICAgIHJldHVybiAoMCwgXEBzaWduYXR1cmVzLCBcQGF1dGhvcnMsIFxAc3RhdHMp
IGlmICFAc2lnbmF0dXJlczsKKworICAgIHNhdmVfY29tbWl0c19ieV9hdXRob3IoQGxpbmVzKSBp
ZiAoJGludGVyYWN0aXZlKTsKKyAgICBzYXZlX2NvbW1pdHNfYnlfc2lnbmVyKEBsaW5lcykgaWYg
KCRpbnRlcmFjdGl2ZSk7CisKKyAgICBteSAoJGF1dGhvcl9yZWYsICRhdXRob3JzX3JlZikgPSBl
eHRyYWN0X2Zvcm1hdHRlZF9zaWduYXR1cmVzKEBhdXRob3JzKTsKKyAgICBteSAoJHR5cGVzX3Jl
ZiwgJHNpZ25lcnNfcmVmKSA9IGV4dHJhY3RfZm9ybWF0dGVkX3NpZ25hdHVyZXMoQHNpZ25hdHVy
ZXMpOworCisgICAgcmV0dXJuICgkY29tbWl0cywgJHNpZ25lcnNfcmVmLCAkYXV0aG9yc19yZWYs
IFxAc3RhdHMpOworfQorCitzdWIgdmNzX2ZpbmRfYXV0aG9yIHsKKyAgICBteSAoJGNtZCkgPSBA
XzsKKyAgICBteSBAbGluZXMgPSAoKTsKKworICAgIEBsaW5lcyA9ICZ7JFZDU19jbWRzeyJleGVj
dXRlX2NtZCJ9fSgkY21kKTsKKworICAgIHJldHVybiBAbGluZXMgaWYgIUBsaW5lczsKKworICAg
IG15IEBhdXRob3JzID0gKCk7CisgICAgZm9yZWFjaCBteSAkbGluZSAoQGxpbmVzKSB7CisJaWYg
KCRsaW5lID1+IG0vJFZDU19jbWRzeyJhdXRob3JfcGF0dGVybiJ9LykgeworCSAgICBteSAkYXV0
aG9yID0gJDE7CisJICAgIG15ICgkbmFtZSwgJGFkZHJlc3MpID0gcGFyc2VfZW1haWwoJGF1dGhv
cik7CisJICAgICRhdXRob3IgPSBmb3JtYXRfZW1haWwoJG5hbWUsICRhZGRyZXNzLCAxKTsKKwkg
ICAgcHVzaChAYXV0aG9ycywgJGF1dGhvcik7CisJfQorICAgIH0KKworICAgIHNhdmVfY29tbWl0
c19ieV9hdXRob3IoQGxpbmVzKSBpZiAoJGludGVyYWN0aXZlKTsKKyAgICBzYXZlX2NvbW1pdHNf
Ynlfc2lnbmVyKEBsaW5lcykgaWYgKCRpbnRlcmFjdGl2ZSk7CisKKyAgICByZXR1cm4gQGF1dGhv
cnM7Cit9CisKK3N1YiB2Y3Nfc2F2ZV9jb21taXRzIHsKKyAgICBteSAoJGNtZCkgPSBAXzsKKyAg
ICBteSBAbGluZXMgPSAoKTsKKyAgICBteSBAY29tbWl0cyA9ICgpOworCisgICAgQGxpbmVzID0g
JnskVkNTX2NtZHN7ImV4ZWN1dGVfY21kIn19KCRjbWQpOworCisgICAgZm9yZWFjaCBteSAkbGlu
ZSAoQGxpbmVzKSB7CisJaWYgKCRsaW5lID1+IG0vJFZDU19jbWRzeyJibGFtZV9jb21taXRfcGF0
dGVybiJ9LykgeworCSAgICBwdXNoKEBjb21taXRzLCAkMSk7CisJfQorICAgIH0KKworICAgIHJl
dHVybiBAY29tbWl0czsKK30KKworc3ViIHZjc19ibGFtZSB7CisgICAgbXkgKCRmaWxlKSA9IEBf
OworICAgIG15ICRjbWQ7CisgICAgbXkgQGNvbW1pdHMgPSAoKTsKKworICAgIHJldHVybiBAY29t
bWl0cyBpZiAoISgtZiAkZmlsZSkpOworCisgICAgaWYgKEByYW5nZSAmJiAkVkNTX2NtZHN7ImJs
YW1lX3JhbmdlX2NtZCJ9IGVxICIiKSB7CisJbXkgQGFsbF9jb21taXRzID0gKCk7CisKKwkkY21k
ID0gJFZDU19jbWRzeyJibGFtZV9maWxlX2NtZCJ9OworCSRjbWQgPX4gcy8oXCRcdyspLyQxL2Vl
ZzsJCSNpbnRlcnBvbGF0ZSAkY21kCisJQGFsbF9jb21taXRzID0gdmNzX3NhdmVfY29tbWl0cygk
Y21kKTsKKworCWZvcmVhY2ggbXkgJGZpbGVfcmFuZ2VfZGlmZiAoQHJhbmdlKSB7CisJICAgIG5l
eHQgaWYgKCEoJGZpbGVfcmFuZ2VfZGlmZiA9fiBtLyguKyk6KC4rKTooLispLykpOworCSAgICBt
eSAkZGlmZl9maWxlID0gJDE7CisJICAgIG15ICRkaWZmX3N0YXJ0ID0gJDI7CisJICAgIG15ICRk
aWZmX2xlbmd0aCA9ICQzOworCSAgICBuZXh0IGlmICgiJGZpbGUiIG5lICIkZGlmZl9maWxlIik7
CisJICAgIGZvciAobXkgJGkgPSAkZGlmZl9zdGFydDsgJGkgPCAkZGlmZl9zdGFydCArICRkaWZm
X2xlbmd0aDsgJGkrKykgeworCQlwdXNoKEBjb21taXRzLCAkYWxsX2NvbW1pdHNbJGldKTsKKwkg
ICAgfQorCX0KKyAgICB9IGVsc2lmIChAcmFuZ2UpIHsKKwlmb3JlYWNoIG15ICRmaWxlX3Jhbmdl
X2RpZmYgKEByYW5nZSkgeworCSAgICBuZXh0IGlmICghKCRmaWxlX3JhbmdlX2RpZmYgPX4gbS8o
LispOiguKyk6KC4rKS8pKTsKKwkgICAgbXkgJGRpZmZfZmlsZSA9ICQxOworCSAgICBteSAkZGlm
Zl9zdGFydCA9ICQyOworCSAgICBteSAkZGlmZl9sZW5ndGggPSAkMzsKKwkgICAgbmV4dCBpZiAo
IiRmaWxlIiBuZSAiJGRpZmZfZmlsZSIpOworCSAgICAkY21kID0gJFZDU19jbWRzeyJibGFtZV9y
YW5nZV9jbWQifTsKKwkgICAgJGNtZCA9fiBzLyhcJFx3KykvJDEvZWVnOwkJI2ludGVycG9sYXRl
ICRjbWQKKwkgICAgcHVzaChAY29tbWl0cywgdmNzX3NhdmVfY29tbWl0cygkY21kKSk7CisJfQor
ICAgIH0gZWxzZSB7CisJJGNtZCA9ICRWQ1NfY21kc3siYmxhbWVfZmlsZV9jbWQifTsKKwkkY21k
ID1+IHMvKFwkXHcrKS8kMS9lZWc7CQkjaW50ZXJwb2xhdGUgJGNtZAorCUBjb21taXRzID0gdmNz
X3NhdmVfY29tbWl0cygkY21kKTsKKyAgICB9CisKKyAgICBmb3JlYWNoIG15ICRjb21taXQgKEBj
b21taXRzKSB7CisJJGNvbW1pdCA9fiBzL15cXi8vZzsKKyAgICB9CisKKyAgICByZXR1cm4gQGNv
bW1pdHM7Cit9CisKK215ICRwcmludGVkX25vdmNzID0gMDsKK3N1YiB2Y3NfZXhpc3RzIHsKKyAg
ICAlVkNTX2NtZHMgPSAlVkNTX2NtZHNfZ2l0OworICAgIHJldHVybiAxIGlmIGV2YWwgJFZDU19j
bWRzeyJhdmFpbGFibGUifTsKKyAgICAlVkNTX2NtZHMgPSAlVkNTX2NtZHNfaGc7CisgICAgcmV0
dXJuIDIgaWYgZXZhbCAkVkNTX2NtZHN7ImF2YWlsYWJsZSJ9OworICAgICVWQ1NfY21kcyA9ICgp
OworICAgIGlmICghJHByaW50ZWRfbm92Y3MpIHsKKwl3YXJuKCIkUDogTm8gc3VwcG9ydGVkIFZD
UyBmb3VuZC4gIEFkZCAtLW5vZ2l0IHRvIG9wdGlvbnM/XG4iKTsKKwl3YXJuKCJVc2luZyBhIGdp
dCByZXBvc2l0b3J5IHByb2R1Y2VzIGJldHRlciByZXN1bHRzLlxuIik7CisJd2FybigiVHJ5IGt2
bS11bml0LXRlc3RzJ3MgbGF0ZXN0IGdpdCByZXBvc2l0b3J5IHVzaW5nOlxuIik7CisJd2Fybigi
Z2l0IGNsb25lIGh0dHBzOi8vZ2l0bGFiLmNvbS9rdm0tdW5pdC10ZXN0cy9rdm0tdW5pdC10ZXN0
c1xuIik7CisJJHByaW50ZWRfbm92Y3MgPSAxOworICAgIH0KKyAgICByZXR1cm4gMDsKK30KKwor
c3ViIHZjc19pc19naXQgeworICAgIHZjc19leGlzdHMoKTsKKyAgICByZXR1cm4gJHZjc191c2Vk
ID09IDE7Cit9CisKK3N1YiB2Y3NfaXNfaGcgeworICAgIHJldHVybiAkdmNzX3VzZWQgPT0gMjsK
K30KKworc3ViIHZjc19hZGRfY29tbWl0X3NpZ25lcnMgeworICAgIHJldHVybiBpZiAoIXZjc19l
eGlzdHMoKSk7CisKKyAgICBteSAoJGNvbW1pdCwgJGRlc2MpID0gQF87CisgICAgbXkgJGNvbW1p
dF9jb3VudCA9IDA7CisgICAgbXkgJGNvbW1pdF9hdXRob3JzX3JlZjsKKyAgICBteSAkY29tbWl0
X3NpZ25lcnNfcmVmOworICAgIG15ICRzdGF0c19yZWY7CisgICAgbXkgQGNvbW1pdF9hdXRob3Jz
ID0gKCk7CisgICAgbXkgQGNvbW1pdF9zaWduZXJzID0gKCk7CisgICAgbXkgJGNtZDsKKworICAg
ICRjbWQgPSAkVkNTX2NtZHN7ImZpbmRfY29tbWl0X3NpZ25lcnNfY21kIn07CisgICAgJGNtZCA9
fiBzLyhcJFx3KykvJDEvZWVnOwkjc3Vic3RpdHV0ZSB2YXJpYWJsZXMgaW4gJGNtZAorCisgICAg
KCRjb21taXRfY291bnQsICRjb21taXRfc2lnbmVyc19yZWYsICRjb21taXRfYXV0aG9yc19yZWYs
ICRzdGF0c19yZWYpID0gdmNzX2ZpbmRfc2lnbmVycygkY21kLCAiIik7CisgICAgQGNvbW1pdF9h
dXRob3JzID0gQHskY29tbWl0X2F1dGhvcnNfcmVmfSBpZiBkZWZpbmVkICRjb21taXRfYXV0aG9y
c19yZWY7CisgICAgQGNvbW1pdF9zaWduZXJzID0gQHskY29tbWl0X3NpZ25lcnNfcmVmfSBpZiBk
ZWZpbmVkICRjb21taXRfc2lnbmVyc19yZWY7CisKKyAgICBmb3JlYWNoIG15ICRzaWduZXIgKEBj
b21taXRfc2lnbmVycykgeworCSRzaWduZXIgPSBkZWR1cGxpY2F0ZV9lbWFpbCgkc2lnbmVyKTsK
KyAgICB9CisKKyAgICB2Y3NfYXNzaWduKCRkZXNjLCAxLCBAY29tbWl0X3NpZ25lcnMpOworfQor
CitzdWIgaW50ZXJhY3RpdmVfZ2V0X21haW50YWluZXJzIHsKKyAgICBteSAoJGxpc3RfcmVmKSA9
IEBfOworICAgIG15IEBsaXN0ID0gQCRsaXN0X3JlZjsKKworICAgIHZjc19leGlzdHMoKTsKKwor
ICAgIG15ICVzZWxlY3RlZDsKKyAgICBteSAlYXV0aG9yZWQ7CisgICAgbXkgJXNpZ25lZDsKKyAg
ICBteSAkY291bnQgPSAwOworICAgIG15ICRtYWludGFpbmVkID0gMDsKKyAgICBmb3JlYWNoIG15
ICRlbnRyeSAoQGxpc3QpIHsKKwkkbWFpbnRhaW5lZCA9IDEgaWYgKCRlbnRyeS0+WzFdID1+IC9e
KG1haW50YWluZXJ8c3VwcG9ydGVyKS9pKTsKKwkkc2VsZWN0ZWR7JGNvdW50fSA9IDE7CisJJGF1
dGhvcmVkeyRjb3VudH0gPSAwOworCSRzaWduZWR7JGNvdW50fSA9IDA7CisJJGNvdW50Kys7Cisg
ICAgfQorCisgICAgI21lbnUgbG9vcAorICAgIG15ICRkb25lID0gMDsKKyAgICBteSAkcHJpbnRf
b3B0aW9ucyA9IDA7CisgICAgbXkgJHJlZHJhdyA9IDE7CisgICAgd2hpbGUgKCEkZG9uZSkgewor
CSRjb3VudCA9IDA7CisJaWYgKCRyZWRyYXcpIHsKKwkgICAgcHJpbnRmIFNUREVSUiAiXG4lMXMg
JTJzICUtNjVzIiwKKwkJCSAgIioiLCAiIyIsICJlbWFpbC9saXN0IGFuZCByb2xlOnN0YXRzIjsK
KwkgICAgaWYgKCRlbWFpbF9naXQgfHwKKwkJKCRlbWFpbF9naXRfZmFsbGJhY2sgJiYgISRtYWlu
dGFpbmVkKSB8fAorCQkkZW1haWxfZ2l0X2JsYW1lKSB7CisJCXByaW50IFNUREVSUiAiYXV0aCBz
aWduIjsKKwkgICAgfQorCSAgICBwcmludCBTVERFUlIgIlxuIjsKKwkgICAgZm9yZWFjaCBteSAk
ZW50cnkgKEBsaXN0KSB7CisJCW15ICRlbWFpbCA9ICRlbnRyeS0+WzBdOworCQlteSAkcm9sZSA9
ICRlbnRyeS0+WzFdOworCQlteSAkc2VsID0gIiI7CisJCSRzZWwgPSAiKiIgaWYgKCRzZWxlY3Rl
ZHskY291bnR9KTsKKwkJbXkgJGNvbW1pdF9hdXRob3IgPSAkY29tbWl0X2F1dGhvcl9oYXNoeyRl
bWFpbH07CisJCW15ICRjb21taXRfc2lnbmVyID0gJGNvbW1pdF9zaWduZXJfaGFzaHskZW1haWx9
OworCQlteSAkYXV0aG9yZWQgPSAwOworCQlteSAkc2lnbmVkID0gMDsKKwkJJGF1dGhvcmVkKysg
Zm9yIChAeyRjb21taXRfYXV0aG9yfSk7CisJCSRzaWduZWQrKyBmb3IgKEB7JGNvbW1pdF9zaWdu
ZXJ9KTsKKwkJcHJpbnRmIFNUREVSUiAiJTFzICUyZCAlLTY1cyIsICRzZWwsICRjb3VudCArIDEs
ICRlbWFpbDsKKwkJcHJpbnRmIFNUREVSUiAiJTRkICU0ZCIsICRhdXRob3JlZCwgJHNpZ25lZAor
CQkgICAgaWYgKCRhdXRob3JlZCA+IDAgfHwgJHNpZ25lZCA+IDApOworCQlwcmludGYgU1RERVJS
ICJcbiAgICAgJXNcbiIsICRyb2xlOworCQlpZiAoJGF1dGhvcmVkeyRjb3VudH0pIHsKKwkJICAg
IG15ICRjb21taXRfYXV0aG9yID0gJGNvbW1pdF9hdXRob3JfaGFzaHskZW1haWx9OworCQkgICAg
Zm9yZWFjaCBteSAkcmVmIChAeyRjb21taXRfYXV0aG9yfSkgeworCQkJcHJpbnQgU1RERVJSICIg
ICAgIEF1dGhvcjogQHskcmVmfVsxXVxuIjsKKwkJICAgIH0KKwkJfQorCQlpZiAoJHNpZ25lZHsk
Y291bnR9KSB7CisJCSAgICBteSAkY29tbWl0X3NpZ25lciA9ICRjb21taXRfc2lnbmVyX2hhc2h7
JGVtYWlsfTsKKwkJICAgIGZvcmVhY2ggbXkgJHJlZiAoQHskY29tbWl0X3NpZ25lcn0pIHsKKwkJ
CXByaW50IFNUREVSUiAiICAgICBAeyRyZWZ9WzJdOiBAeyRyZWZ9WzFdXG4iOworCQkgICAgfQor
CQl9CisKKwkJJGNvdW50Kys7CisJICAgIH0KKwl9CisJbXkgJGRhdGVfcmVmID0gXCRlbWFpbF9n
aXRfc2luY2U7CisJJGRhdGVfcmVmID0gXCRlbWFpbF9oZ19zaW5jZSBpZiAodmNzX2lzX2hnKCkp
OworCWlmICgkcHJpbnRfb3B0aW9ucykgeworCSAgICAkcHJpbnRfb3B0aW9ucyA9IDA7CisJICAg
IGlmICh2Y3NfZXhpc3RzKCkpIHsKKwkJcHJpbnQgU1RERVJSIDw8RU9UCisKK1ZlcnNpb24gQ29u
dHJvbCBvcHRpb25zOgorZyAgdXNlIGdpdCBoaXN0b3J5ICAgICAgWyRlbWFpbF9naXRdCitnZiB1
c2UgZ2l0LWZhbGxiYWNrICAgICBbJGVtYWlsX2dpdF9mYWxsYmFja10KK2IgIHVzZSBnaXQgYmxh
bWUgICAgICAgIFskZW1haWxfZ2l0X2JsYW1lXQorYnMgdXNlIGJsYW1lIHNpZ25hdHVyZXMgWyRl
bWFpbF9naXRfYmxhbWVfc2lnbmF0dXJlc10KK2MjIG1pbmltdW0gY29tbWl0cyAgICAgIFskZW1h
aWxfZ2l0X21pbl9zaWduYXR1cmVzXQorJSMgbWluIHBlcmNlbnQgICAgICAgICAgWyRlbWFpbF9n
aXRfbWluX3BlcmNlbnRdCitkIyBoaXN0b3J5IHRvIHVzZSAgICAgICBbJCRkYXRlX3JlZl0KK3gj
IG1heCBtYWludGFpbmVycyAgICAgIFskZW1haWxfZ2l0X21heF9tYWludGFpbmVyc10KK3QgIGFs
bCBzaWduYXR1cmUgdHlwZXMgIFskZW1haWxfZ2l0X2FsbF9zaWduYXR1cmVfdHlwZXNdCittICB1
c2UgLm1haWxtYXAgICAgICAgICBbJGVtYWlsX3VzZV9tYWlsbWFwXQorRU9UCisJICAgIH0KKwkg
ICAgcHJpbnQgU1RERVJSIDw8RU9UCisKK0FkZGl0aW9uYWwgb3B0aW9uczoKKzAgIHRvZ2dsZSBh
bGwKK3RtIHRvZ2dsZSBtYWludGFpbmVycwordGcgdG9nZ2xlIGdpdCBlbnRyaWVzCit0bCB0b2dn
bGUgb3BlbiBsaXN0IGVudHJpZXMKK3RzIHRvZ2dsZSBzdWJzY3JpYmVyIGxpc3QgZW50cmllcwor
ZiAgZW1haWxzIGluIGZpbGUgICAgICAgWyRlbWFpbF9maWxlX2VtYWlsc10KK2sgIGtleXdvcmRz
IGluIGZpbGUgICAgIFska2V5d29yZHNdCityICByZW1vdmUgZHVwbGljYXRlcyAgICBbJGVtYWls
X3JlbW92ZV9kdXBsaWNhdGVzXQorcCMgcGF0dGVybiBtYXRjaCBkZXB0aCAgWyRwYXR0ZXJuX2Rl
cHRoXQorRU9UCisJfQorCXByaW50IFNUREVSUgorIlxuIyh0b2dnbGUpLCBBIyhhdXRob3IpLCBT
IyhzaWduZWQpICooYWxsKSwgXihub25lKSwgTyhvcHRpb25zKSwgWShhcHByb3ZlKTogIjsKKwor
CW15ICRpbnB1dCA9IDxTVERJTj47CisJY2hvbXAoJGlucHV0KTsKKworCSRyZWRyYXcgPSAxOwor
CW15ICRyZXJ1biA9IDA7CisJbXkgQHdpc2ggPSBzcGxpdCgvWywgXSsvLCAkaW5wdXQpOworCWZv
cmVhY2ggbXkgJG5yIChAd2lzaCkgeworCSAgICAkbnIgPSBsYygkbnIpOworCSAgICBteSAkc2Vs
ID0gc3Vic3RyKCRuciwgMCwgMSk7CisJICAgIG15ICRzdHIgPSBzdWJzdHIoJG5yLCAxKTsKKwkg
ICAgbXkgJHZhbCA9IDA7CisJICAgICR2YWwgPSAkMSBpZiAkc3RyID1+IC9eKFxkKykkLzsKKwor
CSAgICBpZiAoJHNlbCBlcSAieSIpIHsKKwkJJGludGVyYWN0aXZlID0gMDsKKwkJJGRvbmUgPSAx
OworCQkkb3V0cHV0X3JvbGVzdGF0cyA9IDA7CisJCSRvdXRwdXRfcm9sZXMgPSAwOworCQlsYXN0
OworCSAgICB9IGVsc2lmICgkbnIgPX4gL15cZCskLyAmJiAkbnIgPiAwICYmICRuciA8PSAkY291
bnQpIHsKKwkJJHNlbGVjdGVkeyRuciAtIDF9ID0gISRzZWxlY3RlZHskbnIgLSAxfTsKKwkgICAg
fSBlbHNpZiAoJHNlbCBlcSAiKiIgfHwgJHNlbCBlcSAnXicpIHsKKwkJbXkgJHRvZ2dsZSA9IDA7
CisJCSR0b2dnbGUgPSAxIGlmICgkc2VsIGVxICcqJyk7CisJCWZvciAobXkgJGkgPSAwOyAkaSA8
ICRjb3VudDsgJGkrKykgeworCQkgICAgJHNlbGVjdGVkeyRpfSA9ICR0b2dnbGU7CisJCX0KKwkg
ICAgfSBlbHNpZiAoJHNlbCBlcSAiMCIpIHsKKwkJZm9yIChteSAkaSA9IDA7ICRpIDwgJGNvdW50
OyAkaSsrKSB7CisJCSAgICAkc2VsZWN0ZWR7JGl9ID0gISRzZWxlY3RlZHskaX07CisJCX0KKwkg
ICAgfSBlbHNpZiAoJHNlbCBlcSAidCIpIHsKKwkJaWYgKGxjKCRzdHIpIGVxICJtIikgeworCQkg
ICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGNvdW50OyAkaSsrKSB7CisJCQkkc2VsZWN0ZWR7JGl9
ID0gISRzZWxlY3RlZHskaX0KKwkJCSAgICBpZiAoJGxpc3RbJGldLT5bMV0gPX4gL14obWFpbnRh
aW5lcnxzdXBwb3J0ZXIpL2kpOworCQkgICAgfQorCQl9IGVsc2lmIChsYygkc3RyKSBlcSAiZyIp
IHsKKwkJICAgIGZvciAobXkgJGkgPSAwOyAkaSA8ICRjb3VudDsgJGkrKykgeworCQkJJHNlbGVj
dGVkeyRpfSA9ICEkc2VsZWN0ZWR7JGl9CisJCQkgICAgaWYgKCRsaXN0WyRpXS0+WzFdID1+IC9e
KGF1dGhvcnxjb21taXR8c2lnbmVyKS9pKTsKKwkJICAgIH0KKwkJfSBlbHNpZiAobGMoJHN0cikg
ZXEgImwiKSB7CisJCSAgICBmb3IgKG15ICRpID0gMDsgJGkgPCAkY291bnQ7ICRpKyspIHsKKwkJ
CSRzZWxlY3RlZHskaX0gPSAhJHNlbGVjdGVkeyRpfQorCQkJICAgIGlmICgkbGlzdFskaV0tPlsx
XSA9fiAvXihvcGVuIGxpc3QpL2kpOworCQkgICAgfQorCQl9IGVsc2lmIChsYygkc3RyKSBlcSAi
cyIpIHsKKwkJICAgIGZvciAobXkgJGkgPSAwOyAkaSA8ICRjb3VudDsgJGkrKykgeworCQkJJHNl
bGVjdGVkeyRpfSA9ICEkc2VsZWN0ZWR7JGl9CisJCQkgICAgaWYgKCRsaXN0WyRpXS0+WzFdID1+
IC9eKHN1YnNjcmliZXIgbGlzdCkvaSk7CisJCSAgICB9CisJCX0KKwkgICAgfSBlbHNpZiAoJHNl
bCBlcSAiYSIpIHsKKwkJaWYgKCR2YWwgPiAwICYmICR2YWwgPD0gJGNvdW50KSB7CisJCSAgICAk
YXV0aG9yZWR7JHZhbCAtIDF9ID0gISRhdXRob3JlZHskdmFsIC0gMX07CisJCX0gZWxzaWYgKCRz
dHIgZXEgJyonIHx8ICRzdHIgZXEgJ14nKSB7CisJCSAgICBteSAkdG9nZ2xlID0gMDsKKwkJICAg
ICR0b2dnbGUgPSAxIGlmICgkc3RyIGVxICcqJyk7CisJCSAgICBmb3IgKG15ICRpID0gMDsgJGkg
PCAkY291bnQ7ICRpKyspIHsKKwkJCSRhdXRob3JlZHskaX0gPSAkdG9nZ2xlOworCQkgICAgfQor
CQl9CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgInMiKSB7CisJCWlmICgkdmFsID4gMCAmJiAkdmFs
IDw9ICRjb3VudCkgeworCQkgICAgJHNpZ25lZHskdmFsIC0gMX0gPSAhJHNpZ25lZHskdmFsIC0g
MX07CisJCX0gZWxzaWYgKCRzdHIgZXEgJyonIHx8ICRzdHIgZXEgJ14nKSB7CisJCSAgICBteSAk
dG9nZ2xlID0gMDsKKwkJICAgICR0b2dnbGUgPSAxIGlmICgkc3RyIGVxICcqJyk7CisJCSAgICBm
b3IgKG15ICRpID0gMDsgJGkgPCAkY291bnQ7ICRpKyspIHsKKwkJCSRzaWduZWR7JGl9ID0gJHRv
Z2dsZTsKKwkJICAgIH0KKwkJfQorCSAgICB9IGVsc2lmICgkc2VsIGVxICJvIikgeworCQkkcHJp
bnRfb3B0aW9ucyA9IDE7CisJCSRyZWRyYXcgPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJn
IikgeworCQlpZiAoJHN0ciBlcSAiZiIpIHsKKwkJICAgIGJvb2xfaW52ZXJ0KFwkZW1haWxfZ2l0
X2ZhbGxiYWNrKTsKKwkJfSBlbHNlIHsKKwkJICAgIGJvb2xfaW52ZXJ0KFwkZW1haWxfZ2l0KTsK
KwkJfQorCQkkcmVydW4gPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJiIikgeworCQlpZiAo
JHN0ciBlcSAicyIpIHsKKwkJICAgIGJvb2xfaW52ZXJ0KFwkZW1haWxfZ2l0X2JsYW1lX3NpZ25h
dHVyZXMpOworCQl9IGVsc2UgeworCQkgICAgYm9vbF9pbnZlcnQoXCRlbWFpbF9naXRfYmxhbWUp
OworCQl9CisJCSRyZXJ1biA9IDE7CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgImMiKSB7CisJCWlm
ICgkdmFsID4gMCkgeworCQkgICAgJGVtYWlsX2dpdF9taW5fc2lnbmF0dXJlcyA9ICR2YWw7CisJ
CSAgICAkcmVydW4gPSAxOworCQl9CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgIngiKSB7CisJCWlm
ICgkdmFsID4gMCkgeworCQkgICAgJGVtYWlsX2dpdF9tYXhfbWFpbnRhaW5lcnMgPSAkdmFsOwor
CQkgICAgJHJlcnVuID0gMTsKKwkJfQorCSAgICB9IGVsc2lmICgkc2VsIGVxICIlIikgeworCQlp
ZiAoJHN0ciBuZSAiIiAmJiAkdmFsID49IDApIHsKKwkJICAgICRlbWFpbF9naXRfbWluX3BlcmNl
bnQgPSAkdmFsOworCQkgICAgJHJlcnVuID0gMTsKKwkJfQorCSAgICB9IGVsc2lmICgkc2VsIGVx
ICJkIikgeworCQlpZiAodmNzX2lzX2dpdCgpKSB7CisJCSAgICAkZW1haWxfZ2l0X3NpbmNlID0g
JHN0cjsKKwkJfSBlbHNpZiAodmNzX2lzX2hnKCkpIHsKKwkJICAgICRlbWFpbF9oZ19zaW5jZSA9
ICRzdHI7CisJCX0KKwkJJHJlcnVuID0gMTsKKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAidCIpIHsK
KwkJYm9vbF9pbnZlcnQoXCRlbWFpbF9naXRfYWxsX3NpZ25hdHVyZV90eXBlcyk7CisJCSRyZXJ1
biA9IDE7CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgImYiKSB7CisJCWJvb2xfaW52ZXJ0KFwkZW1h
aWxfZmlsZV9lbWFpbHMpOworCQkkcmVydW4gPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJy
IikgeworCQlib29sX2ludmVydChcJGVtYWlsX3JlbW92ZV9kdXBsaWNhdGVzKTsKKwkJJHJlcnVu
ID0gMTsKKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAibSIpIHsKKwkJYm9vbF9pbnZlcnQoXCRlbWFp
bF91c2VfbWFpbG1hcCk7CisJCXJlYWRfbWFpbG1hcCgpOworCQkkcmVydW4gPSAxOworCSAgICB9
IGVsc2lmICgkc2VsIGVxICJrIikgeworCQlib29sX2ludmVydChcJGtleXdvcmRzKTsKKwkJJHJl
cnVuID0gMTsKKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAicCIpIHsKKwkJaWYgKCRzdHIgbmUgIiIg
JiYgJHZhbCA+PSAwKSB7CisJCSAgICAkcGF0dGVybl9kZXB0aCA9ICR2YWw7CisJCSAgICAkcmVy
dW4gPSAxOworCQl9CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgImgiIHx8ICRzZWwgZXEgIj8iKSB7
CisJCXByaW50IFNUREVSUiA8PEVPVAorCitJbnRlcmFjdGl2ZSBtb2RlIGFsbG93cyB5b3UgdG8g
c2VsZWN0IHRoZSB2YXJpb3VzIG1haW50YWluZXJzLCBzdWJtaXR0ZXJzLAorY29tbWl0IHNpZ25l
cnMgYW5kIG1haWxpbmcgbGlzdHMgdGhhdCBjb3VsZCBiZSBDQydkIG9uIGEgcGF0Y2guCisKK0Fu
eSAqJ2QgZW50cnkgaXMgc2VsZWN0ZWQuCisKK0lmIHlvdSBoYXZlIGdpdCBvciBoZyBpbnN0YWxs
ZWQsIHlvdSBjYW4gY2hvb3NlIHRvIHN1bW1hcml6ZSB0aGUgY29tbWl0CitoaXN0b3J5IG9mIGZp
bGVzIGluIHRoZSBwYXRjaC4gIEFsc28sIGVhY2ggbGluZSBvZiB0aGUgY3VycmVudCBmaWxlIGNh
bgorYmUgbWF0Y2hlZCB0byBpdHMgY29tbWl0IGF1dGhvciBhbmQgdGhhdCBjb21taXRzIHNpZ25l
cnMgd2l0aCBibGFtZS4KKworVmFyaW91cyBrbm9icyBleGlzdCB0byBjb250cm9sIHRoZSBsZW5n
dGggb2YgdGltZSBmb3IgYWN0aXZlIGNvbW1pdAordHJhY2tpbmcsIHRoZSBtYXhpbXVtIG51bWJl
ciBvZiBjb21taXQgYXV0aG9ycyBhbmQgc2lnbmVycyB0byBhZGQsCithbmQgc3VjaC4KKworRW50
ZXIgc2VsZWN0aW9ucyBhdCB0aGUgcHJvbXB0IHVudGlsIHlvdSBhcmUgc2F0aXNmaWVkIHRoYXQg
dGhlIHNlbGVjdGVkCittYWludGFpbmVycyBhcmUgYXBwcm9wcmlhdGUuICBZb3UgbWF5IGVudGVy
IG11bHRpcGxlIHNlbGVjdGlvbnMgc2VwYXJhdGVkCitieSBlaXRoZXIgY29tbWFzIG9yIHNwYWNl
cy4KKworRU9UCisJICAgIH0gZWxzZSB7CisJCXByaW50IFNUREVSUiAiaW52YWxpZCBvcHRpb246
ICckbnInXG4iOworCQkkcmVkcmF3ID0gMDsKKwkgICAgfQorCX0KKwlpZiAoJHJlcnVuKSB7CisJ
ICAgIHByaW50IFNUREVSUiAiZ2l0LWJsYW1lIGNhbiBiZSB2ZXJ5IHNsb3csIHBsZWFzZSBoYXZl
IHBhdGllbmNlLi4uIgorCQlpZiAoJGVtYWlsX2dpdF9ibGFtZSk7CisJICAgIGdvdG8gJmdldF9t
YWludGFpbmVyczsKKwl9CisgICAgfQorCisgICAgI2Ryb3Agbm90IHNlbGVjdGVkIGVudHJpZXMK
KyAgICAkY291bnQgPSAwOworICAgIG15IEBuZXdfZW1haWx0byA9ICgpOworICAgIGZvcmVhY2gg
bXkgJGVudHJ5IChAbGlzdCkgeworCWlmICgkc2VsZWN0ZWR7JGNvdW50fSkgeworCSAgICBwdXNo
KEBuZXdfZW1haWx0bywgJGxpc3RbJGNvdW50XSk7CisJfQorCSRjb3VudCsrOworICAgIH0KKyAg
ICByZXR1cm4gQG5ld19lbWFpbHRvOworfQorCitzdWIgYm9vbF9pbnZlcnQgeworICAgIG15ICgk
Ym9vbF9yZWYpID0gQF87CisKKyAgICBpZiAoJCRib29sX3JlZikgeworCSQkYm9vbF9yZWYgPSAw
OworICAgIH0gZWxzZSB7CisJJCRib29sX3JlZiA9IDE7CisgICAgfQorfQorCitzdWIgZGVkdXBs
aWNhdGVfZW1haWwgeworICAgIG15ICgkZW1haWwpID0gQF87CisKKyAgICBteSAkbWF0Y2hlZCA9
IDA7CisgICAgbXkgKCRuYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFpbCgkZW1haWwpOworICAg
ICRlbWFpbCA9IGZvcm1hdF9lbWFpbCgkbmFtZSwgJGFkZHJlc3MsIDEpOworICAgICRlbWFpbCA9
IG1haWxtYXBfZW1haWwoJGVtYWlsKTsKKworICAgIHJldHVybiAkZW1haWwgaWYgKCEkZW1haWxf
cmVtb3ZlX2R1cGxpY2F0ZXMpOworCisgICAgKCRuYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFp
bCgkZW1haWwpOworCisgICAgaWYgKCRuYW1lIG5lICIiICYmICRkZWR1cGxpY2F0ZV9uYW1lX2hh
c2h7bGMoJG5hbWUpfSkgeworCSRuYW1lID0gJGRlZHVwbGljYXRlX25hbWVfaGFzaHtsYygkbmFt
ZSl9LT5bMF07CisJJGFkZHJlc3MgPSAkZGVkdXBsaWNhdGVfbmFtZV9oYXNoe2xjKCRuYW1lKX0t
PlsxXTsKKwkkbWF0Y2hlZCA9IDE7CisgICAgfSBlbHNpZiAoJGRlZHVwbGljYXRlX2FkZHJlc3Nf
aGFzaHtsYygkYWRkcmVzcyl9KSB7CisJJG5hbWUgPSAkZGVkdXBsaWNhdGVfYWRkcmVzc19oYXNo
e2xjKCRhZGRyZXNzKX0tPlswXTsKKwkkYWRkcmVzcyA9ICRkZWR1cGxpY2F0ZV9hZGRyZXNzX2hh
c2h7bGMoJGFkZHJlc3MpfS0+WzFdOworCSRtYXRjaGVkID0gMTsKKyAgICB9CisgICAgaWYgKCEk
bWF0Y2hlZCkgeworCSRkZWR1cGxpY2F0ZV9uYW1lX2hhc2h7bGMoJG5hbWUpfSA9IFsgJG5hbWUs
ICRhZGRyZXNzIF07CisJJGRlZHVwbGljYXRlX2FkZHJlc3NfaGFzaHtsYygkYWRkcmVzcyl9ID0g
WyAkbmFtZSwgJGFkZHJlc3MgXTsKKyAgICB9CisgICAgJGVtYWlsID0gZm9ybWF0X2VtYWlsKCRu
YW1lLCAkYWRkcmVzcywgMSk7CisgICAgJGVtYWlsID0gbWFpbG1hcF9lbWFpbCgkZW1haWwpOwor
ICAgIHJldHVybiAkZW1haWw7Cit9CisKK3N1YiBzYXZlX2NvbW1pdHNfYnlfYXV0aG9yIHsKKyAg
ICBteSAoQGxpbmVzKSA9IEBfOworCisgICAgbXkgQGF1dGhvcnMgPSAoKTsKKyAgICBteSBAY29t
bWl0cyA9ICgpOworICAgIG15IEBzdWJqZWN0cyA9ICgpOworCisgICAgZm9yZWFjaCBteSAkbGlu
ZSAoQGxpbmVzKSB7CisJaWYgKCRsaW5lID1+IG0vJFZDU19jbWRzeyJhdXRob3JfcGF0dGVybiJ9
LykgeworCSAgICBteSAkYXV0aG9yID0gJDE7CisJICAgICRhdXRob3IgPSBkZWR1cGxpY2F0ZV9l
bWFpbCgkYXV0aG9yKTsKKwkgICAgcHVzaChAYXV0aG9ycywgJGF1dGhvcik7CisJfQorCXB1c2go
QGNvbW1pdHMsICQxKSBpZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7ImNvbW1pdF9wYXR0ZXJuIn0v
KTsKKwlwdXNoKEBzdWJqZWN0cywgJDEpIGlmICgkbGluZSA9fiBtLyRWQ1NfY21kc3sic3ViamVj
dF9wYXR0ZXJuIn0vKTsKKyAgICB9CisKKyAgICBmb3IgKG15ICRpID0gMDsgJGkgPCBAYXV0aG9y
czsgJGkrKykgeworCW15ICRleGlzdHMgPSAwOworCWZvcmVhY2ggbXkgJHJlZihAeyRjb21taXRf
YXV0aG9yX2hhc2h7JGF1dGhvcnNbJGldfX0pIHsKKwkgICAgaWYgKEB7JHJlZn1bMF0gZXEgJGNv
bW1pdHNbJGldICYmCisJCUB7JHJlZn1bMV0gZXEgJHN1YmplY3RzWyRpXSkgeworCQkkZXhpc3Rz
ID0gMTsKKwkJbGFzdDsKKwkgICAgfQorCX0KKwlpZiAoISRleGlzdHMpIHsKKwkgICAgcHVzaChA
eyRjb21taXRfYXV0aG9yX2hhc2h7JGF1dGhvcnNbJGldfX0sCisJCSBbICgkY29tbWl0c1skaV0s
ICRzdWJqZWN0c1skaV0pIF0pOworCX0KKyAgICB9Cit9CisKK3N1YiBzYXZlX2NvbW1pdHNfYnlf
c2lnbmVyIHsKKyAgICBteSAoQGxpbmVzKSA9IEBfOworCisgICAgbXkgJGNvbW1pdCA9ICIiOwor
ICAgIG15ICRzdWJqZWN0ID0gIiI7CisKKyAgICBmb3JlYWNoIG15ICRsaW5lIChAbGluZXMpIHsK
KwkkY29tbWl0ID0gJDEgaWYgKCRsaW5lID1+IG0vJFZDU19jbWRzeyJjb21taXRfcGF0dGVybiJ9
Lyk7CisJJHN1YmplY3QgPSAkMSBpZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7InN1YmplY3RfcGF0
dGVybiJ9Lyk7CisJaWYgKCRsaW5lID1+IC9eWyBcdF0qJHtzaWduYXR1cmVfcGF0dGVybn0uKlxA
LiokLykgeworCSAgICBteSBAc2lnbmF0dXJlcyA9ICgkbGluZSk7CisJICAgIG15ICgkdHlwZXNf
cmVmLCAkc2lnbmVyc19yZWYpID0gZXh0cmFjdF9mb3JtYXR0ZWRfc2lnbmF0dXJlcyhAc2lnbmF0
dXJlcyk7CisJICAgIG15IEB0eXBlcyA9IEAkdHlwZXNfcmVmOworCSAgICBteSBAc2lnbmVycyA9
IEAkc2lnbmVyc19yZWY7CisKKwkgICAgbXkgJHR5cGUgPSAkdHlwZXNbMF07CisJICAgIG15ICRz
aWduZXIgPSAkc2lnbmVyc1swXTsKKworCSAgICAkc2lnbmVyID0gZGVkdXBsaWNhdGVfZW1haWwo
JHNpZ25lcik7CisKKwkgICAgbXkgJGV4aXN0cyA9IDA7CisJICAgIGZvcmVhY2ggbXkgJHJlZihA
eyRjb21taXRfc2lnbmVyX2hhc2h7JHNpZ25lcn19KSB7CisJCWlmIChAeyRyZWZ9WzBdIGVxICRj
b21taXQgJiYKKwkJICAgIEB7JHJlZn1bMV0gZXEgJHN1YmplY3QgJiYKKwkJICAgIEB7JHJlZn1b
Ml0gZXEgJHR5cGUpIHsKKwkJICAgICRleGlzdHMgPSAxOworCQkgICAgbGFzdDsKKwkJfQorCSAg
ICB9CisJICAgIGlmICghJGV4aXN0cykgeworCQlwdXNoKEB7JGNvbW1pdF9zaWduZXJfaGFzaHsk
c2lnbmVyfX0sCisJCSAgICAgWyAoJGNvbW1pdCwgJHN1YmplY3QsICR0eXBlKSBdKTsKKwkgICAg
fQorCX0KKyAgICB9Cit9CisKK3N1YiB2Y3NfYXNzaWduIHsKKyAgICBteSAoJHJvbGUsICRkaXZp
c29yLCBAbGluZXMpID0gQF87CisKKyAgICBteSAlaGFzaDsKKyAgICBteSAkY291bnQgPSAwOwor
CisgICAgcmV0dXJuIGlmIChAbGluZXMgPD0gMCk7CisKKyAgICBpZiAoJGRpdmlzb3IgPD0gMCkg
eworCXdhcm4oIkJhZCBkaXZpc29yIGluICIgLiAoY2FsbGVyKDApKVszXSAuICI6ICRkaXZpc29y
XG4iKTsKKwkkZGl2aXNvciA9IDE7CisgICAgfQorCisgICAgQGxpbmVzID0gbWFpbG1hcChAbGlu
ZXMpOworCisgICAgcmV0dXJuIGlmIChAbGluZXMgPD0gMCk7CisKKyAgICBAbGluZXMgPSBzb3J0
KEBsaW5lcyk7CisKKyAgICAjIHVuaXEgLWMKKyAgICAkaGFzaHskX30rKyBmb3IgQGxpbmVzOwor
CisgICAgIyBzb3J0IC1ybgorICAgIGZvcmVhY2ggbXkgJGxpbmUgKHNvcnQgeyRoYXNoeyRifSA8
PT4gJGhhc2h7JGF9fSBrZXlzICVoYXNoKSB7CisJbXkgJHNpZ25fb2ZmcyA9ICRoYXNoeyRsaW5l
fTsKKwlteSAkcGVyY2VudCA9ICRzaWduX29mZnMgKiAxMDAgLyAkZGl2aXNvcjsKKworCSRwZXJj
ZW50ID0gMTAwIGlmICgkcGVyY2VudCA+IDEwMCk7CisJbmV4dCBpZiAoaWdub3JlX2VtYWlsX2Fk
ZHJlc3MoJGxpbmUpKTsKKwkkY291bnQrKzsKKwlsYXN0IGlmICgkc2lnbl9vZmZzIDwgJGVtYWls
X2dpdF9taW5fc2lnbmF0dXJlcyB8fAorCQkgJGNvdW50ID4gJGVtYWlsX2dpdF9tYXhfbWFpbnRh
aW5lcnMgfHwKKwkJICRwZXJjZW50IDwgJGVtYWlsX2dpdF9taW5fcGVyY2VudCk7CisJcHVzaF9l
bWFpbF9hZGRyZXNzKCRsaW5lLCAnJyk7CisJaWYgKCRvdXRwdXRfcm9sZXN0YXRzKSB7CisJICAg
IG15ICRmbXRfcGVyY2VudCA9IHNwcmludGYoIiUuMGYiLCAkcGVyY2VudCk7CisJICAgIGFkZF9y
b2xlKCRsaW5lLCAiJHJvbGU6JHNpZ25fb2Zmcy8kZGl2aXNvcj0kZm10X3BlcmNlbnQlIik7CisJ
fSBlbHNlIHsKKwkgICAgYWRkX3JvbGUoJGxpbmUsICRyb2xlKTsKKwl9CisgICAgfQorfQorCitz
dWIgdmNzX2ZpbGVfc2lnbm9mZnMgeworICAgIG15ICgkZmlsZSkgPSBAXzsKKworICAgIG15ICRh
dXRob3JzX3JlZjsKKyAgICBteSAkc2lnbmVyc19yZWY7CisgICAgbXkgJHN0YXRzX3JlZjsKKyAg
ICBteSBAYXV0aG9ycyA9ICgpOworICAgIG15IEBzaWduZXJzID0gKCk7CisgICAgbXkgQHN0YXRz
ID0gKCk7CisgICAgbXkgJGNvbW1pdHM7CisKKyAgICAkdmNzX3VzZWQgPSB2Y3NfZXhpc3RzKCk7
CisgICAgcmV0dXJuIGlmICghJHZjc191c2VkKTsKKworICAgIG15ICRjbWQgPSAkVkNTX2NtZHN7
ImZpbmRfc2lnbmVyc19jbWQifTsKKyAgICAkY21kID1+IHMvKFwkXHcrKS8kMS9lZWc7CQkjIGlu
dGVycG9sYXRlICRjbWQKKworICAgICgkY29tbWl0cywgJHNpZ25lcnNfcmVmLCAkYXV0aG9yc19y
ZWYsICRzdGF0c19yZWYpID0gdmNzX2ZpbmRfc2lnbmVycygkY21kLCAkZmlsZSk7CisKKyAgICBA
c2lnbmVycyA9IEB7JHNpZ25lcnNfcmVmfSBpZiBkZWZpbmVkICRzaWduZXJzX3JlZjsKKyAgICBA
YXV0aG9ycyA9IEB7JGF1dGhvcnNfcmVmfSBpZiBkZWZpbmVkICRhdXRob3JzX3JlZjsKKyAgICBA
c3RhdHMgPSBAeyRzdGF0c19yZWZ9IGlmIGRlZmluZWQgJHN0YXRzX3JlZjsKKworIyAgICBwcmlu
dCgiY29tbWl0czogPCRjb21taXRzPlxuc2lnbmVyczo8QHNpZ25lcnM+XG5hdXRob3JzOiA8QGF1
dGhvcnM+XG5zdGF0czogPEBzdGF0cz5cbiIpOworCisgICAgZm9yZWFjaCBteSAkc2lnbmVyIChA
c2lnbmVycykgeworCSRzaWduZXIgPSBkZWR1cGxpY2F0ZV9lbWFpbCgkc2lnbmVyKTsKKyAgICB9
CisKKyAgICB2Y3NfYXNzaWduKCJjb21taXRfc2lnbmVyIiwgJGNvbW1pdHMsIEBzaWduZXJzKTsK
KyAgICB2Y3NfYXNzaWduKCJhdXRob3JlZCIsICRjb21taXRzLCBAYXV0aG9ycyk7CisgICAgaWYg
KCQjYXV0aG9ycyA9PSAkI3N0YXRzKSB7CisJbXkgJHN0YXRfcGF0dGVybiA9ICRWQ1NfY21kc3si
c3RhdF9wYXR0ZXJuIn07CisJJHN0YXRfcGF0dGVybiA9fiBzLyhcJFx3KykvJDEvZWVnOwkjaW50
ZXJwb2xhdGUgJHN0YXRfcGF0dGVybgorCisJbXkgJGFkZGVkID0gMDsKKwlteSAkZGVsZXRlZCA9
IDA7CisJZm9yIChteSAkaSA9IDA7ICRpIDw9ICQjc3RhdHM7ICRpKyspIHsKKwkgICAgaWYgKCRz
dGF0c1skaV0gPX4gLyRzdGF0X3BhdHRlcm4vKSB7CisJCSRhZGRlZCArPSAkMTsKKwkJJGRlbGV0
ZWQgKz0gJDI7CisJICAgIH0KKwl9CisJbXkgQHRtcF9hdXRob3JzID0gdW5pcShAYXV0aG9ycyk7
CisJZm9yZWFjaCBteSAkYXV0aG9yIChAdG1wX2F1dGhvcnMpIHsKKwkgICAgJGF1dGhvciA9IGRl
ZHVwbGljYXRlX2VtYWlsKCRhdXRob3IpOworCX0KKwlAdG1wX2F1dGhvcnMgPSB1bmlxKEB0bXBf
YXV0aG9ycyk7CisJbXkgQGxpc3RfYWRkZWQgPSAoKTsKKwlteSBAbGlzdF9kZWxldGVkID0gKCk7
CisJZm9yZWFjaCBteSAkYXV0aG9yIChAdG1wX2F1dGhvcnMpIHsKKwkgICAgbXkgJGF1dGhfYWRk
ZWQgPSAwOworCSAgICBteSAkYXV0aF9kZWxldGVkID0gMDsKKwkgICAgZm9yIChteSAkaSA9IDA7
ICRpIDw9ICQjc3RhdHM7ICRpKyspIHsKKwkJaWYgKCRhdXRob3IgZXEgZGVkdXBsaWNhdGVfZW1h
aWwoJGF1dGhvcnNbJGldKSAmJgorCQkgICAgJHN0YXRzWyRpXSA9fiAvJHN0YXRfcGF0dGVybi8p
IHsKKwkJICAgICRhdXRoX2FkZGVkICs9ICQxOworCQkgICAgJGF1dGhfZGVsZXRlZCArPSAkMjsK
KwkJfQorCSAgICB9CisJICAgIGZvciAobXkgJGkgPSAwOyAkaSA8ICRhdXRoX2FkZGVkOyAkaSsr
KSB7CisJCXB1c2goQGxpc3RfYWRkZWQsICRhdXRob3IpOworCSAgICB9CisJICAgIGZvciAobXkg
JGkgPSAwOyAkaSA8ICRhdXRoX2RlbGV0ZWQ7ICRpKyspIHsKKwkJcHVzaChAbGlzdF9kZWxldGVk
LCAkYXV0aG9yKTsKKwkgICAgfQorCX0KKwl2Y3NfYXNzaWduKCJhZGRlZF9saW5lcyIsICRhZGRl
ZCwgQGxpc3RfYWRkZWQpOworCXZjc19hc3NpZ24oInJlbW92ZWRfbGluZXMiLCAkZGVsZXRlZCwg
QGxpc3RfZGVsZXRlZCk7CisgICAgfQorfQorCitzdWIgdmNzX2ZpbGVfYmxhbWUgeworICAgIG15
ICgkZmlsZSkgPSBAXzsKKworICAgIG15IEBzaWduZXJzID0gKCk7CisgICAgbXkgQGFsbF9jb21t
aXRzID0gKCk7CisgICAgbXkgQGNvbW1pdHMgPSAoKTsKKyAgICBteSAkdG90YWxfY29tbWl0czsK
KyAgICBteSAkdG90YWxfbGluZXM7CisKKyAgICAkdmNzX3VzZWQgPSB2Y3NfZXhpc3RzKCk7Cisg
ICAgcmV0dXJuIGlmICghJHZjc191c2VkKTsKKworICAgIEBhbGxfY29tbWl0cyA9IHZjc19ibGFt
ZSgkZmlsZSk7CisgICAgQGNvbW1pdHMgPSB1bmlxKEBhbGxfY29tbWl0cyk7CisgICAgJHRvdGFs
X2NvbW1pdHMgPSBAY29tbWl0czsKKyAgICAkdG90YWxfbGluZXMgPSBAYWxsX2NvbW1pdHM7CisK
KyAgICBpZiAoJGVtYWlsX2dpdF9ibGFtZV9zaWduYXR1cmVzKSB7CisJaWYgKHZjc19pc19oZygp
KSB7CisJICAgIG15ICRjb21taXRfY291bnQ7CisJICAgIG15ICRjb21taXRfYXV0aG9yc19yZWY7
CisJICAgIG15ICRjb21taXRfc2lnbmVyc19yZWY7CisJICAgIG15ICRzdGF0c19yZWY7CisJICAg
IG15IEBjb21taXRfYXV0aG9ycyA9ICgpOworCSAgICBteSBAY29tbWl0X3NpZ25lcnMgPSAoKTsK
KwkgICAgbXkgJGNvbW1pdCA9IGpvaW4oIiAtciAiLCBAY29tbWl0cyk7CisJICAgIG15ICRjbWQ7
CisKKwkgICAgJGNtZCA9ICRWQ1NfY21kc3siZmluZF9jb21taXRfc2lnbmVyc19jbWQifTsKKwkg
ICAgJGNtZCA9fiBzLyhcJFx3KykvJDEvZWVnOwkjc3Vic3RpdHV0ZSB2YXJpYWJsZXMgaW4gJGNt
ZAorCisJICAgICgkY29tbWl0X2NvdW50LCAkY29tbWl0X3NpZ25lcnNfcmVmLCAkY29tbWl0X2F1
dGhvcnNfcmVmLCAkc3RhdHNfcmVmKSA9IHZjc19maW5kX3NpZ25lcnMoJGNtZCwgJGZpbGUpOwor
CSAgICBAY29tbWl0X2F1dGhvcnMgPSBAeyRjb21taXRfYXV0aG9yc19yZWZ9IGlmIGRlZmluZWQg
JGNvbW1pdF9hdXRob3JzX3JlZjsKKwkgICAgQGNvbW1pdF9zaWduZXJzID0gQHskY29tbWl0X3Np
Z25lcnNfcmVmfSBpZiBkZWZpbmVkICRjb21taXRfc2lnbmVyc19yZWY7CisKKwkgICAgcHVzaChA
c2lnbmVycywgQGNvbW1pdF9zaWduZXJzKTsKKwl9IGVsc2UgeworCSAgICBmb3JlYWNoIG15ICRj
b21taXQgKEBjb21taXRzKSB7CisJCW15ICRjb21taXRfY291bnQ7CisJCW15ICRjb21taXRfYXV0
aG9yc19yZWY7CisJCW15ICRjb21taXRfc2lnbmVyc19yZWY7CisJCW15ICRzdGF0c19yZWY7CisJ
CW15IEBjb21taXRfYXV0aG9ycyA9ICgpOworCQlteSBAY29tbWl0X3NpZ25lcnMgPSAoKTsKKwkJ
bXkgJGNtZDsKKworCQkkY21kID0gJFZDU19jbWRzeyJmaW5kX2NvbW1pdF9zaWduZXJzX2NtZCJ9
OworCQkkY21kID1+IHMvKFwkXHcrKS8kMS9lZWc7CSNzdWJzdGl0dXRlIHZhcmlhYmxlcyBpbiAk
Y21kCisKKwkJKCRjb21taXRfY291bnQsICRjb21taXRfc2lnbmVyc19yZWYsICRjb21taXRfYXV0
aG9yc19yZWYsICRzdGF0c19yZWYpID0gdmNzX2ZpbmRfc2lnbmVycygkY21kLCAkZmlsZSk7CisJ
CUBjb21taXRfYXV0aG9ycyA9IEB7JGNvbW1pdF9hdXRob3JzX3JlZn0gaWYgZGVmaW5lZCAkY29t
bWl0X2F1dGhvcnNfcmVmOworCQlAY29tbWl0X3NpZ25lcnMgPSBAeyRjb21taXRfc2lnbmVyc19y
ZWZ9IGlmIGRlZmluZWQgJGNvbW1pdF9zaWduZXJzX3JlZjsKKworCQlwdXNoKEBzaWduZXJzLCBA
Y29tbWl0X3NpZ25lcnMpOworCSAgICB9CisJfQorICAgIH0KKworICAgIGlmICgkZnJvbV9maWxl
bmFtZSkgeworCWlmICgkb3V0cHV0X3JvbGVzdGF0cykgeworCSAgICBteSBAYmxhbWVfc2lnbmVy
czsKKwkgICAgaWYgKHZjc19pc19oZygpKSB7ewkJIyBEb3VibGUgYnJhY2UgZm9yIGxhc3QgZXhp
dAorCQlteSAkY29tbWl0X2NvdW50OworCQlteSBAY29tbWl0X3NpZ25lcnMgPSAoKTsKKwkJQGNv
bW1pdHMgPSB1bmlxKEBjb21taXRzKTsKKwkJQGNvbW1pdHMgPSBzb3J0KEBjb21taXRzKTsKKwkJ
bXkgJGNvbW1pdCA9IGpvaW4oIiAtciAiLCBAY29tbWl0cyk7CisJCW15ICRjbWQ7CisKKwkJJGNt
ZCA9ICRWQ1NfY21kc3siZmluZF9jb21taXRfYXV0aG9yX2NtZCJ9OworCQkkY21kID1+IHMvKFwk
XHcrKS8kMS9lZWc7CSNzdWJzdGl0dXRlIHZhcmlhYmxlcyBpbiAkY21kCisKKwkJbXkgQGxpbmVz
ID0gKCk7CisKKwkJQGxpbmVzID0gJnskVkNTX2NtZHN7ImV4ZWN1dGVfY21kIn19KCRjbWQpOwor
CisJCWxhc3QgaWYgIUBsaW5lczsKKworCQlteSBAYXV0aG9ycyA9ICgpOworCQlmb3JlYWNoIG15
ICRsaW5lIChAbGluZXMpIHsKKwkJICAgIGlmICgkbGluZSA9fiBtLyRWQ1NfY21kc3siYXV0aG9y
X3BhdHRlcm4ifS8pIHsKKwkJCW15ICRhdXRob3IgPSAkMTsKKwkJCSRhdXRob3IgPSBkZWR1cGxp
Y2F0ZV9lbWFpbCgkYXV0aG9yKTsKKwkJCXB1c2goQGF1dGhvcnMsICRhdXRob3IpOworCQkgICAg
fQorCQl9CisKKwkJc2F2ZV9jb21taXRzX2J5X2F1dGhvcihAbGluZXMpIGlmICgkaW50ZXJhY3Rp
dmUpOworCQlzYXZlX2NvbW1pdHNfYnlfc2lnbmVyKEBsaW5lcykgaWYgKCRpbnRlcmFjdGl2ZSk7
CisKKwkJcHVzaChAc2lnbmVycywgQGF1dGhvcnMpOworCSAgICB9fQorCSAgICBlbHNlIHsKKwkJ
Zm9yZWFjaCBteSAkY29tbWl0IChAY29tbWl0cykgeworCQkgICAgbXkgJGk7CisJCSAgICBteSAk
Y21kID0gJFZDU19jbWRzeyJmaW5kX2NvbW1pdF9hdXRob3JfY21kIn07CisJCSAgICAkY21kID1+
IHMvKFwkXHcrKS8kMS9lZWc7CSNpbnRlcnBvbGF0ZSAkY21kCisJCSAgICBteSBAYXV0aG9yID0g
dmNzX2ZpbmRfYXV0aG9yKCRjbWQpOworCQkgICAgbmV4dCBpZiAhQGF1dGhvcjsKKworCQkgICAg
bXkgJGZvcm1hdHRlZF9hdXRob3IgPSBkZWR1cGxpY2F0ZV9lbWFpbCgkYXV0aG9yWzBdKTsKKwor
CQkgICAgbXkgJGNvdW50ID0gZ3JlcCgvJGNvbW1pdC8sIEBhbGxfY29tbWl0cyk7CisJCSAgICBm
b3IgKCRpID0gMDsgJGkgPCAkY291bnQgOyAkaSsrKSB7CisJCQlwdXNoKEBibGFtZV9zaWduZXJz
LCAkZm9ybWF0dGVkX2F1dGhvcik7CisJCSAgICB9CisJCX0KKwkgICAgfQorCSAgICBpZiAoQGJs
YW1lX3NpZ25lcnMpIHsKKwkJdmNzX2Fzc2lnbigiYXV0aG9yZWQgbGluZXMiLCAkdG90YWxfbGlu
ZXMsIEBibGFtZV9zaWduZXJzKTsKKwkgICAgfQorCX0KKwlmb3JlYWNoIG15ICRzaWduZXIgKEBz
aWduZXJzKSB7CisJICAgICRzaWduZXIgPSBkZWR1cGxpY2F0ZV9lbWFpbCgkc2lnbmVyKTsKKwl9
CisJdmNzX2Fzc2lnbigiY29tbWl0cyIsICR0b3RhbF9jb21taXRzLCBAc2lnbmVycyk7CisgICAg
fSBlbHNlIHsKKwlmb3JlYWNoIG15ICRzaWduZXIgKEBzaWduZXJzKSB7CisJICAgICRzaWduZXIg
PSBkZWR1cGxpY2F0ZV9lbWFpbCgkc2lnbmVyKTsKKwl9CisJdmNzX2Fzc2lnbigibW9kaWZpZWQg
Y29tbWl0cyIsICR0b3RhbF9jb21taXRzLCBAc2lnbmVycyk7CisgICAgfQorfQorCitzdWIgdmNz
X2ZpbGVfZXhpc3RzIHsKKyAgICBteSAoJGZpbGUpID0gQF87CisKKyAgICBteSAkZXhpc3RzOwor
CisgICAgbXkgJHZjc191c2VkID0gdmNzX2V4aXN0cygpOworICAgIHJldHVybiAwIGlmICghJHZj
c191c2VkKTsKKworICAgIG15ICRjbWQgPSAkVkNTX2NtZHN7ImZpbGVfZXhpc3RzX2NtZCJ9Owor
ICAgICRjbWQgPX4gcy8oXCRcdyspLyQxL2VlZzsJCSMgaW50ZXJwb2xhdGUgJGNtZAorICAgICRj
bWQgLj0gIiAyPiYxIjsKKyAgICAkZXhpc3RzID0gJnskVkNTX2NtZHN7ImV4ZWN1dGVfY21kIn19
KCRjbWQpOworCisgICAgcmV0dXJuIDAgaWYgKCQ/ICE9IDApOworCisgICAgcmV0dXJuICRleGlz
dHM7Cit9CisKK3N1YiB2Y3NfbGlzdF9maWxlcyB7CisgICAgbXkgKCRmaWxlKSA9IEBfOworCisg
ICAgbXkgQGxzZmlsZXMgPSAoKTsKKworICAgIG15ICR2Y3NfdXNlZCA9IHZjc19leGlzdHMoKTsK
KyAgICByZXR1cm4gMCBpZiAoISR2Y3NfdXNlZCk7CisKKyAgICBteSAkY21kID0gJFZDU19jbWRz
eyJsaXN0X2ZpbGVzX2NtZCJ9OworICAgICRjbWQgPX4gcy8oXCRcdyspLyQxL2VlZzsgICAjIGlu
dGVycG9sYXRlICRjbWQKKyAgICBAbHNmaWxlcyA9ICZ7JFZDU19jbWRzeyJleGVjdXRlX2NtZCJ9
fSgkY21kKTsKKworICAgIHJldHVybiAoKSBpZiAoJD8gIT0gMCk7CisKKyAgICByZXR1cm4gQGxz
ZmlsZXM7Cit9CisKK3N1YiB1bmlxIHsKKyAgICBteSAoQHBhcm1zKSA9IEBfOworCisgICAgbXkg
JXNhdzsKKyAgICBAcGFybXMgPSBncmVwKCEkc2F3eyRffSsrLCBAcGFybXMpOworICAgIHJldHVy
biBAcGFybXM7Cit9CisKK3N1YiBzb3J0X2FuZF91bmlxIHsKKyAgICBteSAoQHBhcm1zKSA9IEBf
OworCisgICAgbXkgJXNhdzsKKyAgICBAcGFybXMgPSBzb3J0IEBwYXJtczsKKyAgICBAcGFybXMg
PSBncmVwKCEkc2F3eyRffSsrLCBAcGFybXMpOworICAgIHJldHVybiBAcGFybXM7Cit9CisKK3N1
YiBjbGVhbl9maWxlX2VtYWlscyB7CisgICAgbXkgKEBmaWxlX2VtYWlscykgPSBAXzsKKyAgICBt
eSBAZm10X2VtYWlscyA9ICgpOworCisgICAgZm9yZWFjaCBteSAkZW1haWwgKEBmaWxlX2VtYWls
cykgeworCSRlbWFpbCA9fiBzL1tcKFw8XHtdezAsMX0oW0EtWmEtejAtOV9cLlwrLV0rXEBbQS1a
YS16MC05XC4tXSspW1wpXD5cfV17MCwxfS9cPCQxXD4vZzsKKwlteSAoJG5hbWUsICRhZGRyZXNz
KSA9IHBhcnNlX2VtYWlsKCRlbWFpbCk7CisJaWYgKCRuYW1lIGVxICciWyxcLl0iJykgeworCSAg
ICAkbmFtZSA9ICIiOworCX0KKworCW15IEBudyA9IHNwbGl0KC9bXkEtWmEtesOALcO/XCdcLFwu
XCstXS8sICRuYW1lKTsKKwlpZiAoQG53ID4gMikgeworCSAgICBteSAkZmlyc3QgPSAkbndbQG53
IC0gM107CisJICAgIG15ICRtaWRkbGUgPSAkbndbQG53IC0gMl07CisJICAgIG15ICRsYXN0ID0g
JG53W0BudyAtIDFdOworCisJICAgIGlmICgoKGxlbmd0aCgkZmlyc3QpID09IDEgJiYgJGZpcnN0
ID1+IG0vW0EtWmEtel0vKSB8fAorCQkgKGxlbmd0aCgkZmlyc3QpID09IDIgJiYgc3Vic3RyKCRm
aXJzdCwgLTEpIGVxICIuIikpIHx8CisJCShsZW5ndGgoJG1pZGRsZSkgPT0gMSB8fAorCQkgKGxl
bmd0aCgkbWlkZGxlKSA9PSAyICYmIHN1YnN0cigkbWlkZGxlLCAtMSkgZXEgIi4iKSkpIHsKKwkJ
JG5hbWUgPSAiJGZpcnN0ICRtaWRkbGUgJGxhc3QiOworCSAgICB9IGVsc2UgeworCQkkbmFtZSA9
ICIkbWlkZGxlICRsYXN0IjsKKwkgICAgfQorCX0KKworCWlmIChzdWJzdHIoJG5hbWUsIC0xKSA9
fiAvWyxcLl0vKSB7CisJICAgICRuYW1lID0gc3Vic3RyKCRuYW1lLCAwLCBsZW5ndGgoJG5hbWUp
IC0gMSk7CisJfSBlbHNpZiAoc3Vic3RyKCRuYW1lLCAtMikgPX4gL1ssXC5dIi8pIHsKKwkgICAg
JG5hbWUgPSBzdWJzdHIoJG5hbWUsIDAsIGxlbmd0aCgkbmFtZSkgLSAyKSAuICciJzsKKwl9CisK
KwlpZiAoc3Vic3RyKCRuYW1lLCAwLCAxKSA9fiAvWyxcLl0vKSB7CisJICAgICRuYW1lID0gc3Vi
c3RyKCRuYW1lLCAxLCBsZW5ndGgoJG5hbWUpIC0gMSk7CisJfSBlbHNpZiAoc3Vic3RyKCRuYW1l
LCAwLCAyKSA9fiAvIlssXC5dLykgeworCSAgICAkbmFtZSA9ICciJyAuIHN1YnN0cigkbmFtZSwg
MiwgbGVuZ3RoKCRuYW1lKSAtIDIpOworCX0KKworCW15ICRmbXRfZW1haWwgPSBmb3JtYXRfZW1h
aWwoJG5hbWUsICRhZGRyZXNzLCAkZW1haWxfdXNlbmFtZSk7CisJcHVzaChAZm10X2VtYWlscywg
JGZtdF9lbWFpbCk7CisgICAgfQorICAgIHJldHVybiBAZm10X2VtYWlsczsKK30KKworc3ViIG1l
cmdlX2VtYWlsIHsKKyAgICBteSBAbGluZXM7CisgICAgbXkgJXNhdzsKKworICAgIGZvciAoQF8p
IHsKKwlteSAoJGFkZHJlc3MsICRyb2xlKSA9IEAkXzsKKwlpZiAoISRzYXd7JGFkZHJlc3N9KSB7
CisJICAgIGlmICgkb3V0cHV0X3JvbGVzKSB7CisJCXB1c2goQGxpbmVzLCAiJGFkZHJlc3MgKCRy
b2xlKSIpOworCSAgICB9IGVsc2UgeworCQlwdXNoKEBsaW5lcywgJGFkZHJlc3MpOworCSAgICB9
CisJICAgICRzYXd7JGFkZHJlc3N9ID0gMTsKKwl9CisgICAgfQorCisgICAgcmV0dXJuIEBsaW5l
czsKK30KKworc3ViIG91dHB1dCB7CisgICAgbXkgKEBwYXJtcykgPSBAXzsKKworICAgIGlmICgk
b3V0cHV0X211bHRpbGluZSkgeworCWZvcmVhY2ggbXkgJGxpbmUgKEBwYXJtcykgeworCSAgICBw
cmludCgiJHtsaW5lfVxuIik7CisJfQorICAgIH0gZWxzZSB7CisJcHJpbnQoam9pbigkb3V0cHV0
X3NlcGFyYXRvciwgQHBhcm1zKSk7CisJcHJpbnQoIlxuIik7CisgICAgfQorfQorCitteSAkcmZj
ODIycmU7CisKK3N1YiBtYWtlX3JmYzgyMnJlIHsKKyMgICBCYXNpYyBsZXhpY2FsIHRva2VucyBh
cmUgc3BlY2lhbHMsIGRvbWFpbl9saXRlcmFsLCBxdW90ZWRfc3RyaW5nLCBhdG9tLCBhbmQKKyMg
ICBjb21tZW50LiAgV2UgbXVzdCBhbGxvdyBmb3IgcmZjODIyX2x3c3AgKG9yIGNvbW1lbnRzKSBh
ZnRlciBlYWNoIG9mIHRoZXNlLgorIyAgIFRoaXMgcmVnZXhwIHdpbGwgb25seSB3b3JrIG9uIGFk
ZHJlc3NlcyB3aGljaCBoYXZlIGhhZCBjb21tZW50cyBzdHJpcHBlZAorIyAgIGFuZCByZXBsYWNl
ZCB3aXRoIHJmYzgyMl9sd3NwLgorCisgICAgbXkgJHNwZWNpYWxzID0gJygpPD5ALDs6XFxcXCIu
XFxbXFxdJzsKKyAgICBteSAkY29udHJvbHMgPSAnXFwwMDAtXFwwMzdcXDE3Nyc7CisKKyAgICBt
eSAkZHRleHQgPSAiW15cXFtcXF1cXHJcXFxcXSI7CisgICAgbXkgJGRvbWFpbl9saXRlcmFsID0g
IlxcWyg/OiRkdGV4dHxcXFxcLikqXFxdJHJmYzgyMl9sd3NwKiI7CisKKyAgICBteSAkcXVvdGVk
X3N0cmluZyA9ICJcIig/OlteXFxcIlxcclxcXFxdfFxcXFwufCRyZmM4MjJfbHdzcCkqXCIkcmZj
ODIyX2x3c3AqIjsKKworIyAgIFVzZSB6ZXJvLXdpZHRoIGFzc2VydGlvbiB0byBzcG90IHRoZSBs
aW1pdCBvZiBhbiBhdG9tLiAgQSBzaW1wbGUKKyMgICAkcmZjODIyX2x3c3AqIGNhdXNlcyB0aGUg
cmVnZXhwIGVuZ2luZSB0byBoYW5nIG9jY2FzaW9uYWxseS4KKyAgICBteSAkYXRvbSA9ICJbXiRz
cGVjaWFscyAkY29udHJvbHNdKyg/OiRyZmM4MjJfbHdzcCt8XFxafCg/PVtcXFtcIiRzcGVjaWFs
c10pKSI7CisgICAgbXkgJHdvcmQgPSAiKD86JGF0b218JHF1b3RlZF9zdHJpbmcpIjsKKyAgICBt
eSAkbG9jYWxwYXJ0ID0gIiR3b3JkKD86XFwuJHJmYzgyMl9sd3NwKiR3b3JkKSoiOworCisgICAg
bXkgJHN1Yl9kb21haW4gPSAiKD86JGF0b218JGRvbWFpbl9saXRlcmFsKSI7CisgICAgbXkgJGRv
bWFpbiA9ICIkc3ViX2RvbWFpbig/OlxcLiRyZmM4MjJfbHdzcCokc3ViX2RvbWFpbikqIjsKKwor
ICAgIG15ICRhZGRyX3NwZWMgPSAiJGxvY2FscGFydFxAJHJmYzgyMl9sd3NwKiRkb21haW4iOwor
CisgICAgbXkgJHBocmFzZSA9ICIkd29yZCoiOworICAgIG15ICRyb3V0ZSA9ICIoPzpcQCRkb21h
aW4oPzosXEAkcmZjODIyX2x3c3AqJGRvbWFpbikqOiRyZmM4MjJfbHdzcCopIjsKKyAgICBteSAk
cm91dGVfYWRkciA9ICJcXDwkcmZjODIyX2x3c3AqJHJvdXRlPyRhZGRyX3NwZWNcXD4kcmZjODIy
X2x3c3AqIjsKKyAgICBteSAkbWFpbGJveCA9ICIoPzokYWRkcl9zcGVjfCRwaHJhc2Ukcm91dGVf
YWRkcikiOworCisgICAgbXkgJGdyb3VwID0gIiRwaHJhc2U6JHJmYzgyMl9sd3NwKig/OiRtYWls
Ym94KD86LFxccyokbWFpbGJveCkqKT87XFxzKiI7CisgICAgbXkgJGFkZHJlc3MgPSAiKD86JG1h
aWxib3h8JGdyb3VwKSI7CisKKyAgICByZXR1cm4gIiRyZmM4MjJfbHdzcCokYWRkcmVzcyI7Cit9
CisKK3N1YiByZmM4MjJfc3RyaXBfY29tbWVudHMgeworICAgIG15ICRzID0gc2hpZnQ7CisjICAg
UmVjdXJzaXZlbHkgcmVtb3ZlIGNvbW1lbnRzLCBhbmQgcmVwbGFjZSB3aXRoIGEgc2luZ2xlIHNw
YWNlLiAgVGhlIHNpbXBsZXIKKyMgICByZWdleHBzIGluIHRoZSBFbWFpbCBBZGRyZXNzaW5nIEZB
USBhcmUgaW1wZXJmZWN0IC0gdGhleSB3aWxsIG1pc3MgZXNjYXBlZAorIyAgIGNoYXJzIGluIGF0
b21zLCBmb3IgZXhhbXBsZS4KKworICAgIHdoaWxlICgkcyA9fiBzL14oKD86W14iXFxdfFxcLikq
CisgICAgICAgICAgICAgICAgICAgICg/OiIoPzpbXiJcXF18XFwuKSoiKD86W14iXFxdfFxcLikq
KSopCisgICAgICAgICAgICAgICAgICAgIFwoKD86W14oKVxcXXxcXC4pKlwpLyQxIC9vc3gpIHt9
CisgICAgcmV0dXJuICRzOworfQorCisjICAgdmFsaWQ6IHJldHVybnMgdHJ1ZSBpZiB0aGUgcGFy
YW1ldGVyIGlzIGFuIFJGQzgyMiB2YWxpZCBhZGRyZXNzCisjCitzdWIgcmZjODIyX3ZhbGlkIHsK
KyAgICBteSAkcyA9IHJmYzgyMl9zdHJpcF9jb21tZW50cyhzaGlmdCk7CisKKyAgICBpZiAoISRy
ZmM4MjJyZSkgeworICAgICAgICAkcmZjODIycmUgPSBtYWtlX3JmYzgyMnJlKCk7CisgICAgfQor
CisgICAgcmV0dXJuICRzID1+IG0vXiRyZmM4MjJyZSQvc28gJiYgJHMgPX4gbS9eJHJmYzgyMl9j
aGFyKiQvOworfQorCisjICAgdmFsaWRsaXN0OiBJbiBzY2FsYXIgY29udGV4dCwgcmV0dXJucyB0
cnVlIGlmIHRoZSBwYXJhbWV0ZXIgaXMgYW4gUkZDODIyCisjICAgICAgICAgICAgICB2YWxpZCBs
aXN0IG9mIGFkZHJlc3Nlcy4KKyMKKyMgICAgICAgICAgICAgIEluIGxpc3QgY29udGV4dCwgcmV0
dXJucyBhbiBlbXB0eSBsaXN0IG9uIGZhaWx1cmUgKGFuIGludmFsaWQKKyMgICAgICAgICAgICAg
IGFkZHJlc3Mgd2FzIGZvdW5kKTsgb3RoZXJ3aXNlIGEgbGlzdCB3aG9zZSBmaXJzdCBlbGVtZW50
IGlzIHRoZQorIyAgICAgICAgICAgICAgbnVtYmVyIG9mIGFkZHJlc3NlcyBmb3VuZCBhbmQgd2hv
c2UgcmVtYWluaW5nIGVsZW1lbnRzIGFyZSB0aGUKKyMgICAgICAgICAgICAgIGFkZHJlc3Nlcy4g
IFRoaXMgaXMgbmVlZGVkIHRvIGRpc2FtYmlndWF0ZSBmYWlsdXJlIChpbnZhbGlkKQorIyAgICAg
ICAgICAgICAgZnJvbSBzdWNjZXNzIHdpdGggbm8gYWRkcmVzc2VzIGZvdW5kLCBiZWNhdXNlIGFu
IGVtcHR5IHN0cmluZyBpcworIyAgICAgICAgICAgICAgYSB2YWxpZCBsaXN0LgorCitzdWIgcmZj
ODIyX3ZhbGlkbGlzdCB7CisgICAgbXkgJHMgPSByZmM4MjJfc3RyaXBfY29tbWVudHMoc2hpZnQp
OworCisgICAgaWYgKCEkcmZjODIycmUpIHsKKyAgICAgICAgJHJmYzgyMnJlID0gbWFrZV9yZmM4
MjJyZSgpOworICAgIH0KKyAgICAjICogbnVsbCBsaXN0IGl0ZW1zIGFyZSB2YWxpZCBhY2NvcmRp
bmcgdG8gdGhlIFJGQworICAgICMgKiB0aGUgJzEnIGJ1c2luZXNzIGlzIHRvIGFpZCBpbiBkaXN0
aW5ndWlzaGluZyBmYWlsdXJlIGZyb20gbm8gcmVzdWx0cworCisgICAgbXkgQHI7CisgICAgaWYg
KCRzID1+IG0vXig/OiRyZmM4MjJyZSk/KD86LCg/OiRyZmM4MjJyZSk/KSokL3NvICYmCisJJHMg
PX4gbS9eJHJmYzgyMl9jaGFyKiQvKSB7CisgICAgICAgIHdoaWxlICgkcyA9fiBtLyg/Ol58LCRy
ZmM4MjJfbHdzcCopKCRyZmM4MjJyZSkvZ29zKSB7CisgICAgICAgICAgICBwdXNoKEByLCAkMSk7
CisgICAgICAgIH0KKyAgICAgICAgcmV0dXJuIHdhbnRhcnJheSA/IChzY2FsYXIoQHIpLCBAcikg
OiAxOworICAgIH0KKyAgICByZXR1cm4gd2FudGFycmF5ID8gKCkgOiAwOworfQotLSAKMi4yOC4w
LjM5NC5nZTE5NzEzNjM4OQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdt
YkgKS3JhdXNlbnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0
aWFuIFNjaGxhZWdlciwgSm9uYXRoYW4gV2Vpc3MKRWluZ2V0cmFnZW4gYW0gQW10c2dlcmljaHQg
Q2hhcmxvdHRlbmJ1cmcgdW50ZXIgSFJCIDE0OTE3MyBCClNpdHo6IEJlcmxpbgpVc3QtSUQ6IERF
IDI4OSAyMzcgODc5CgoK

