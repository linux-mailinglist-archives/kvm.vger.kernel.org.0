Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 8AC63199756
	for <lists+kvm@lfdr.de>; Tue, 31 Mar 2020 15:22:17 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1730856AbgCaNWN (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Tue, 31 Mar 2020 09:22:13 -0400
Received: from mga03.intel.com ([134.134.136.65]:18367 "EHLO mga03.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1730358AbgCaNWM (ORCPT <rfc822;kvm@vger.kernel.org>);
        Tue, 31 Mar 2020 09:22:12 -0400
IronPort-SDR: 0EmT8GW6Y14/Cr2rcPvjtLt1P+nqQxSR4GMiO62odit97zNQ2t9jK383yHuc9T5t8xiUUJu5B0
 JwPQ3kbDyyvg==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
  by orsmga103.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384; 31 Mar 2020 06:22:10 -0700
IronPort-SDR: PfzoMPliTOZUDWIt8lcXwVdoivjgEHvBDhM6mdnv2aih1BrUxls0K8JpHu5EBRBFFa0lteoVtK
 2GOMDDlhQDyw==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.72,327,1580803200"; 
   d="scan'208";a="252240646"
Received: from fmsmsx103.amr.corp.intel.com ([10.18.124.201])
  by orsmga006.jf.intel.com with ESMTP; 31 Mar 2020 06:22:10 -0700
Received: from shsmsx154.ccr.corp.intel.com (10.239.6.54) by
 FMSMSX103.amr.corp.intel.com (10.18.124.201) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Tue, 31 Mar 2020 06:22:09 -0700
Received: from shsmsx104.ccr.corp.intel.com ([169.254.5.225]) by
 SHSMSX154.ccr.corp.intel.com ([169.254.7.217]) with mapi id 14.03.0439.000;
 Tue, 31 Mar 2020 21:22:03 +0800
From:   "Liu, Yi L" <yi.l.liu@intel.com>
To:     "Tian, Kevin" <kevin.tian@intel.com>,
        "alex.williamson@redhat.com" <alex.williamson@redhat.com>,
        "eric.auger@redhat.com" <eric.auger@redhat.com>
CC:     "jacob.jun.pan@linux.intel.com" <jacob.jun.pan@linux.intel.com>,
        "joro@8bytes.org" <joro@8bytes.org>,
        "Raj, Ashok" <ashok.raj@intel.com>,
        "Tian, Jun J" <jun.j.tian@intel.com>,
        "Sun, Yi Y" <yi.y.sun@intel.com>,
        "jean-philippe@linaro.org" <jean-philippe@linaro.org>,
        "peterx@redhat.com" <peterx@redhat.com>,
        "iommu@lists.linux-foundation.org" <iommu@lists.linux-foundation.org>,
        "kvm@vger.kernel.org" <kvm@vger.kernel.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "Wu, Hao" <hao.wu@intel.com>
Subject: RE: [PATCH v1 1/8] vfio: Add VFIO_IOMMU_PASID_REQUEST(alloc/free)
Thread-Topic: [PATCH v1 1/8] vfio: Add VFIO_IOMMU_PASID_REQUEST(alloc/free)
Thread-Index: AQHWAEUbC4GB74LMekup8jIcF6WIFqhgVMYAgACL5QCAANaCgIAAmyhQ
Date:   Tue, 31 Mar 2020 13:22:03 +0000
Message-ID: <A2975661238FB949B60364EF0F2C25743A21B065@SHSMSX104.ccr.corp.intel.com>
References: <1584880325-10561-1-git-send-email-yi.l.liu@intel.com>
 <1584880325-10561-2-git-send-email-yi.l.liu@intel.com>
 <AADFC41AFE54684AB9EE6CBC0274A5D19D7FF378@SHSMSX104.ccr.corp.intel.com>
 <A2975661238FB949B60364EF0F2C25743A2184AE@SHSMSX104.ccr.corp.intel.com>
 <AADFC41AFE54684AB9EE6CBC0274A5D19D801104@SHSMSX104.ccr.corp.intel.com>
In-Reply-To: <AADFC41AFE54684AB9EE6CBC0274A5D19D801104@SHSMSX104.ccr.corp.intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
dlp-product: dlpe-windows
dlp-version: 11.2.0.6
dlp-reaction: no-action
x-originating-ip: [10.239.127.40]
Content-Type: multipart/mixed;
        boundary="_002_A2975661238FB949B60364EF0F2C25743A21B065SHSMSX104ccrcor_"
MIME-Version: 1.0
Sender: kvm-owner@vger.kernel.org
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

--_002_A2975661238FB949B60364EF0F2C25743A21B065SHSMSX104ccrcor_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

PiBGcm9tOiBUaWFuLCBLZXZpbiA8a2V2aW4udGlhbkBpbnRlbC5jb20+DQo+IFNlbnQ6IFR1ZXNk
YXksIE1hcmNoIDMxLCAyMDIwIDE6NDEgUE0NCj4gVG86IExpdSwgWWkgTCA8eWkubC5saXVAaW50
ZWwuY29tPjsgYWxleC53aWxsaWFtc29uQHJlZGhhdC5jb207DQo+IGVyaWMuYXVnZXJAcmVkaGF0
LmNvbQ0KPiBTdWJqZWN0OiBSRTogW1BBVENIIHYxIDEvOF0gdmZpbzogQWRkIFZGSU9fSU9NTVVf
UEFTSURfUkVRVUVTVChhbGxvYy9mcmVlKQ0KPiANCj4gPiBGcm9tOiBMaXUsIFlpIEwgPHlpLmwu
bGl1QGludGVsLmNvbT4NCj4gPiBTZW50OiBNb25kYXksIE1hcmNoIDMwLCAyMDIwIDEwOjM3IFBN
DQo+ID4NCj4gPiA+IEZyb206IFRpYW4sIEtldmluIDxrZXZpbi50aWFuQGludGVsLmNvbT4NCj4g
PiA+IFNlbnQ6IE1vbmRheSwgTWFyY2ggMzAsIDIwMjAgNDozMiBQTQ0KPiA+ID4gVG86IExpdSwg
WWkgTCA8eWkubC5saXVAaW50ZWwuY29tPjsgYWxleC53aWxsaWFtc29uQHJlZGhhdC5jb207DQo+
ID4gPiBTdWJqZWN0OiBSRTogW1BBVENIIHYxIDEvOF0gdmZpbzogQWRkDQo+ID4gVkZJT19JT01N
VV9QQVNJRF9SRVFVRVNUKGFsbG9jL2ZyZWUpDQo+ID4gPg0KPiA+ID4gPiBGcm9tOiBMaXUsIFlp
IEwgPHlpLmwubGl1QGludGVsLmNvbT4NCj4gPiA+ID4gU2VudDogU3VuZGF5LCBNYXJjaCAyMiwg
MjAyMCA4OjMyIFBNDQo+ID4gPiA+DQo+ID4gPiA+IEZyb206IExpdSBZaSBMIDx5aS5sLmxpdUBp
bnRlbC5jb20+DQo+ID4gPiA+DQo+ID4gPiA+IEZvciBhIGxvbmcgdGltZSwgZGV2aWNlcyBoYXZl
IG9ubHkgb25lIERNQSBhZGRyZXNzIHNwYWNlIGZyb20NCj4gPiA+ID4gcGxhdGZvcm0gSU9NTVUn
cyBwb2ludCBvZiB2aWV3LiBUaGlzIGlzIHRydWUgZm9yIGJvdGggYmFyZSBtZXRhbA0KPiA+ID4g
PiBhbmQgZGlyZWN0ZWQtIGFjY2VzcyBpbiB2aXJ0dWFsaXphdGlvbiBlbnZpcm9ubWVudC4gUmVh
c29uIGlzIHRoZQ0KPiA+ID4gPiBzb3VyY2UgSUQgb2YgRE1BIGluIFBDSWUgYXJlIEJERiAoYnVz
L2Rldi9mbmMgSUQpLCB3aGljaCByZXN1bHRzDQo+ID4gPiA+IGluIG9ubHkgZGV2aWNlIGdyYW51
bGFyaXR5DQo+ID4gPg0KPiA+ID4gYXJlLT5pcw0KPiA+DQo+ID4gdGhhbmtzLg0KPiA+DQo+ID4g
PiA+IERNQSBpc29sYXRpb24uIEhvd2V2ZXIsIHRoaXMgaXMgY2hhbmdpbmcgd2l0aCB0aGUgbGF0
ZXN0DQo+ID4gPiA+IGFkdmFuY2VtZW50IGluIEkvTyB0ZWNobm9sb2d5IGFyZWEuIE1vcmUgYW5k
IG1vcmUgcGxhdGZvcm0gdmVuZG9ycw0KPiA+ID4gPiBhcmUgdXRpbGl6aW5nIHRoZQ0KPiA+IFBD
SWUNCj4gPiA+ID4gUEFTSUQgVExQIHByZWZpeCBpbiBETUEgcmVxdWVzdHMsIHRodXMgdG8gZ2l2
ZSBkZXZpY2VzIHdpdGgNCj4gPiA+ID4gbXVsdGlwbGUgRE1BIGFkZHJlc3Mgc3BhY2VzIGFzIGlk
ZW50aWZpZWQgYnkgdGhlaXIgaW5kaXZpZHVhbA0KPiA+ID4gPiBQQVNJRHMuIEZvciBleGFtcGxl
LCBTaGFyZWQgVmlydHVhbCBBZGRyZXNzaW5nIChTVkEsIGEuay5hIFNoYXJlZA0KPiA+ID4gPiBW
aXJ0dWFsIE1lbW9yeSkgaXMgYWJsZSB0byBsZXQgZGV2aWNlIGFjY2VzcyBtdWx0aXBsZSBwcm9j
ZXNzDQo+ID4gPiA+IHZpcnR1YWwgYWRkcmVzcyBzcGFjZSBieSBiaW5kaW5nIHRoZQ0KPiA+ID4N
Cj4gPiA+ICJhZGRyZXNzIHNwYWNlIiAtPiAiYWRkcmVzcyBzcGFjZXMiDQo+ID4gPg0KPiA+ID4g
ImJpbmRpbmcgdGhlIiAtPiAiYmluZGluZyBlYWNoIg0KPiA+DQo+ID4gd2lsbCBjb3JyZWN0IGJv
dGguDQo+ID4NCj4gPiA+ID4gdmlydHVhbCBhZGRyZXNzIHNwYWNlIHdpdGggYSBQQVNJRC4gV2hl
cmVpbiB0aGUgUEFTSUQgaXMgYWxsb2NhdGVkDQo+ID4gPiA+IGluIHNvZnR3YXJlIGFuZCBwcm9n
cmFtbWVkIHRvIGRldmljZSBwZXIgZGV2aWNlIHNwZWNpZmljIG1hbm5lci4NCj4gPiA+ID4gRGV2
aWNlcyB3aGljaCBzdXBwb3J0IFBBU0lEIGNhcGFiaWxpdHkgYXJlIGNhbGxlZCBQQVNJRC1jYXBh
YmxlDQo+ID4gPiA+IGRldmljZXMuIElmIHN1Y2ggZGV2aWNlcyBhcmUgcGFzc2VkIHRocm91Z2gg
dG8gVk1zLCBndWVzdCBzb2Z0d2FyZQ0KPiA+ID4gPiBhcmUgYWxzbyBhYmxlIHRvIGJpbmQgZ3Vl
c3QgcHJvY2VzcyB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2Ugb24gc3VjaA0KPiA+ID4gPiBkZXZpY2Vz
LiBUaGVyZWZvcmUsIHRoZSBndWVzdCBzb2Z0d2FyZSBjb3VsZCByZXVzZSB0aGUgYmFyZSBtZXRh
bA0KPiA+ID4gPiBzb2Z0d2FyZSBwcm9ncmFtbWluZyBtb2RlbCwNCj4gPiB3aGljaA0KPiA+ID4g
PiBtZWFucyBndWVzdCBzb2Z0d2FyZSB3aWxsIGFsc28gYWxsb2NhdGUgUEFTSUQgYW5kIHByb2dy
YW0gaXQgdG8NCj4gPiA+ID4gZGV2aWNlIGRpcmVjdGx5LiBUaGlzIGlzIGEgZGFuZ2Vyb3VzIHNp
dHVhdGlvbiBzaW5jZSBpdCBoYXMNCj4gPiA+ID4gcG90ZW50aWFsIFBBU0lEIGNvbmZsaWN0cyBh
bmQgdW5hdXRob3JpemVkIGFkZHJlc3Mgc3BhY2UgYWNjZXNzLg0KPiA+ID4gPiBJdCB3b3VsZCBi
ZSBzYWZlciB0byBsZXQgaG9zdCBpbnRlcmNlcHQgaW4gdGhlIGd1ZXN0IHNvZnR3YXJlJ3MNCj4g
PiA+ID4gUEFTSUQgYWxsb2NhdGlvbi4gVGh1cyBQQVNJRCBhcmUgbWFuYWdlZCBzeXN0ZW0td2lk
ZS4NCj4gPiA+ID4NCj4gPiA+ID4gVGhpcyBwYXRjaCBhZGRzIFZGSU9fSU9NTVVfUEFTSURfUkVR
VUVTVCBpb2N0bCB3aGljaCBhaW1zIHRvDQo+ID4gPiA+IHBhc3Nkb3duIFBBU0lEIGFsbG9jYXRp
b24vZnJlZSByZXF1ZXN0IGZyb20gdGhlIHZpcnR1YWwgSU9NTVUuDQo+ID4gPiA+IEFkZGl0aW9u
YWxseSwgc3VjaA0KPiA+ID4NCj4gPiA+ICJBZGRpdGlvbmFsbHksIGJlY2F1c2Ugc3VjaCINCj4g
PiA+DQo+ID4gPiA+IHJlcXVlc3RzIGFyZSBpbnRlbmRlZCB0byBiZSBpbnZva2VkIGJ5IFFFTVUg
b3Igb3RoZXIgYXBwbGljYXRpb25zDQo+ID4gd2hpY2gNCj4gPiA+DQo+ID4gPiBzaW1wbGlmeSB0
byAiaW50ZW5kZWQgdG8gYmUgaW52b2tlZCBmcm9tIHVzZXJzcGFjZSINCj4gPg0KPiA+IGdvdCBp
dC4NCj4gPg0KPiA+ID4gPiBhcmUgcnVubmluZyBpbiB1c2Vyc3BhY2UsIGl0IGlzIG5lY2Vzc2Fy
eSB0byBoYXZlIGEgbWVjaGFuaXNtIHRvDQo+ID4gPiA+IHByZXZlbnQgc2luZ2xlIGFwcGxpY2F0
aW9uIGZyb20gYWJ1c2luZyBhdmFpbGFibGUgUEFTSURzIGluDQo+ID4gPiA+IHN5c3RlbS4gV2l0
aCBzdWNoIGNvbnNpZGVyYXRpb24sIHRoaXMgcGF0Y2ggdHJhY2tzIHRoZSBWRklPIFBBU0lEDQo+
ID4gPiA+IGFsbG9jYXRpb24gcGVyLVZNLiBUaGVyZSB3YXMgYSBkaXNjdXNzaW9uIHRvIG1ha2Ug
cXVvdGEgdG8gYmUgcGVyDQo+ID4gPiA+IGFzc2lnbmVkIGRldmljZXMuIGUuZy4gaWYgYSBWTSBo
YXMgbWFueSBhc3NpZ25lZCBkZXZpY2VzLCB0aGVuIGl0DQo+ID4gPiA+IHNob3VsZCBoYXZlIG1v
cmUgcXVvdGEuIEhvd2V2ZXIsIGl0IGlzIG5vdCBzdXJlIGhvdyBtYW55IFBBU0lEcyBhbg0KPiA+
ID4gPiBhc3NpZ25lZCBkZXZpY2VzIHdpbGwgdXNlLiBlLmcuIGl0IGlzDQo+ID4gPg0KPiA+ID4g
ZGV2aWNlcyAtPiBkZXZpY2UNCj4gPg0KPiA+IGdvdCBpdC4NCj4gPg0KPiA+ID4gPiBwb3NzaWJs
ZSB0aGF0IGEgVk0gd2l0aCBtdWx0aXBsZXMgYXNzaWduZWQgZGV2aWNlcyBidXQgcmVxdWVzdHMN
Cj4gPiA+ID4gbGVzcyBQQVNJRHMuIFRoZXJlZm9yZSBwZXItVk0gcXVvdGEgd291bGQgYmUgYmV0
dGVyLg0KPiA+ID4gPg0KPiA+ID4gPiBUaGlzIHBhdGNoIHVzZXMgc3RydWN0IG1tIHBvaW50ZXIg
YXMgYSBwZXItVk0gdG9rZW4uIFdlIGFsc28NCj4gPiA+ID4gY29uc2lkZXJlZCB1c2luZyB0YXNr
IHN0cnVjdHVyZSBwb2ludGVyIGFuZCB2ZmlvX2lvbW11IHN0cnVjdHVyZQ0KPiA+ID4gPiBwb2lu
dGVyLiBIb3dldmVyLCB0YXNrIHN0cnVjdHVyZSBpcyBwZXItdGhyZWFkLCB3aGljaCBtZWFucyBp
dA0KPiA+ID4gPiBjYW5ub3QgYWNoaWV2ZSBwZXItVk0gUEFTSUQgYWxsb2MgdHJhY2tpbmcgcHVy
cG9zZS4gV2hpbGUgZm9yDQo+ID4gPiA+IHZmaW9faW9tbXUgc3RydWN0dXJlLCBpdCBpcyB2aXNp
YmxlIG9ubHkgd2l0aGluIHZmaW8uIFRoZXJlZm9yZSwNCj4gPiA+ID4gc3RydWN0dXJlIG1tIHBv
aW50ZXIgaXMgc2VsZWN0ZWQuIFRoaXMgcGF0Y2ggYWRkcyBhIHN0cnVjdHVyZQ0KPiA+ID4gPiB2
ZmlvX21tLiBBIHZmaW9fbW0gaXMgY3JlYXRlZCB3aGVuIHRoZSBmaXJzdCB2ZmlvIGNvbnRhaW5l
ciBpcw0KPiA+ID4gPiBvcGVuZWQgYnkgYSBWTS4gT24gdGhlIHJldmVyc2Ugb3JkZXIsIHZmaW9f
bW0gaXMgZnJlZSB3aGVuIHRoZQ0KPiA+ID4gPiBsYXN0IHZmaW8gY29udGFpbmVyIGlzIHJlbGVh
c2VkLiBFYWNoIFZNIGlzIGFzc2lnbmVkIHdpdGggYSBQQVNJRA0KPiA+ID4gPiBxdW90YSwgc28g
dGhhdCBpdCBpcyBub3QgYWJsZSB0byByZXF1ZXN0IFBBU0lEIGJleW9uZCBpdHMgcXVvdGEuDQo+
ID4gPiA+IFRoaXMgcGF0Y2ggYWRkcyBhIGRlZmF1bHQgcXVvdGEgb2YgMTAwMC4gVGhpcyBxdW90
YSBjb3VsZCBiZSB0dW5lZA0KPiA+ID4gPiBieSBhZG1pbmlzdHJhdG9yLiBNYWtpbmcgUEFTSUQg
cXVvdGEgdHVuYWJsZSB3aWxsIGJlIGFkZGVkIGluDQo+ID4gPiA+IGFub3RoZXINCj4gPiBwYXRj
aA0KPiA+ID4gPiBpbiB0aGlzIHNlcmllcy4NCj4gPiA+ID4NCj4gPiA+ID4gUHJldmlvdXMgZGlz
Y3Vzc2lvbnM6DQo+ID4gPiA+IGh0dHBzOi8vcGF0Y2h3b3JrLmtlcm5lbC5vcmcvcGF0Y2gvMTEy
MDk0MjkvDQo+ID4gPiA+DQo+ID4gPiA+IENjOiBLZXZpbiBUaWFuIDxrZXZpbi50aWFuQGludGVs
LmNvbT4NCj4gPiA+ID4gQ0M6IEphY29iIFBhbiA8amFjb2IuanVuLnBhbkBsaW51eC5pbnRlbC5j
b20+DQo+ID4gPiA+IENjOiBBbGV4IFdpbGxpYW1zb24gPGFsZXgud2lsbGlhbXNvbkByZWRoYXQu
Y29tPg0KPiA+ID4gPiBDYzogRXJpYyBBdWdlciA8ZXJpYy5hdWdlckByZWRoYXQuY29tPg0KPiA+
ID4gPiBDYzogSmVhbi1QaGlsaXBwZSBCcnVja2VyIDxqZWFuLXBoaWxpcHBlQGxpbmFyby5vcmc+
DQo+ID4gPiA+IFNpZ25lZC1vZmYtYnk6IExpdSBZaSBMIDx5aS5sLmxpdUBpbnRlbC5jb20+DQo+
ID4gPiA+IFNpZ25lZC1vZmYtYnk6IFlpIFN1biA8eWkueS5zdW5AbGludXguaW50ZWwuY29tPg0K
PiA+ID4gPiBTaWduZWQtb2ZmLWJ5OiBKYWNvYiBQYW4gPGphY29iLmp1bi5wYW5AbGludXguaW50
ZWwuY29tPg0KPiA+ID4gPiAtLS0NCj4gPiA+ID4gIGRyaXZlcnMvdmZpby92ZmlvLmMgICAgICAg
ICAgICAgfCAxMzANCj4gPiA+ID4gKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKw0KPiA+ID4gPiAgZHJpdmVycy92ZmlvL3ZmaW9faW9tbXVfdHlwZTEuYyB8IDEwNA0KPiA+
ID4gPiArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KPiA+ID4gPiAgaW5jbHVkZS9s
aW51eC92ZmlvLmggICAgICAgICAgICB8ICAyMCArKysrKysrDQo+ID4gPiA+ICBpbmNsdWRlL3Vh
cGkvbGludXgvdmZpby5oICAgICAgIHwgIDQxICsrKysrKysrKysrKysNCj4gPiA+ID4gIDQgZmls
ZXMgY2hhbmdlZCwgMjk1IGluc2VydGlvbnMoKykNCj4gPiA+ID4NCj4gPiA+ID4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvdmZpby92ZmlvLmMgYi9kcml2ZXJzL3ZmaW8vdmZpby5jIGluZGV4DQo+ID4g
PiA+IGM4NDgyNjIuLmQxM2I0ODMgMTAwNjQ0DQo+ID4gPiA+IC0tLSBhL2RyaXZlcnMvdmZpby92
ZmlvLmMNCj4gPiA+ID4gKysrIGIvZHJpdmVycy92ZmlvL3ZmaW8uYw0KPiA+ID4gPiBAQCAtMzIs
NiArMzIsNyBAQA0KPiA+ID4gPiAgI2luY2x1ZGUgPGxpbnV4L3ZmaW8uaD4NCj4gPiA+ID4gICNp
bmNsdWRlIDxsaW51eC93YWl0Lmg+DQo+ID4gPiA+ICAjaW5jbHVkZSA8bGludXgvc2NoZWQvc2ln
bmFsLmg+DQo+ID4gPiA+ICsjaW5jbHVkZSA8bGludXgvc2NoZWQvbW0uaD4NCj4gPiA+ID4NCj4g
PiA+ID4gICNkZWZpbmUgRFJJVkVSX1ZFUlNJT04JIjAuMyINCj4gPiA+ID4gICNkZWZpbmUgRFJJ
VkVSX0FVVEhPUgkiQWxleCBXaWxsaWFtc29uDQo+ID4gPiA+IDxhbGV4LndpbGxpYW1zb25AcmVk
aGF0LmNvbT4iDQo+ID4gPiA+IEBAIC00Niw2ICs0Nyw4IEBAIHN0YXRpYyBzdHJ1Y3QgdmZpbyB7
DQo+ID4gPiA+ICAJc3RydWN0IG11dGV4CQkJZ3JvdXBfbG9jazsNCj4gPiA+ID4gIAlzdHJ1Y3Qg
Y2RldgkJCWdyb3VwX2NkZXY7DQo+ID4gPiA+ICAJZGV2X3QJCQkJZ3JvdXBfZGV2dDsNCj4gPiA+
ID4gKwlzdHJ1Y3QgbGlzdF9oZWFkCQl2ZmlvX21tX2xpc3Q7DQo+ID4gPiA+ICsJc3RydWN0IG11
dGV4CQkJdmZpb19tbV9sb2NrOw0KPiA+ID4gPiAgCXdhaXRfcXVldWVfaGVhZF90CQlyZWxlYXNl
X3E7DQo+ID4gPiA+ICB9IHZmaW87DQo+ID4gPiA+DQo+ID4gPiA+IEBAIC0yMTI5LDYgKzIxMzIs
MTMxIEBAIGludCB2ZmlvX3VucmVnaXN0ZXJfbm90aWZpZXIoc3RydWN0IGRldmljZQ0KPiA+ICpk
ZXYsDQo+ID4gPiA+IGVudW0gdmZpb19ub3RpZnlfdHlwZSB0eXBlLA0KPiA+ID4gPiAgRVhQT1JU
X1NZTUJPTCh2ZmlvX3VucmVnaXN0ZXJfbm90aWZpZXIpOw0KPiA+ID4gPg0KPiA+ID4gPiAgLyoq
DQo+ID4gPiA+ICsgKiBWRklPX01NIG9iamVjdHMgLSBjcmVhdGUsIHJlbGVhc2UsIGdldCwgcHV0
LCBzZWFyY2gNCj4gPiA+DQo+ID4gPiB3aHkgY2FwaXRhbGl6aW5nIHZmaW9fbW0/DQo+ID4NCj4g
PiBvb3BzLCBpdCdzIG5vdCBpbnRlbmRlZCwgd2lsbCBmaXggaXQuDQo+ID4NCj4gPiA+ID4gKyAq
IENhbGxlciBvZiB0aGUgZnVuY3Rpb24gc2hvdWxkIGhhdmUgaGVsZCB2ZmlvLnZmaW9fbW1fbG9j
ay4NCj4gPiA+ID4gKyAqLw0KPiA+ID4gPiArc3RhdGljIHN0cnVjdCB2ZmlvX21tICp2ZmlvX2Ny
ZWF0ZV9tbShzdHJ1Y3QgbW1fc3RydWN0ICptbSkgew0KPiA+ID4gPiArCXN0cnVjdCB2ZmlvX21t
ICp2bW07DQo+ID4gPiA+ICsJc3RydWN0IHZmaW9fbW1fdG9rZW4gKnRva2VuOw0KPiA+ID4gPiAr
CWludCByZXQgPSAwOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJdm1tID0ga3phbGxvYyhzaXplb2Yo
KnZtbSksIEdGUF9LRVJORUwpOw0KPiA+ID4gPiArCWlmICghdm1tKQ0KPiA+ID4gPiArCQlyZXR1
cm4gRVJSX1BUUigtRU5PTUVNKTsNCj4gPiA+ID4gKw0KPiA+ID4gPiArCS8qIFBlciBtbSBJT0FT
SUQgc2V0IHVzZWQgZm9yIHF1b3RhIGNvbnRyb2wgYW5kIGdyb3VwIG9wZXJhdGlvbnMNCj4gPiA+
ID4gKi8NCj4gPiA+ID4gKwlyZXQgPSBpb2FzaWRfYWxsb2Nfc2V0KChzdHJ1Y3QgaW9hc2lkX3Nl
dCAqKSBtbSwNCj4gPiA+ID4gKwkJCSAgICAgICBWRklPX0RFRkFVTFRfUEFTSURfUVVPVEEsICZ2
bW0tDQo+ID4gPiA+ID5pb2FzaWRfc2lkKTsNCj4gPiA+ID4gKwlpZiAocmV0KSB7DQo+ID4gPiA+
ICsJCWtmcmVlKHZtbSk7DQo+ID4gPiA+ICsJCXJldHVybiBFUlJfUFRSKHJldCk7DQo+ID4gPiA+
ICsJfQ0KPiA+ID4gPiArDQo+ID4gPiA+ICsJa3JlZl9pbml0KCZ2bW0tPmtyZWYpOw0KPiA+ID4g
PiArCXRva2VuID0gJnZtbS0+dG9rZW47DQo+ID4gPiA+ICsJdG9rZW4tPnZhbCA9IG1tOw0KPiA+
ID4gPiArCXZtbS0+cGFzaWRfcXVvdGEgPSBWRklPX0RFRkFVTFRfUEFTSURfUVVPVEE7DQo+ID4g
PiA+ICsJbXV0ZXhfaW5pdCgmdm1tLT5wYXNpZF9sb2NrKTsNCj4gPiA+ID4gKw0KPiA+ID4gPiAr
CWxpc3RfYWRkKCZ2bW0tPnZmaW9fbmV4dCwgJnZmaW8udmZpb19tbV9saXN0KTsNCj4gPiA+ID4g
Kw0KPiA+ID4gPiArCXJldHVybiB2bW07DQo+ID4gPiA+ICt9DQo+ID4gPiA+ICsNCj4gPiA+ID4g
K3N0YXRpYyB2b2lkIHZmaW9fbW1fdW5sb2NrX2FuZF9mcmVlKHN0cnVjdCB2ZmlvX21tICp2bW0p
IHsNCj4gPiA+ID4gKwkvKiBkZXN0cm95IHRoZSBpb2FzaWQgc2V0ICovDQo+ID4gPiA+ICsJaW9h
c2lkX2ZyZWVfc2V0KHZtbS0+aW9hc2lkX3NpZCwgdHJ1ZSk7DQo+ID4gPg0KPiA+ID4gZG8gd2Ug
bmVlZCBob2xkIHBhc2lkIGxvY2sgaGVyZSwgc2luY2UgaXQgYXR0ZW1wdHMgdG8gZGVzdHJveSBh
IHNldA0KPiA+ID4gd2hpY2ggbWlnaHQgYmUgcmVmZXJlbmNlZCBieSB2ZmlvX21tX3Bhc2lkX2Zy
ZWU/IG9yIGlzIHRoZXJlDQo+ID4gPiBndWFyYW50ZWUgdGhhdCBzdWNoIHJhY2Ugd29uJ3QgaGFw
cGVuPw0KPiA+DQo+ID4gRW1tbSwgaWYgY29uc2lkZXJpbmcgdGhlIHJhY2UgYmV0d2VlbiBpb2Fz
aWRfZnJlZV9zZXQgYW5kDQo+ID4gdmZpb19tbV9wYXNpZF9mcmVlLCBJIGd1ZXNzIGlvYXNpZCBj
b3JlIHNob3VsZCBzZXF1ZW5jZSB0aGUgdHdvDQo+ID4gb3BlcmF0aW9ucyB3aXRoIGl0cyBpbnRl
cm5hbCBsb2NrLiByaWdodD8NCj4gDQo+IEkgbG9va2VkIGF0IGJlbG93IGNvZGUgaW4gZnJlZSBw
YXRoOg0KPiANCj4gKwltdXRleF9sb2NrKCZ2bW0tPnBhc2lkX2xvY2spOw0KPiArCXBkYXRhID0g
aW9hc2lkX2ZpbmQodm1tLT5pb2FzaWRfc2lkLCBwYXNpZCwgTlVMTCk7DQo+ICsJaWYgKElTX0VS
UihwZGF0YSkpIHsNCj4gKwkJcmV0ID0gUFRSX0VSUihwZGF0YSk7DQo+ICsJCWdvdG8gb3V0X3Vu
bG9jazsNCj4gKwl9DQo+ICsJaW9hc2lkX2ZyZWUocGFzaWQpOw0KPiArDQo+ICtvdXRfdW5sb2Nr
Og0KPiArCW11dGV4X3VubG9jaygmdm1tLT5wYXNpZF9sb2NrKTsNCj4gDQo+IGFib3ZlIGltcGxp
ZXMgdGhhdCBpb2FzaWRfZmluZC9mcmVlIG11c3QgYmUgcGFpcmVkIHdpdGhpbiB0aGUgcGFzaWRf
bG9jay4NCj4gVGhlbiBpZiB3ZSBkb24ndCBob2xkIHBhc2lkX2xvY2sgYWJvdmUsIGlvYXNpZF9m
cmVlX3NldCBjb3VsZCBoYXBwZW4gYmV0d2Vlbg0KPiBmaW5kL2ZyZWUuIEknbSBub3Qgc3VyZSB3
aGV0aGVyIHRoaXMgcmFjZSB3b3VsZCBsZWFkIHRvIHJlYWwgcHJvYmxlbSwgYnV0IGl0IGRvZXNu
J3QNCj4gbG9vayBjb3JyZWN0IHNpbXBseSBieSBsb29raW5nIGF0IHRoaXMgZmlsZS4NCg0KV2Vs
bCwgSmFjb2IgdG9sZCBtZSB0byByZW1vdmUgdGhlIGlvYXNpZF9maW5kIGluIGFub3RoZXIgZW1h
aWwgYXMgaGUNCmJlbGlldmVzIGlvYXNpZCBjb3JlIHNob3VsZCBiZSBhYmxlIHRvIHRha2UgY2Fy
ZSBvZiBpdC4gYW5kIGFsc28gbmVlZCB0bw0KYmUgcHJvdGVjdGVkIGJ5IGxvY2suIElmIHNvLCBk
b2VzIGl0IGxvb2sgZ29vZD8gOi0pDQoNCiAiIFtKYWNvYiBQYW5dIHRoaXMgbWlnaHQgYmUgYmV0
dGVyIHRvIHB1dCB1bmRlciBpb2FzaWQgY29kZSBzdWNoIHRoYXQgaXQgDQogIGlzIHVuZGVyIHRo
ZSBpb2FzaWQgbG9jay4gbm8gb25lIGVsc2UgY2FuIGZyZWUgdGhlIGlvYXNpZCBiZXR3ZWVuIGZp
bmQoKSBhbmQgZnJlZSgpLg0KICBlLmcuIGlvYXNpZF9mcmVlKHNpZCwgcGFzaWQpDQogIGlmIHNp
ZCA9PSBJTlZBTElEX0lPQVNJRF9TRVQsIHRoZW4gbm8gc2V0IG93bmVyc2hpcCBjaGVja2luZy4N
CiAgdGhvdWdodHM/Ig0KDQo+ID4NCj4gPiA+ID4gKwltdXRleF91bmxvY2soJnZmaW8udmZpb19t
bV9sb2NrKTsNCj4gPiA+ID4gKwlrZnJlZSh2bW0pOw0KPiA+ID4gPiArfQ0KPiA+ID4gPiArDQo+
ID4gPiA+ICsvKiBjYWxsZWQgd2l0aCB2ZmlvLnZmaW9fbW1fbG9jayBoZWxkICovIHN0YXRpYyB2
b2lkDQo+ID4gPiA+ICt2ZmlvX21tX3JlbGVhc2Uoc3RydWN0IGtyZWYgKmtyZWYpIHsNCj4gPiA+
ID4gKwlzdHJ1Y3QgdmZpb19tbSAqdm1tID0gY29udGFpbmVyX29mKGtyZWYsIHN0cnVjdCB2Zmlv
X21tLCBrcmVmKTsNCj4gPiA+ID4gKw0KPiA+ID4gPiArCWxpc3RfZGVsKCZ2bW0tPnZmaW9fbmV4
dCk7DQo+ID4gPiA+ICsJdmZpb19tbV91bmxvY2tfYW5kX2ZyZWUodm1tKTsNCj4gPiA+ID4gK30N
Cj4gPiA+ID4gKw0KPiA+ID4gPiArdm9pZCB2ZmlvX21tX3B1dChzdHJ1Y3QgdmZpb19tbSAqdm1t
KSB7DQo+ID4gPiA+ICsJa3JlZl9wdXRfbXV0ZXgoJnZtbS0+a3JlZiwgdmZpb19tbV9yZWxlYXNl
LA0KPiA+ID4gPiAmdmZpby52ZmlvX21tX2xvY2spOw0KPiA+ID4gPiArfQ0KPiA+ID4gPiArRVhQ
T1JUX1NZTUJPTF9HUEwodmZpb19tbV9wdXQpOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsvKiBBc3N1
bWUgdmZpb19tbV9sb2NrIG9yIHZmaW9fbW0gcmVmZXJlbmNlIGlzIGhlbGQgKi8gc3RhdGljDQo+
ID4gPiA+ICt2b2lkIHZmaW9fbW1fZ2V0KHN0cnVjdCB2ZmlvX21tICp2bW0pIHsNCj4gPiA+ID4g
KwlrcmVmX2dldCgmdm1tLT5rcmVmKTsNCj4gPiA+ID4gK30NCj4gPiA+ID4gKw0KPiA+ID4gPiAr
c3RydWN0IHZmaW9fbW0gKnZmaW9fbW1fZ2V0X2Zyb21fdGFzayhzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRhc2spIHsNCj4gPiA+ID4gKwlzdHJ1Y3QgbW1fc3RydWN0ICptbSA9IGdldF90YXNrX21tKHRh
c2spOw0KPiA+ID4gPiArCXN0cnVjdCB2ZmlvX21tICp2bW07DQo+ID4gPiA+ICsJdW5zaWduZWQg
bG9uZyBsb25nIHZhbCA9ICh1bnNpZ25lZCBsb25nIGxvbmcpIG1tOw0KPiA+ID4gPiArDQo+ID4g
PiA+ICsJbXV0ZXhfbG9jaygmdmZpby52ZmlvX21tX2xvY2spOw0KPiA+ID4gPiArCWxpc3RfZm9y
X2VhY2hfZW50cnkodm1tLCAmdmZpby52ZmlvX21tX2xpc3QsIHZmaW9fbmV4dCkgew0KPiA+ID4g
PiArCQlpZiAodm1tLT50b2tlbi52YWwgPT0gdmFsKSB7DQo+ID4gPiA+ICsJCQl2ZmlvX21tX2dl
dCh2bW0pOw0KPiA+ID4gPiArCQkJZ290byBvdXQ7DQo+ID4gPiA+ICsJCX0NCj4gPiA+ID4gKwl9
DQo+ID4gPiA+ICsNCj4gPiA+ID4gKwl2bW0gPSB2ZmlvX2NyZWF0ZV9tbShtbSk7DQo+ID4gPiA+
ICsJaWYgKElTX0VSUih2bW0pKQ0KPiA+ID4gPiArCQl2bW0gPSBOVUxMOw0KPiA+ID4gPiArb3V0
Og0KPiA+ID4gPiArCW11dGV4X3VubG9jaygmdmZpby52ZmlvX21tX2xvY2spOw0KPiA+ID4gPiAr
CW1tcHV0KG1tKTsNCj4gPiA+DQo+ID4gPiBJIGFzc3VtZSB0aGlzIGhhcyBiZWVuIGRpc2N1c3Nl
ZCBiZWZvcmUsIGJ1dCBmcm9tIHJlYWRhYmlsaXR5IHAuby52DQo+ID4gPiBpdCBtaWdodCBiZSBn
b29kIHRvIGFkZCBhIGNvbW1lbnQgZm9yIHRoaXMgZnVuY3Rpb24gdG8gZXhwbGFpbiBob3cNCj4g
PiA+IHRoZSByZWNvcmRpbmcgb2YgbW0gaW4gdmZpb19tbSBjYW4gYmUgY29ycmVjdGx5IHJlbW92
ZWQgd2hlbiB0aGUgbW0NCj4gPiA+IGlzIGJlaW5nIGRlc3Ryb3llZCwgc2luY2Ugd2UgZG9uJ3Qg
aG9sZCBhIHJlZmVyZW5jZSBvZiBtbSBoZXJlLg0KPiA+DQo+ID4geWVhaCwgSSdsbCBhZGQgaXQu
DQo+ID4NCj4gPiA+ID4gKwlyZXR1cm4gdm1tOw0KPiA+ID4gPiArfQ0KPiA+ID4gPiArRVhQT1JU
X1NZTUJPTF9HUEwodmZpb19tbV9nZXRfZnJvbV90YXNrKTsNCj4gPiA+ID4gKw0KPiA+ID4gPiAr
aW50IHZmaW9fbW1fcGFzaWRfYWxsb2Moc3RydWN0IHZmaW9fbW0gKnZtbSwgaW50IG1pbiwgaW50
IG1heCkgew0KPiA+ID4gPiArCWlvYXNpZF90IHBhc2lkOw0KPiA+ID4gPiArCWludCByZXQgPSAt
RU5PU1BDOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJbXV0ZXhfbG9jaygmdm1tLT5wYXNpZF9sb2Nr
KTsNCj4gPiA+ID4gKw0KPiA+ID4gPiArCXBhc2lkID0gaW9hc2lkX2FsbG9jKHZtbS0+aW9hc2lk
X3NpZCwgbWluLCBtYXgsIE5VTEwpOw0KPiA+ID4gPiArCWlmIChwYXNpZCA9PSBJTlZBTElEX0lP
QVNJRCkgew0KPiA+ID4gPiArCQlyZXQgPSAtRU5PU1BDOw0KPiA+ID4gPiArCQlnb3RvIG91dF91
bmxvY2s7DQo+ID4gPiA+ICsJfQ0KPiA+ID4gPiArDQo+ID4gPiA+ICsJcmV0ID0gcGFzaWQ7DQo+
ID4gPiA+ICtvdXRfdW5sb2NrOg0KPiA+ID4gPiArCW11dGV4X3VubG9jaygmdm1tLT5wYXNpZF9s
b2NrKTsNCj4gPiA+ID4gKwlyZXR1cm4gcmV0Ow0KPiA+ID4gPiArfQ0KPiA+ID4gPiArRVhQT1JU
X1NZTUJPTF9HUEwodmZpb19tbV9wYXNpZF9hbGxvYyk7DQo+ID4gPiA+ICsNCj4gPiA+ID4gK2lu
dCB2ZmlvX21tX3Bhc2lkX2ZyZWUoc3RydWN0IHZmaW9fbW0gKnZtbSwgaW9hc2lkX3QgcGFzaWQp
IHsNCj4gPiA+ID4gKwl2b2lkICpwZGF0YTsNCj4gPiA+ID4gKwlpbnQgcmV0ID0gMDsNCj4gPiA+
ID4gKw0KPiA+ID4gPiArCW11dGV4X2xvY2soJnZtbS0+cGFzaWRfbG9jayk7DQo+ID4gPiA+ICsJ
cGRhdGEgPSBpb2FzaWRfZmluZCh2bW0tPmlvYXNpZF9zaWQsIHBhc2lkLCBOVUxMKTsNCj4gPiA+
ID4gKwlpZiAoSVNfRVJSKHBkYXRhKSkgew0KPiA+ID4gPiArCQlyZXQgPSBQVFJfRVJSKHBkYXRh
KTsNCj4gPiA+ID4gKwkJZ290byBvdXRfdW5sb2NrOw0KPiA+ID4gPiArCX0NCj4gPiA+ID4gKwlp
b2FzaWRfZnJlZShwYXNpZCk7DQo+ID4gPiA+ICsNCj4gPiA+ID4gK291dF91bmxvY2s6DQo+ID4g
PiA+ICsJbXV0ZXhfdW5sb2NrKCZ2bW0tPnBhc2lkX2xvY2spOw0KPiA+ID4gPiArCXJldHVybiBy
ZXQ7DQo+ID4gPiA+ICt9DQo+ID4gPiA+ICtFWFBPUlRfU1lNQk9MX0dQTCh2ZmlvX21tX3Bhc2lk
X2ZyZWUpOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsvKioNCj4gPiA+ID4gICAqIE1vZHVsZS9jbGFz
cyBzdXBwb3J0DQo+ID4gPiA+ICAgKi8NCj4gPiA+ID4gIHN0YXRpYyBjaGFyICp2ZmlvX2Rldm5v
ZGUoc3RydWN0IGRldmljZSAqZGV2LCB1bW9kZV90ICptb2RlKSBAQA0KPiA+ID4gPiAtMjE1MSw4
ICsyMjc5LDEwIEBAIHN0YXRpYyBpbnQgX19pbml0IHZmaW9faW5pdCh2b2lkKQ0KPiA+ID4gPiAg
CWlkcl9pbml0KCZ2ZmlvLmdyb3VwX2lkcik7DQo+ID4gPiA+ICAJbXV0ZXhfaW5pdCgmdmZpby5n
cm91cF9sb2NrKTsNCj4gPiA+ID4gIAltdXRleF9pbml0KCZ2ZmlvLmlvbW11X2RyaXZlcnNfbG9j
ayk7DQo+ID4gPiA+ICsJbXV0ZXhfaW5pdCgmdmZpby52ZmlvX21tX2xvY2spOw0KPiA+ID4gPiAg
CUlOSVRfTElTVF9IRUFEKCZ2ZmlvLmdyb3VwX2xpc3QpOw0KPiA+ID4gPiAgCUlOSVRfTElTVF9I
RUFEKCZ2ZmlvLmlvbW11X2RyaXZlcnNfbGlzdCk7DQo+ID4gPiA+ICsJSU5JVF9MSVNUX0hFQUQo
JnZmaW8udmZpb19tbV9saXN0KTsNCj4gPiA+ID4gIAlpbml0X3dhaXRxdWV1ZV9oZWFkKCZ2Zmlv
LnJlbGVhc2VfcSk7DQo+ID4gPiA+DQo+ID4gPiA+ICAJcmV0ID0gbWlzY19yZWdpc3RlcigmdmZp
b19kZXYpOw0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy92ZmlvL3ZmaW9faW9tbXVfdHlw
ZTEuYw0KPiA+ID4gPiBiL2RyaXZlcnMvdmZpby92ZmlvX2lvbW11X3R5cGUxLmMgaW5kZXggYTE3
N2JmMi4uMzMxY2VlZSAxMDA2NDQNCj4gPiA+ID4gLS0tIGEvZHJpdmVycy92ZmlvL3ZmaW9faW9t
bXVfdHlwZTEuYw0KPiA+ID4gPiArKysgYi9kcml2ZXJzL3ZmaW8vdmZpb19pb21tdV90eXBlMS5j
DQo+ID4gPiA+IEBAIC03MCw2ICs3MCw3IEBAIHN0cnVjdCB2ZmlvX2lvbW11IHsNCj4gPiA+ID4g
IAl1bnNpZ25lZCBpbnQJCWRtYV9hdmFpbDsNCj4gPiA+ID4gIAlib29sCQkJdjI7DQo+ID4gPiA+
ICAJYm9vbAkJCW5lc3Rpbmc7DQo+ID4gPiA+ICsJc3RydWN0IHZmaW9fbW0JCSp2bW07DQo+ID4g
PiA+ICB9Ow0KPiA+ID4gPg0KPiA+ID4gPiAgc3RydWN0IHZmaW9fZG9tYWluIHsNCj4gPiA+ID4g
QEAgLTIwMTgsNiArMjAxOSw3IEBAIHN0YXRpYyB2b2lkDQo+ID4gdmZpb19pb21tdV90eXBlMV9k
ZXRhY2hfZ3JvdXAodm9pZA0KPiA+ID4gPiAqaW9tbXVfZGF0YSwNCj4gPiA+ID4gIHN0YXRpYyB2
b2lkICp2ZmlvX2lvbW11X3R5cGUxX29wZW4odW5zaWduZWQgbG9uZyBhcmcpICB7DQo+ID4gPiA+
ICAJc3RydWN0IHZmaW9faW9tbXUgKmlvbW11Ow0KPiA+ID4gPiArCXN0cnVjdCB2ZmlvX21tICp2
bW0gPSBOVUxMOw0KPiA+ID4gPg0KPiA+ID4gPiAgCWlvbW11ID0ga3phbGxvYyhzaXplb2YoKmlv
bW11KSwgR0ZQX0tFUk5FTCk7DQo+ID4gPiA+ICAJaWYgKCFpb21tdSkNCj4gPiA+ID4gQEAgLTIw
NDMsNiArMjA0NSwxMCBAQCBzdGF0aWMgdm9pZA0KPiA+ICp2ZmlvX2lvbW11X3R5cGUxX29wZW4o
dW5zaWduZWQNCj4gPiA+ID4gbG9uZyBhcmcpDQo+ID4gPiA+ICAJaW9tbXUtPmRtYV9hdmFpbCA9
IGRtYV9lbnRyeV9saW1pdDsNCj4gPiA+ID4gIAltdXRleF9pbml0KCZpb21tdS0+bG9jayk7DQo+
ID4gPiA+ICAJQkxPQ0tJTkdfSU5JVF9OT1RJRklFUl9IRUFEKCZpb21tdS0+bm90aWZpZXIpOw0K
PiA+ID4gPiArCXZtbSA9IHZmaW9fbW1fZ2V0X2Zyb21fdGFzayhjdXJyZW50KTsNCj4gPiA+ID4g
KwlpZiAoIXZtbSkNCj4gPiA+ID4gKwkJcHJfZXJyKCJGYWlsZWQgdG8gZ2V0IHZmaW9fbW0gdHJh
Y2tcbiIpOw0KPiA+ID4NCj4gPiA+IEkgYXNzdW1lIGVycm9yIHNob3VsZCBiZSByZXR1cm5lZCB3
aGVuIHByX2VyciBpcyB1c2VkLi4uDQo+ID4NCj4gPiBnb3QgaXQuIEkgZGlkbid0IGRvIGl0IGFz
IEkgZG9u4oCZdCB0aGluayB2ZmlvX21tIGlzIG5lY2Vzc2FyeSBmb3INCj4gPiBldmVyeSBpb21t
dSBvcGVuLiBJdCBpcyBuZWNlc3NhcnkgZm9yIHRoZSBuZXN0aW5nIHR5cGUgaW9tbXUuIEknbGwN
Cj4gPiBtYWtlIGl0IGZldGNoIHZtbSB3aGVuIGl0IGlzIG9wZW5pbmcgbmVzdGluZyB0eXBlIGFu
ZCByZXR1cm4gZXJyb3INCj4gPiBpZiBmYWlsZWQuDQo+IA0KPiBzb3VuZHMgZ29vZC4NCj4gDQo+
ID4NCj4gPiA+ID4gKwlpb21tdS0+dm1tID0gdm1tOw0KPiA+ID4gPg0KPiA+ID4gPiAgCXJldHVy
biBpb21tdTsNCj4gPiA+ID4gIH0NCj4gPiA+ID4gQEAgLTIwODQsNiArMjA5MCw4IEBAIHN0YXRp
YyB2b2lkIHZmaW9faW9tbXVfdHlwZTFfcmVsZWFzZSh2b2lkDQo+ID4gPiA+ICppb21tdV9kYXRh
KQ0KPiA+ID4gPiAgCX0NCj4gPiA+ID4NCj4gPiA+ID4gIAl2ZmlvX2lvbW11X2lvdmFfZnJlZSgm
aW9tbXUtPmlvdmFfbGlzdCk7DQo+ID4gPiA+ICsJaWYgKGlvbW11LT52bW0pDQo+ID4gPiA+ICsJ
CXZmaW9fbW1fcHV0KGlvbW11LT52bW0pOw0KPiA+ID4gPg0KPiA+ID4gPiAgCWtmcmVlKGlvbW11
KTsNCj4gPiA+ID4gIH0NCj4gPiA+ID4gQEAgLTIxNzIsNiArMjE4MCw1NSBAQCBzdGF0aWMgaW50
IHZmaW9faW9tbXVfaW92YV9idWlsZF9jYXBzKHN0cnVjdA0KPiA+ID4gPiB2ZmlvX2lvbW11ICpp
b21tdSwNCj4gPiA+ID4gIAlyZXR1cm4gcmV0Ow0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4g
PiArc3RhdGljIGJvb2wgdmZpb19pb21tdV90eXBlMV9wYXNpZF9yZXFfdmFsaWQodTMyIGZsYWdz
KQ0KPiA+ID4NCj4gPiA+IEkgZG9uJ3QgdGhpbmsgeW91IG5lZWQgcHJlZml4ICJ2ZmlvX2lvbW11
X3R5cGUxIiBmb3IgZXZlcnkgbmV3DQo+ID4gPiBmdW5jdGlvbiBoZXJlLCBlc3BlY2lhbGx5IGZv
ciBsZWFmIGludGVybmFsIGZ1bmN0aW9uIGFzIHRoaXMgb25lLg0KPiA+DQo+ID4gZ290IGl0LiB0
aGFua3MuDQo+ID4NCj4gPiA+ID4gK3sNCj4gPiA+ID4gKwlyZXR1cm4gISgoZmxhZ3MgJiB+VkZJ
T19QQVNJRF9SRVFVRVNUX01BU0spIHx8DQo+ID4gPiA+ICsJCSAoZmxhZ3MgJiBWRklPX0lPTU1V
X1BBU0lEX0FMTE9DICYmDQo+ID4gPiA+ICsJCSAgZmxhZ3MgJiBWRklPX0lPTU1VX1BBU0lEX0ZS
RUUpKTsNCj4gPiA+ID4gK30NCj4gPiA+ID4gKw0KPiA+ID4gPiArc3RhdGljIGludCB2ZmlvX2lv
bW11X3R5cGUxX3Bhc2lkX2FsbG9jKHN0cnVjdCB2ZmlvX2lvbW11ICppb21tdSwNCj4gPiA+ID4g
KwkJCQkJIGludCBtaW4sDQo+ID4gPiA+ICsJCQkJCSBpbnQgbWF4KQ0KPiA+ID4gPiArew0KPiA+
ID4gPiArCXN0cnVjdCB2ZmlvX21tICp2bW0gPSBpb21tdS0+dm1tOw0KPiA+ID4gPiArCWludCBy
ZXQgPSAwOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJbXV0ZXhfbG9jaygmaW9tbXUtPmxvY2spOw0K
PiA+ID4gPiArCWlmICghSVNfSU9NTVVfQ0FQX0RPTUFJTl9JTl9DT05UQUlORVIoaW9tbXUpKSB7
DQo+ID4gPiA+ICsJCXJldCA9IC1FRkFVTFQ7DQo+ID4gPg0KPiA+ID4gd2h5IC1FRkFVTFQ/DQo+
ID4NCj4gPiB3ZWxsLCBpdCdzIGZyb20gYSBwcmlvciBjb21tZW50IGFzIGJlbG93Og0KPiA+ICAg
dmZpb19tbV9wYXNpZF9hbGxvYygpIGNhbiByZXR1cm4gLUVOT1NQQyB0aG91Z2gsIHNvIGl0J2Qg
YmUgbmljZSB0bw0KPiA+ICAgZGlmZmVyZW50aWF0ZSB0aGUgZXJyb3JzLiBXZSBjb3VsZCB1c2Ug
RUZBVUxUIGZvciB0aGUgbm8gSU9NTVUgY2FzZQ0KPiA+ICAgYW5kIEVJTlZBTCBoZXJlPw0KPiA+
IGh0dHA6Ly9sa21sLml1LmVkdS9oeXBlcm1haWwvbGludXgva2VybmVsLzIwMDEuMy8wNTk2NC5o
dG1sDQo+ID4NCj4gPiA+DQo+ID4gPiA+ICsJCWdvdG8gb3V0X3VubG9jazsNCj4gPiA+ID4gKwl9
DQo+ID4gPiA+ICsJaWYgKHZtbSkNCj4gPiA+ID4gKwkJcmV0ID0gdmZpb19tbV9wYXNpZF9hbGxv
Yyh2bW0sIG1pbiwgbWF4KTsNCj4gPiA+ID4gKwllbHNlDQo+ID4gPiA+ICsJCXJldCA9IC1FSU5W
QUw7DQo+ID4gPiA+ICtvdXRfdW5sb2NrOg0KPiA+ID4gPiArCW11dGV4X3VubG9jaygmaW9tbXUt
PmxvY2spOw0KPiA+ID4gPiArCXJldHVybiByZXQ7DQo+ID4gPiA+ICt9DQo+ID4gPiA+ICsNCj4g
PiA+ID4gK3N0YXRpYyBpbnQgdmZpb19pb21tdV90eXBlMV9wYXNpZF9mcmVlKHN0cnVjdCB2Zmlv
X2lvbW11ICppb21tdSwNCj4gPiA+ID4gKwkJCQkgICAgICAgdW5zaWduZWQgaW50IHBhc2lkKQ0K
PiA+ID4gPiArew0KPiA+ID4gPiArCXN0cnVjdCB2ZmlvX21tICp2bW0gPSBpb21tdS0+dm1tOw0K
PiA+ID4gPiArCWludCByZXQgPSAwOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJbXV0ZXhfbG9jaygm
aW9tbXUtPmxvY2spOw0KPiA+ID4gPiArCWlmICghSVNfSU9NTVVfQ0FQX0RPTUFJTl9JTl9DT05U
QUlORVIoaW9tbXUpKSB7DQo+ID4gPiA+ICsJCXJldCA9IC1FRkFVTFQ7DQo+ID4gPg0KPiA+ID4g
ZGl0dG8NCj4gPiA+DQo+ID4gPiA+ICsJCWdvdG8gb3V0X3VubG9jazsNCj4gPiA+ID4gKwl9DQo+
ID4gPiA+ICsNCj4gPiA+ID4gKwlpZiAodm1tKQ0KPiA+ID4gPiArCQlyZXQgPSB2ZmlvX21tX3Bh
c2lkX2ZyZWUodm1tLCBwYXNpZCk7DQo+ID4gPiA+ICsJZWxzZQ0KPiA+ID4gPiArCQlyZXQgPSAt
RUlOVkFMOw0KPiA+ID4gPiArb3V0X3VubG9jazoNCj4gPiA+ID4gKwltdXRleF91bmxvY2soJmlv
bW11LT5sb2NrKTsNCj4gPiA+ID4gKwlyZXR1cm4gcmV0Ow0KPiA+ID4gPiArfQ0KPiA+ID4gPiAr
DQo+ID4gPiA+ICBzdGF0aWMgbG9uZyB2ZmlvX2lvbW11X3R5cGUxX2lvY3RsKHZvaWQgKmlvbW11
X2RhdGEsDQo+ID4gPiA+ICAJCQkJICAgdW5zaWduZWQgaW50IGNtZCwgdW5zaWduZWQgbG9uZyBh
cmcpDQo+ID4gPiA+ICB7DQo+ID4gPiA+IEBAIC0yMjc2LDYgKzIzMzMsNTMgQEAgc3RhdGljIGxv
bmcgdmZpb19pb21tdV90eXBlMV9pb2N0bCh2b2lkDQo+ID4gPiA+ICppb21tdV9kYXRhLA0KPiA+
ID4gPg0KPiA+ID4gPiAgCQlyZXR1cm4gY29weV90b191c2VyKCh2b2lkIF9fdXNlciAqKWFyZywg
JnVubWFwLCBtaW5zeikgPw0KPiA+ID4gPiAgCQkJLUVGQVVMVCA6IDA7DQo+ID4gPiA+ICsNCj4g
PiA+ID4gKwl9IGVsc2UgaWYgKGNtZCA9PSBWRklPX0lPTU1VX1BBU0lEX1JFUVVFU1QpIHsNCj4g
PiA+ID4gKwkJc3RydWN0IHZmaW9faW9tbXVfdHlwZTFfcGFzaWRfcmVxdWVzdCByZXE7DQo+ID4g
PiA+ICsJCXVuc2lnbmVkIGxvbmcgb2Zmc2V0Ow0KPiA+ID4gPiArDQo+ID4gPiA+ICsJCW1pbnN6
ID0gb2Zmc2V0b2ZlbmQoc3RydWN0IHZmaW9faW9tbXVfdHlwZTFfcGFzaWRfcmVxdWVzdCwNCj4g
PiA+ID4gKwkJCQkgICAgZmxhZ3MpOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJCWlmIChjb3B5X2Zy
b21fdXNlcigmcmVxLCAodm9pZCBfX3VzZXIgKilhcmcsIG1pbnN6KSkNCj4gPiA+ID4gKwkJCXJl
dHVybiAtRUZBVUxUOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsJCWlmIChyZXEuYXJnc3ogPCBtaW5z
eiB8fA0KPiA+ID4gPiArCQkgICAgIXZmaW9faW9tbXVfdHlwZTFfcGFzaWRfcmVxX3ZhbGlkKHJl
cS5mbGFncykpDQo+ID4gPiA+ICsJCQlyZXR1cm4gLUVJTlZBTDsNCj4gPiA+ID4gKw0KPiA+ID4g
PiArCQlpZiAoY29weV9mcm9tX3VzZXIoKHZvaWQgKikmcmVxICsgbWluc3osDQo+ID4gPiA+ICsJ
CQkJICAgKHZvaWQgX191c2VyICopYXJnICsgbWluc3osDQo+ID4gPiA+ICsJCQkJICAgc2l6ZW9m
KHJlcSkgLSBtaW5zeikpDQo+ID4gPiA+ICsJCQlyZXR1cm4gLUVGQVVMVDsNCj4gPiA+DQo+ID4g
PiB3aHkgY29weWluZyBpbiB0d28gc3RlcHMgaW5zdGVhZCBvZiBjb3B5aW5nIHRoZW0gdG9nZXRo
ZXI/DQo+ID4NCj4gPiBqdXN0IHdhbnQgdG8gZG8gc2FuaXR5IGNoZWNrIGJlZm9yZSBjb3B5aW5n
IGFsbCB0aGUgZGF0YS4gSQ0KPiA+IGNhbiBtb3ZlIGl0IGFzIG9uZSBjb3B5IGlmIGl0J3MgYmV0
dGVyLiA6LSkNCj4gDQo+IGl0J3MgcG9zc2libGUgZmluZS4gSSBqdXN0IHNhdyB5b3UgZGlkIHNh
bWUgdGhpbmcgZm9yIG90aGVyIHVhcGlzLg0KPiANCj4gPg0KPiA+ID4gPiArDQo+ID4gPiA+ICsJ
CXN3aXRjaCAocmVxLmZsYWdzICYgVkZJT19QQVNJRF9SRVFVRVNUX01BU0spIHsNCj4gPiA+ID4g
KwkJY2FzZSBWRklPX0lPTU1VX1BBU0lEX0FMTE9DOg0KPiA+ID4gPiArCQl7DQo+ID4gPiA+ICsJ
CQlpbnQgcmV0ID0gMCwgcmVzdWx0Ow0KPiA+ID4gPiArDQo+ID4gPiA+ICsJCQlyZXN1bHQgPSB2
ZmlvX2lvbW11X3R5cGUxX3Bhc2lkX2FsbG9jKGlvbW11LA0KPiA+ID4gPiArCQkJCQkJCXJlcS5h
bGxvY19wYXNpZC5taW4sDQo+ID4gPiA+ICsJCQkJCQkJcmVxLmFsbG9jX3Bhc2lkLm1heCk7DQo+
ID4gPiA+ICsJCQlpZiAocmVzdWx0ID4gMCkgew0KPiA+ID4gPiArCQkJCW9mZnNldCA9IG9mZnNl
dG9mKA0KPiA+ID4gPiArCQkJCQlzdHJ1Y3QNCj4gPiA+ID4gdmZpb19pb21tdV90eXBlMV9wYXNp
ZF9yZXF1ZXN0LA0KPiA+ID4gPiArCQkJCQlhbGxvY19wYXNpZC5yZXN1bHQpOw0KPiA+ID4gPiAr
CQkJCXJldCA9IGNvcHlfdG9fdXNlcigNCj4gPiA+ID4gKwkJCQkJICAgICAgKHZvaWQgX191c2Vy
ICopIChhcmcgKyBvZmZzZXQpLA0KPiA+ID4gPiArCQkJCQkgICAgICAmcmVzdWx0LCBzaXplb2Yo
cmVzdWx0KSk7DQo+ID4gPiA+ICsJCQl9IGVsc2Ugew0KPiA+ID4gPiArCQkJCXByX2RlYnVnKCIl
czogUEFTSUQgYWxsb2MgZmFpbGVkXG4iLA0KPiA+ID4gPiBfX2Z1bmNfXyk7DQo+ID4gPiA+ICsJ
CQkJcmV0ID0gLUVGQVVMVDsNCj4gPiA+DQo+ID4gPiBubywgdGhpcyBicmFuY2ggaXMgbm90IGZv
ciBjb3B5X3RvX3VzZXIgZXJyb3IuIGl0IGlzIGFib3V0IHBhc2lkIGFsbG9jDQo+ID4gPiBmYWls
dXJlLiB5b3Ugc2hvdWxkIGhhbmRsZSBib3RoLg0KPiA+DQo+ID4gRW1tbSwgSSBqdXN0IHdhbnQg
dG8gZmFpbCB0aGUgSU9DVEwgaW4gc3VjaCBjYXNlLCBzbyB0aGUgQHJlc3VsdCBmaWVsZA0KPiA+
IGlzIG1lYW5pbmdsZXNzIGluIHRoZSB1c2VyIHNpZGUuIEhvdyBhYm91dCB1c2luZyBhbm90aGVy
IHJldHVybiB2YWx1ZQ0KPiA+IChlLmcuIEVOT1NQQykgdG8gaW5kaWNhdGUgdGhlIElPQ1RMIGZh
aWx1cmU/DQo+IA0KPiBJZiBwYXNpZF9hbGxvYyBmYWlscywgeW91IHJldHVybiBpdHMgcmVzdWx0
IHRvIHVzZXJzcGFjZQ0KPiBpZiBjb3B5X3RvX3VzZXIgZmFpbHMsIHRoZW4gcmV0dXJuIC1FRkFV
TFQuDQo+IA0KPiBob3dldmVyLCBhYm92ZSB5b3UgcmV0dXJuIC1FRkFVTFQgZm9yIHBhc2lkX2Fs
bG9jIGZhaWx1cmUsIGFuZA0KPiB0aGVuIHRoZSBudW1iZXIgb2Ygbm90LWNvcGllZCBieXRlcyBm
b3IgY29weV90b191c2VyLg0KDQpub3QgcXVpdGUgZ2V0LiBMZXQgbWUgcmUtcGFzdGUgdGhlIGNv
ZGUuIDotKQ0KDQorCQljYXNlIFZGSU9fSU9NTVVfUEFTSURfQUxMT0M6DQorCQl7DQorCQkJaW50
IHJldCA9IDAsIHJlc3VsdDsNCisNCisJCQlyZXN1bHQgPSB2ZmlvX2lvbW11X3R5cGUxX3Bhc2lk
X2FsbG9jKGlvbW11LA0KKwkJCQkJCQlyZXEuYWxsb2NfcGFzaWQubWluLA0KKwkJCQkJCQlyZXEu
YWxsb2NfcGFzaWQubWF4KTsNCisJCQlpZiAocmVzdWx0ID4gMCkgew0KKwkJCQlvZmZzZXQgPSBv
ZmZzZXRvZigNCisJCQkJCXN0cnVjdCB2ZmlvX2lvbW11X3R5cGUxX3Bhc2lkX3JlcXVlc3QsDQor
CQkJCQlhbGxvY19wYXNpZC5yZXN1bHQpOw0KKwkJCQlyZXQgPSBjb3B5X3RvX3VzZXIoDQorCQkJ
CQkgICAgICAodm9pZCBfX3VzZXIgKikgKGFyZyArIG9mZnNldCksDQorCQkJCQkgICAgICAmcmVz
dWx0LCBzaXplb2YocmVzdWx0KSk7DQppZiBjb3B5X3RvX3VzZXIgZmFpbGVkLCByZXQgaXMgdGhl
IG51bWJlciBvZiB1bmNvcGllZCBieXRlcyBhbmQNCndpbGwgYmUgcmV0dXJuZWQgdG8gdXNlcnNw
YWNlIHRvIGluZGljYXRlIGZhaWx1cmUuIHVzZXJzcGFjZSB3aWxsDQpub3QgdXNlIHRoZSBkYXRh
IGluIHJlc3VsdCBmaWVsZC4gcGVyaGFwcywgSSBzaG91bGQgY2hlY2sgdGhlIHJldA0KaGVyZSBh
bmQgcmV0dXJuIC1FRkFVTFQgb3IgYW5vdGhlciBlcnJubywgaW5zdGVhZCBvZiByZXR1cm4gdGhl
DQpudW1iZXIgb2YgdW4tY29waWVkIGJ5dGVzLg0KKwkJCX0gZWxzZSB7DQorCQkJCXByX2RlYnVn
KCIlczogUEFTSUQgYWxsb2MgZmFpbGVkXG4iLCBfX2Z1bmNfXyk7DQorCQkJCXJldCA9IC1FRkFV
TFQ7DQppZiB2ZmlvX2lvbW11X3R5cGUxX3Bhc2lkX2FsbG9jKCkgZmFpbGVkLCBubyBkb3VidCwg
cmV0dXJuIC1FRkFVTFQNCnRvIHVzZXJzcGFjZSB0byBpbmRpY2F0ZSBmYWlsdXJlLg0KKwkJCX0N
CisJCQlyZXR1cm4gcmV0Ow0KKwkJfQ0KDQppcyB0aGVyZSBzdGlsbCBwb3JibGVtIGhlcmU/DQo+
ID4NCj4gPiA+ID4gKwkJCX0NCj4gPiA+ID4gKwkJCXJldHVybiByZXQ7DQo+ID4gPiA+ICsJCX0N
Cj4gPiA+ID4gKwkJY2FzZSBWRklPX0lPTU1VX1BBU0lEX0ZSRUU6DQo+ID4gPiA+ICsJCQlyZXR1
cm4gdmZpb19pb21tdV90eXBlMV9wYXNpZF9mcmVlKGlvbW11LA0KPiA+ID4gPiArCQkJCQkJCSAg
IHJlcS5mcmVlX3Bhc2lkKTsNCj4gPiA+ID4gKwkJZGVmYXVsdDoNCj4gPiA+ID4gKwkJCXJldHVy
biAtRUlOVkFMOw0KPiA+ID4gPiArCQl9DQo+ID4gPiA+ICAJfQ0KPiA+ID4gPg0KPiA+ID4gPiAg
CXJldHVybiAtRU5PVFRZOw0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC92Zmlv
LmggYi9pbmNsdWRlL2xpbnV4L3ZmaW8uaA0KPiA+ID4gPiBpbmRleCBlNDJhNzExLi43NWY5Zjdm
MSAxMDA2NDQNCj4gPiA+ID4gLS0tIGEvaW5jbHVkZS9saW51eC92ZmlvLmgNCj4gPiA+ID4gKysr
IGIvaW5jbHVkZS9saW51eC92ZmlvLmgNCj4gPiA+ID4gQEAgLTg5LDYgKzg5LDI2IEBAIGV4dGVy
biBpbnQgdmZpb19yZWdpc3Rlcl9pb21tdV9kcml2ZXIoY29uc3Qgc3RydWN0DQo+ID4gPiA+IHZm
aW9faW9tbXVfZHJpdmVyX29wcyAqb3BzKTsNCj4gPiA+ID4gIGV4dGVybiB2b2lkIHZmaW9fdW5y
ZWdpc3Rlcl9pb21tdV9kcml2ZXIoDQo+ID4gPiA+ICAJCQkJY29uc3Qgc3RydWN0IHZmaW9faW9t
bXVfZHJpdmVyX29wcyAqb3BzKTsNCj4gPiA+ID4NCj4gPiA+ID4gKyNkZWZpbmUgVkZJT19ERUZB
VUxUX1BBU0lEX1FVT1RBCTEwMDANCj4gPiA+ID4gK3N0cnVjdCB2ZmlvX21tX3Rva2VuIHsNCj4g
PiA+ID4gKwl1bnNpZ25lZCBsb25nIGxvbmcgdmFsOw0KPiA+ID4gPiArfTsNCj4gPiA+ID4gKw0K
PiA+ID4gPiArc3RydWN0IHZmaW9fbW0gew0KPiA+ID4gPiArCXN0cnVjdCBrcmVmCQkJa3JlZjsN
Cj4gPiA+ID4gKwlzdHJ1Y3QgdmZpb19tbV90b2tlbgkJdG9rZW47DQo+ID4gPiA+ICsJaW50CQkJ
CWlvYXNpZF9zaWQ7DQo+ID4gPiA+ICsJLyogcHJvdGVjdCBAcGFzaWRfcXVvdGEgZmllbGQgYW5k
IHBhc2lkIGFsbG9jYXRpb24vZnJlZSAqLw0KPiA+ID4gPiArCXN0cnVjdCBtdXRleAkJCXBhc2lk
X2xvY2s7DQo+ID4gPiA+ICsJaW50CQkJCXBhc2lkX3F1b3RhOw0KPiA+ID4gPiArCXN0cnVjdCBs
aXN0X2hlYWQJCXZmaW9fbmV4dDsNCj4gPiA+ID4gK307DQo+ID4gPiA+ICsNCj4gPiA+ID4gK2V4
dGVybiBzdHJ1Y3QgdmZpb19tbSAqdmZpb19tbV9nZXRfZnJvbV90YXNrKHN0cnVjdCB0YXNrX3N0
cnVjdA0KPiA+ICp0YXNrKTsNCj4gPiA+ID4gK2V4dGVybiB2b2lkIHZmaW9fbW1fcHV0KHN0cnVj
dCB2ZmlvX21tICp2bW0pOw0KPiA+ID4gPiArZXh0ZXJuIGludCB2ZmlvX21tX3Bhc2lkX2FsbG9j
KHN0cnVjdCB2ZmlvX21tICp2bW0sIGludCBtaW4sIGludCBtYXgpOw0KPiA+ID4gPiArZXh0ZXJu
IGludCB2ZmlvX21tX3Bhc2lkX2ZyZWUoc3RydWN0IHZmaW9fbW0gKnZtbSwgaW9hc2lkX3QgcGFz
aWQpOw0KPiA+ID4gPiArDQo+ID4gPiA+ICAvKg0KPiA+ID4gPiAgICogRXh0ZXJuYWwgdXNlciBB
UEkNCj4gPiA+ID4gICAqLw0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2xpbnV4
L3ZmaW8uaCBiL2luY2x1ZGUvdWFwaS9saW51eC92ZmlvLmgNCj4gPiA+ID4gaW5kZXggOWU4NDNh
MS4uMjk4YWM4MCAxMDA2NDQNCj4gPiA+ID4gLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L3ZmaW8u
aA0KPiA+ID4gPiArKysgYi9pbmNsdWRlL3VhcGkvbGludXgvdmZpby5oDQo+ID4gPiA+IEBAIC03
OTQsNiArNzk0LDQ3IEBAIHN0cnVjdCB2ZmlvX2lvbW11X3R5cGUxX2RtYV91bm1hcCB7DQo+ID4g
PiA+ICAjZGVmaW5lIFZGSU9fSU9NTVVfRU5BQkxFCV9JTyhWRklPX1RZUEUsIFZGSU9fQkFTRSAr
IDE1KQ0KPiA+ID4gPiAgI2RlZmluZSBWRklPX0lPTU1VX0RJU0FCTEUJX0lPKFZGSU9fVFlQRSwg
VkZJT19CQVNFICsgMTYpDQo+ID4gPiA+DQo+ID4gPiA+ICsvKg0KPiA+ID4gPiArICogUEFTSUQg
KFByb2Nlc3MgQWRkcmVzcyBTcGFjZSBJRCkgaXMgYSBQQ0llIGNvbmNlcHQgd2hpY2gNCj4gPiA+
ID4gKyAqIGhhcyBiZWVuIGV4dGVuZGVkIHRvIHN1cHBvcnQgRE1BIGlzb2xhdGlvbiBpbiBmaW5l
LWdyYWluLg0KPiA+ID4gPiArICogV2l0aCBkZXZpY2UgYXNzaWduZWQgdG8gdXNlciBzcGFjZSAo
ZS5nLiBWTXMpLCBQQVNJRCBhbGxvYw0KPiA+ID4gPiArICogYW5kIGZyZWUgbmVlZCB0byBiZSBz
eXN0ZW0gd2lkZS4gVGhpcyBzdHJ1Y3R1cmUgZGVmaW5lcw0KPiA+ID4gPiArICogdGhlIGluZm8g
Zm9yIHBhc2lkIGFsbG9jL2ZyZWUgYmV0d2VlbiB1c2VyIHNwYWNlIGFuZCBrZXJuZWwNCj4gPiA+
ID4gKyAqIHNwYWNlLg0KPiA+ID4gPiArICoNCj4gPiA+ID4gKyAqIEBmbGFnPVZGSU9fSU9NTVVf
UEFTSURfQUxMT0MsIHJlZmVyIHRvIHRoZSBAYWxsb2NfcGFzaWQNCj4gPiA+ID4gKyAqIEBmbGFn
PVZGSU9fSU9NTVVfUEFTSURfRlJFRSwgcmVmZXIgdG8gQGZyZWVfcGFzaWQNCj4gPiA+ID4gKyAq
Lw0KPiA+ID4gPiArc3RydWN0IHZmaW9faW9tbXVfdHlwZTFfcGFzaWRfcmVxdWVzdCB7DQo+ID4g
PiA+ICsJX191MzIJYXJnc3o7DQo+ID4gPiA+ICsjZGVmaW5lIFZGSU9fSU9NTVVfUEFTSURfQUxM
T0MJKDEgPDwgMCkNCj4gPiA+ID4gKyNkZWZpbmUgVkZJT19JT01NVV9QQVNJRF9GUkVFCSgxIDw8
IDEpDQo+ID4gPiA+ICsJX191MzIJZmxhZ3M7DQo+ID4gPiA+ICsJdW5pb24gew0KPiA+ID4gPiAr
CQlzdHJ1Y3Qgew0KPiA+ID4gPiArCQkJX191MzIgbWluOw0KPiA+ID4gPiArCQkJX191MzIgbWF4
Ow0KPiA+ID4gPiArCQkJX191MzIgcmVzdWx0Ow0KPiA+ID4NCj4gPiA+IHJlc3VsdC0+cGFzaWQ/
DQo+ID4NCj4gPiB5ZXMsIHRoZSBwYXNpZCBhbGxvY2F0ZWQuDQo+ID4NCj4gPiA+DQo+ID4gPiA+
ICsJCX0gYWxsb2NfcGFzaWQ7DQo+ID4gPiA+ICsJCV9fdTMyIGZyZWVfcGFzaWQ7DQo+ID4gPg0K
PiA+ID4gd2hhdCBhYm91dCBwdXR0aW5nIGEgY29tbW9uIHBhc2lkIGZpZWxkIGFmdGVyIGZsYWdz
Pw0KPiA+DQo+ID4gbG9va3MgZ29vZCB0byBtZS4gQnV0IGl0IHdvdWxkIG1ha2UgdGhlIHVuaW9u
IHBhcnQgb25seSBtZWFuaW5nZnVsDQo+ID4gdG8gYWxsb2MgcGFzaWQuIGlmIHNvLCBtYXliZSBt
YWtlIHRoZSB1bmlvbiBwYXJ0IGFzIGEgZGF0YSBmaWVsZCBhbmQNCj4gPiBvbmx5IGFsbG9jIHBh
c2lkIHdpbGwgaGF2ZSBpdC4gRm9yIGZyZWUgcGFzaWQsIGl0IGlzIG5vdCBuZWNlc3NhcnkNCj4g
PiB0byByZWFkIGl0IGZyb20gdXNlcnNwYWNlLiBkb2VzIGl0IGxvb2sgZ29vZD8NCj4gDQo+IG1h
eWJlIGtlZXBpbmcgdGhlIHVuaW9uIGlzIGFsc28gT0ssIGp1c3Qgd2l0aCB7bWluLCBtYXh9IGZv
ciBhbGxvYy4NCj4gd2hvIGtub3dzIHdoZXRoZXIgbW9yZSBwYXNpZCBvcHMgd2lsbCBiZSBhZGRl
ZCBpbiB0aGUgZnV0dXJlDQo+IHdoaWNoIG1heSByZXF1aXJlIGl0cyBzcGVjaWZpYyB1bmlvbiBz
dHJ1Y3R1cmUuID8/IHB1dHRpbmcgcGFzaWQNCj4gYXMgYSBjb21tb24gZmllbGQgaXMgcmVhc29u
YWJsZSBiZWNhdXNlIHRoZSB3aG9sZSBjbWQgaXMgZm9yDQo+IHBhc2lkLg0KDQpnb3QgaXQuDQoN
ClRoYW5rcywNCllpIExpdQ0KDQo=

--_002_A2975661238FB949B60364EF0F2C25743A21B065SHSMSX104ccrcor_
Content-Type: message/rfc822
Content-Disposition: attachment;
	creation-date="Tue, 31 Mar 2020 13:22:01 GMT";
	modification-date="Tue, 31 Mar 2020 13:22:01 GMT"

Received: from fmsmsx103.amr.corp.intel.com (10.18.124.201) by
 SHSMSX101.ccr.corp.intel.com (10.239.4.153) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Fri, 27 Mar 2020 07:57:25 +0800
Received: from orsmga004.jf.intel.com (10.7.209.38) by
 FMSMSX103.amr.corp.intel.com (10.18.124.210) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Thu, 26 Mar 2020 16:57:23 -0700
Received: from jacob-builder.jf.intel.com (HELO jacob-builder)
 ([10.7.199.155])  by orsmga004.jf.intel.com with ESMTP; 26 Mar 2020 16:57:07
 -0700
From: Jacob Pan <jacob.jun.pan@linux.intel.com>
To: "Liu, Yi L" <yi.l.liu@intel.com>
CC: "jacob.jun.pan@linux.intel.com" <jacob.jun.pan@linux.intel.com>
Subject: Re: [PATCH v1 1/8] vfio: Add VFIO_IOMMU_PASID_REQUEST(alloc/free)
Thread-Topic: [PATCH v1 1/8] vfio: Add VFIO_IOMMU_PASID_REQUEST(alloc/free)
Thread-Index: AQHWAEUbC4GB74LMekup8jIcF6WIFqhbD3cA
Date: Fri, 27 Mar 2020 00:02:52 +0000
Message-ID: <20200326170252.719ff28d@jacob-builder>
References: <1584880325-10561-1-git-send-email-yi.l.liu@intel.com>
	<1584880325-10561-2-git-send-email-yi.l.liu@intel.com>
In-Reply-To: <1584880325-10561-2-git-send-email-yi.l.liu@intel.com>
Content-Language: en-US
X-MS-Exchange-Organization-AuthMechanism: 10
X-MS-Exchange-Organization-AuthSource: FMSMSX103.amr.corp.intel.com
X-MS-Has-Attach:
X-Message-Flag: Follow up
X-MS-TNEF-Correlator:
x-ironport-av: E=Sophos;i="5.72,310,1580803200";
    d="scan'208";a="394198175"
Content-Type: text/plain; charset="us-ascii"
Content-ID: <F2A9881413FD2740AAF1610EAAC9F07C@intel.com>
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

off the list

On Sun, 22 Mar 2020 05:31:58 -0700
"Liu, Yi L" <yi.l.liu@intel.com> wrote:

> +     mutex_lock(&vmm->pasid_lock);
> +     pdata =3D ioasid_find(vmm->ioasid_sid, pasid, NULL);
> +     if (IS_ERR(pdata)) {
> +             ret =3D PTR_ERR(pdata);
> +             goto out_unlock;
> +     }
> +     ioasid_free(pasid);
> +
[Jacob Pan] this might be better to put under ioasid code such that it
is under the ioasid lock. no one else can free the ioasid between find()
and free().
e.g. ioasid_free(sid, pasid)
if sid =3D=3D INVALID_IOASID_SET, then no set ownership checking.

thoughts?

--_002_A2975661238FB949B60364EF0F2C25743A21B065SHSMSX104ccrcor_--
