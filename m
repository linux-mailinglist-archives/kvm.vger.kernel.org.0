Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 18AD64D8E8
	for <lists+kvm@lfdr.de>; Thu, 20 Jun 2019 20:30:49 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727433AbfFTS3K (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Thu, 20 Jun 2019 14:29:10 -0400
Received: from mail-eopbgr790089.outbound.protection.outlook.com ([40.107.79.89]:5088
        "EHLO NAM03-CO1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S1727574AbfFTSDO (ORCPT <rfc822;kvm@vger.kernel.org>);
        Thu, 20 Jun 2019 14:03:14 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amdcloud.onmicrosoft.com; s=selector1-amdcloud-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=78EaxjDNkcvFzn+iO+Nuva/+qUD2IPxa3CAOogqXDKU=;
 b=wk6gJf/lKVbEp1cD19u1MROmbPBacE6rf8QlAIpsop0WDRCwMmqAa/5e0A4hXvhYYMi0evqDnGlTc+qSKed+rVf30a+/6Y12l74m8/rrGQZEdSgH2qN+7ps5bW39eeG/2A4/tvpOwhTRFAo446OBbZgn5YoexH5hI9HtIKHDrlM=
Received: from DM6PR12MB2682.namprd12.prod.outlook.com (20.176.116.31) by
 DM6PR12MB2842.namprd12.prod.outlook.com (20.176.116.80) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1987.13; Thu, 20 Jun 2019 18:03:10 +0000
Received: from DM6PR12MB2682.namprd12.prod.outlook.com
 ([fe80::b9c1:b235:fff3:dba2]) by DM6PR12MB2682.namprd12.prod.outlook.com
 ([fe80::b9c1:b235:fff3:dba2%6]) with mapi id 15.20.1987.014; Thu, 20 Jun 2019
 18:03:10 +0000
From:   "Singh, Brijesh" <brijesh.singh@amd.com>
To:     "qemu-devel@nongnu.org" <qemu-devel@nongnu.org>
CC:     "Lendacky, Thomas" <Thomas.Lendacky@amd.com>,
        "kvm@vger.kernel.org" <kvm@vger.kernel.org>,
        "Singh, Brijesh" <brijesh.singh@amd.com>
Subject: [RFC PATCH v1 02/12] kvm: introduce high-level API to support
 encrypted guest migration
Thread-Topic: [RFC PATCH v1 02/12] kvm: introduce high-level API to support
 encrypted guest migration
Thread-Index: AQHVJ5Jp0L4i7VOWuEiaJ/44K3kyUA==
Date:   Thu, 20 Jun 2019 18:03:06 +0000
Message-ID: <20190620180247.8825-3-brijesh.singh@amd.com>
References: <20190620180247.8825-1-brijesh.singh@amd.com>
In-Reply-To: <20190620180247.8825-1-brijesh.singh@amd.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: DM5PR16CA0025.namprd16.prod.outlook.com
 (2603:10b6:4:15::11) To DM6PR12MB2682.namprd12.prod.outlook.com
 (2603:10b6:5:4a::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=brijesh.singh@amd.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [165.204.77.1]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: ca20a3f9-d0c2-4b76-8a92-08d6f5a98c04
x-ms-office365-filtering-ht: Tenant
x-microsoft-antispam: BCL:0;PCL:0;RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(4618075)(2017052603328)(7193020);SRVR:DM6PR12MB2842;
x-ms-traffictypediagnostic: DM6PR12MB2842:
x-microsoft-antispam-prvs: <DM6PR12MB28427C35359989E7B94F591AE5E40@DM6PR12MB2842.namprd12.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:1060;
x-forefront-prvs: 0074BBE012
x-forefront-antispam-report: SFV:NSPM;SFS:(10009020)(136003)(376002)(396003)(366004)(346002)(39860400002)(189003)(199004)(81166006)(81156014)(386003)(86362001)(256004)(486006)(476003)(50226002)(186003)(2616005)(4326008)(8936002)(25786009)(68736007)(14454004)(5660300002)(26005)(11346002)(66066001)(6666004)(64756008)(5640700003)(73956011)(3846002)(76176011)(66556008)(6512007)(66476007)(53936002)(66946007)(2351001)(446003)(6486002)(66446008)(478600001)(99286004)(71200400001)(305945005)(14444005)(7736002)(6506007)(102836004)(71190400001)(52116002)(6436002)(8676002)(36756003)(54906003)(316002)(2501003)(6916009)(2906002)(1076003)(6116002);DIR:OUT;SFP:1101;SCL:1;SRVR:DM6PR12MB2842;H:DM6PR12MB2682.namprd12.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;MX:1;A:1;
received-spf: None (protection.outlook.com: amd.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: GGS19TzrnYgbEMqhslEFHa/91qVCxKzmmdmmd73uRWMrdxEwaAlkS1dUc9harSMfRp90IPcrA+ERhyVt7NlhDeQKeXsdX7+J/bW19yj/9Jd2pgpKWeZnH/OmvvlKGm3VtPjgGWIU1WTRvejTvm7cZxuBfy4CNReIItA0c3jJCS4oCfArWguFXOCT+SvNAQyrNyFT3ncTL02LJpBYlVMZhygTgGbSh0Hkpu9eSix264Fej8yAsC8aQFrGVVCWFXX1V/chP3/Hn8KU+LkxjDnNq60C36POoZ5Y3JDhWzDxBN6GREeKi1FJ7p1fM3m5CKOe2mlF7CHJxn/1arSEEhK7laNsOHvEfBqbQmlEo4J4n/424dJLMVckUHXRERRuJ3QNAI+lq6Fzm++lzWTAy8/w5rFfexZbB4BLTfLBpP9g4Kc=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-Network-Message-Id: ca20a3f9-d0c2-4b76-8a92-08d6f5a98c04
X-MS-Exchange-CrossTenant-originalarrivaltime: 20 Jun 2019 18:03:06.9348
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: sbrijesh@amd.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR12MB2842
Sender: kvm-owner@vger.kernel.org
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

V2hlbiBtZW1vcnkgZW5jcnlwdGlvbiBpcyBlbmFibGVkIGluIFZNLCB0aGUgZ3Vlc3QgcGFnZXMg
d2lsbCBiZQ0KZW5jcnlwdGVkIHdpdGggdGhlIGd1ZXN0LXNwZWNpZmljIGtleSwgdG8gcHJvdGVj
dCB0aGUgY29uZmlkZW50aWFsaXR5DQpvZiBkYXRhIGluIHRyYW5zaXQuIFRvIHN1cHBvcnQgdGhl
IGxpdmUgbWlncmF0aW9uIHdlIG5lZWQgdG8gdXNlDQpwbGF0Zm9ybSBzcGVjaWZpYyBob29rcyB0
byBhY2Nlc3MgdGhlIGd1ZXN0IG1lbW9yeS4NCg0KVGhlIGt2bV9tZW1jcnlwdF9zYXZlX291dGdv
aW5nX3BhZ2UoKSBjYW4gYmUgdXNlZCBieSB0aGUgc2VuZGVyIHRvIHdyaXRlDQp0aGUgZW5jcnlw
dGVkIHBhZ2VzIGFuZCBtZXRhZGF0YSBhc3NvY2lhdGVkIHdpdGggaXQgb24gdGhlIHNvY2tldC4N
Cg0KVGhlIGt2bV9tZW1jcnlwdF9sb2FkX2luY29taW5nX3BhZ2UoKSBjYW4gYmUgdXNlZCBieSBy
ZWNlaXZlciB0byByZWFkIHRoZQ0KaW5jb21pbmcgZW5jcnlwdGVkIHBhZ2VzIGZyb20gdGhlIHNv
Y2tldCBhbmQgbG9hZCBpbnRvIHRoZSBndWVzdCBtZW1vcnkuDQoNCkVuY3J5cHRlZCBWTXMgaGF2
ZSBjb25jZXB0IG9mIHByaXZhdGUgYW5kIHNoYXJlZCBtZW1vcnkuIFRoZSBwcml2YXRlDQptZW1v
cnkgaXMgZW5jcnlwdGVkIHdpdGggdGhlIGd1ZXN0LXNwZWNpZmljIGtleSwgd2hpbGUgc2hhcmVk
IG1lbW9yeQ0KbWF5IGJlIGVuY3J5cHRlZCB3aXRoIGh5cGVyaXZvc3Iga2V5LiBUaGUgS1ZNX3tT
RVQsR0VUfV9QQUdFX0VOQ19CSVRNQVANCmlvY3RsIGNhbiBiZSB1c2VkIHRvIGdldC9zZXQgdGhl
IGJpdG1hcCBmcm9tL3RvIHRoZSBoeXBlcnZpc29yLg0KDQpUaGUga3ZtX21lbWNyeXB0X3N5bmNf
cGFnZV9lbmNfYml0bWFwKCkgY2FuIGJlIHVzZWQgYnkgdGhlIHNlbmRlciB0byBnZXQNCnRoZSBw
YWdlIGVuY3J5cHRpb24gYml0bWFwLiBUaGUgYml0bWFwIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIHRo
ZSBwYWdlIHN0YXRlDQoocHJpdmF0ZSBvciBzaGFyZWQpLg0KDQpUaGUga3ZtX21lbWNyeXB0X3Nl
bmRfb3V0Z29pbmdfcGFnZV9lbmNfYml0bWFwKCkgY2FuIGJlIHVzZWQgYnkgdGhlIHNlbmRlcg0K
dG8gd3JpdGUgdGhlIHBhZ2UgZW5jcnlwdGlvbiBiaXRtYXAgb24gdGhlIHNvY2tldC4NCg0KVGhl
IGt2bV9tZW1jcnlwdF9sb2FkX2luY29taW5nX3BhZ2VfZW5jX2JpdG1hcCgpIGNhbiBiZSB1c2Vk
IGJ5IHRoZQ0KcmVjZWl2ZXIgdG8gcmVhZCB0aGUgcGFnZSBlbmNyeXB0aW9uIGJpdG1hcCBmcm9t
IHRoZSBzb2NrZXQuDQoNClNpZ25lZC1vZmYtYnk6IEJyaWplc2ggU2luZ2ggPDxicmlqZXNoLnNp
bmdoQGFtZC5jb20+Pg0KLS0tDQogYWNjZWwva3ZtL2t2bS1hbGwuYyAgICB8IDY4ICsrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KIGFjY2VsL2t2bS9zZXYtc3R1Yi5j
ICAgfCAyOCArKysrKysrKysrKysrKysrKw0KIGFjY2VsL3N0dWJzL2t2bS1zdHViLmMgfCAzMCAr
KysrKysrKysrKysrKysrKysrDQogaW5jbHVkZS9zeXNlbXUva3ZtLmggICB8IDMzICsrKysrKysr
KysrKysrKysrKysrDQogaW5jbHVkZS9zeXNlbXUvc2V2LmggICB8ICA5ICsrKysrKw0KIDUgZmls
ZXMgY2hhbmdlZCwgMTY4IGluc2VydGlvbnMoKykNCg0KZGlmZiAtLWdpdCBhL2FjY2VsL2t2bS9r
dm0tYWxsLmMgYi9hY2NlbC9rdm0va3ZtLWFsbC5jDQppbmRleCBiMGM0YmVkNmUzLi40ZDVmZjhi
OWY1IDEwMDY0NA0KLS0tIGEvYWNjZWwva3ZtL2t2bS1hbGwuYw0KKysrIGIvYWNjZWwva3ZtL2t2
bS1hbGwuYw0KQEAgLTEwOSw2ICsxMDksMTUgQEAgc3RydWN0IEtWTVN0YXRlDQogICAgIC8qIG1l
bW9yeSBlbmNyeXB0aW9uICovDQogICAgIHZvaWQgKm1lbWNyeXB0X2hhbmRsZTsNCiAgICAgaW50
ICgqbWVtY3J5cHRfZW5jcnlwdF9kYXRhKSh2b2lkICpoYW5kbGUsIHVpbnQ4X3QgKnB0ciwgdWlu
dDY0X3QgbGVuKTsNCisgICAgaW50ICgqbWVtY3J5cHRfc2F2ZV9vdXRnb2luZ19wYWdlKSh2b2lk
ICplaGFuZGxlLCBRRU1VRmlsZSAqZiwNCisgICAgICAgICAgICB1aW50OF90ICpwdHIsIHVpbnQz
Ml90IHN6LCB1aW50NjRfdCAqYnl0ZXNfc2VudCk7DQorICAgIGludCAoKm1lbWNyeXB0X2xvYWRf
aW5jb21pbmdfcGFnZSkodm9pZCAqZWhhbmRsZSwgUUVNVUZpbGUgKmYsDQorICAgICAgICAgICAg
dWludDhfdCAqcHRyKTsNCisgICAgaW50ICgqbWVtY3J5cHRfbG9hZF9pbmNvbWluZ19wYWdlX2Vu
Y19iaXRtYXApKHZvaWQgKmVoYW5kbGUsIFFFTVVGaWxlICpmKTsNCisgICAgaW50ICgqbWVtY3J5
cHRfc2F2ZV9vdXRnb2luZ19wYWdlX2VuY19iaXRtYXApKHZvaWQgKmVoYW5kbGUsIFFFTVVGaWxl
ICpmLA0KKyAgICAgICAgICAgIHVpbnQ4X3QgKmhvc3QsIHVpbnQ2NF90IGxlbmd0aCwgdW5zaWdu
ZWQgbG9uZyAqYm1hcCk7DQorICAgIGludCAoKm1lbWNyeXB0X3N5bmNfcGFnZV9lbmNfYml0bWFw
KSh2b2lkICplaGFuZGxlLCB1aW50OF90ICpob3N0LA0KKyAgICAgICAgICAgIHVpbnQ2NF90IGxl
bmd0aCwgdW5zaWduZWQgbG9uZyAqYm1hcCk7DQogfTsNCiANCiBLVk1TdGF0ZSAqa3ZtX3N0YXRl
Ow0KQEAgLTE2NCw2ICsxNzMsNjUgQEAgaW50IGt2bV9tZW1jcnlwdF9lbmNyeXB0X2RhdGEodWlu
dDhfdCAqcHRyLCB1aW50NjRfdCBsZW4pDQogICAgIHJldHVybiAxOw0KIH0NCiANCitpbnQga3Zt
X21lbWNyeXB0X3NhdmVfb3V0Z29pbmdfcGFnZShRRU1VRmlsZSAqZiwgdWludDhfdCAqcHRyLA0K
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHNpemUsIHVpbnQ2
NF90ICpieXRlc19zZW50KQ0KK3sNCisgICAgaWYgKGt2bV9zdGF0ZS0+bWVtY3J5cHRfaGFuZGxl
ICYmDQorICAgICAgICBrdm1fc3RhdGUtPm1lbWNyeXB0X3NhdmVfb3V0Z29pbmdfcGFnZSkgew0K
KyAgICAgICAgcmV0dXJuIGt2bV9zdGF0ZS0+bWVtY3J5cHRfc2F2ZV9vdXRnb2luZ19wYWdlKGt2
bV9zdGF0ZS0+bWVtY3J5cHRfaGFuZGxlLA0KKyAgICAgICAgICAgICAgICAgICAgZiwgcHRyLCBz
aXplLCBieXRlc19zZW50KTsNCisgICAgfQ0KKw0KKyAgICByZXR1cm4gMTsNCit9DQorDQoraW50
IGt2bV9tZW1jcnlwdF9sb2FkX2luY29taW5nX3BhZ2UoUUVNVUZpbGUgKmYsIHVpbnQ4X3QgKnB0
cikNCit7DQorICAgIGlmIChrdm1fc3RhdGUtPm1lbWNyeXB0X2hhbmRsZSAmJg0KKyAgICAgICAg
a3ZtX3N0YXRlLT5tZW1jcnlwdF9sb2FkX2luY29taW5nX3BhZ2UpIHsNCisgICAgICAgIHJldHVy
biBrdm1fc3RhdGUtPm1lbWNyeXB0X2xvYWRfaW5jb21pbmdfcGFnZShrdm1fc3RhdGUtPm1lbWNy
eXB0X2hhbmRsZSwNCisgICAgICAgICAgICAgICAgICAgIGYsIHB0cik7DQorICAgIH0NCisNCisg
ICAgcmV0dXJuIDE7DQorfQ0KKw0KK2ludCBrdm1fbWVtY3J5cHRfbG9hZF9pbmNvbWluZ19wYWdl
X2VuY19iaXRtYXAoUUVNVUZpbGUgKmYpDQorew0KKyAgICBpZiAoa3ZtX3N0YXRlLT5tZW1jcnlw
dF9oYW5kbGUgJiYNCisgICAgICAgIGt2bV9zdGF0ZS0+bWVtY3J5cHRfbG9hZF9pbmNvbWluZ19w
YWdlX2VuY19iaXRtYXApIHsNCisgICAgICAgIHJldHVybiBrdm1fc3RhdGUtPm1lbWNyeXB0X2xv
YWRfaW5jb21pbmdfcGFnZV9lbmNfYml0bWFwKA0KKyAgICAgICAgICAgICAgICBrdm1fc3RhdGUt
Pm1lbWNyeXB0X2hhbmRsZSwgZik7DQorICAgIH0NCisNCisgICAgcmV0dXJuIDE7DQorfQ0KKw0K
K2ludCBrdm1fbWVtY3J5cHRfc2F2ZV9vdXRnb2luZ19wYWdlX2VuY19iaXRtYXAoUUVNVUZpbGUg
KmYsIHVpbnQ4X3QgKmhvc3QsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50NjRfdCBsZW5ndGgsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpibWFwKQ0KK3sNCisgICAgaWYgKGt2
bV9zdGF0ZS0+bWVtY3J5cHRfaGFuZGxlICYmDQorICAgICAgICBrdm1fc3RhdGUtPm1lbWNyeXB0
X3NhdmVfb3V0Z29pbmdfcGFnZV9lbmNfYml0bWFwKSB7DQorICAgICAgICByZXR1cm4ga3ZtX3N0
YXRlLT5tZW1jcnlwdF9zYXZlX291dGdvaW5nX3BhZ2VfZW5jX2JpdG1hcCgNCisgICAgICAgICAg
ICAgICAga3ZtX3N0YXRlLT5tZW1jcnlwdF9oYW5kbGUsIGYsIGhvc3QsIGxlbmd0aCwgYm1hcCk7
DQorICAgIH0NCisNCisgICAgcmV0dXJuIDE7DQorfQ0KKw0KK2ludCBrdm1fbWVtY3J5cHRfc3lu
Y19wYWdlX2VuY19iaXRtYXAodWludDhfdCAqaG9zdCwgdWludDY0X3QgbGVuZ3RoLA0KKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyAqYm1hcCkNCit7
DQorICAgIGlmIChrdm1fc3RhdGUtPm1lbWNyeXB0X2hhbmRsZSAmJg0KKyAgICAgICAga3ZtX3N0
YXRlLT5tZW1jcnlwdF9zeW5jX3BhZ2VfZW5jX2JpdG1hcCkgew0KKyAgICAgICAgcmV0dXJuIGt2
bV9zdGF0ZS0+bWVtY3J5cHRfc3luY19wYWdlX2VuY19iaXRtYXAoDQorICAgICAgICAgICAgICAg
IGt2bV9zdGF0ZS0+bWVtY3J5cHRfaGFuZGxlLCBob3N0LCBsZW5ndGgsIGJtYXApOw0KKyAgICB9
DQorDQorICAgIHJldHVybiAxOw0KK30NCisNCiBzdGF0aWMgS1ZNU2xvdCAqa3ZtX2dldF9mcmVl
X3Nsb3QoS1ZNTWVtb3J5TGlzdGVuZXIgKmttbCkNCiB7DQogICAgIEtWTVN0YXRlICpzID0ga3Zt
X3N0YXRlOw0KZGlmZiAtLWdpdCBhL2FjY2VsL2t2bS9zZXYtc3R1Yi5jIGIvYWNjZWwva3ZtL3Nl
di1zdHViLmMNCmluZGV4IDRmOTc0NTI1ODUuLjVkOGMzZjJlY2QgMTAwNjQ0DQotLS0gYS9hY2Nl
bC9rdm0vc2V2LXN0dWIuYw0KKysrIGIvYWNjZWwva3ZtL3Nldi1zdHViLmMNCkBAIC0yNCwzICsy
NCwzMSBAQCB2b2lkICpzZXZfZ3Vlc3RfaW5pdChjb25zdCBjaGFyICppZCkNCiB7DQogICAgIHJl
dHVybiBOVUxMOw0KIH0NCisNCitpbnQgc2V2X3NhdmVfb3V0Z29pbmdfcGFnZSh2b2lkICpoYW5k
bGUsIFFFTVVGaWxlICpmLCB1aW50OF90ICpwdHIsDQorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDMyX3Qgc2l6ZSwgdWludDY0X3QgKmJ5dGVzX3NlbnQpDQorew0KKyAgICByZXR1cm4g
MTsNCit9DQorDQoraW50IHNldl9sb2FkX2luY29taW5nX3BhZ2Uodm9pZCAqaGFuZGxlLCBRRU1V
RmlsZSAqZiwgdWludDhfdCAqcHRyKQ0KK3sNCisgICAgcmV0dXJuIDE7DQorfQ0KKw0KK2ludCBz
ZXZfbG9hZF9pbmNvbWluZ19wYWdlX2VuY19iaXRtYXAodm9pZCAqaGFuZGxlLCBRRU1VRmlsZSAq
ZikNCit7DQorICAgIHJldHVybiAxOw0KK30NCisNCitpbnQgc2V2X3NhdmVfb3V0Z29pbmdfcGFn
ZV9lbmNfYml0bWFwKHZvaWQgKmhhbmRsZSwgUUVNVUZpbGUgKmYsDQorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpibWFwKQ0KK3sNCisgICAgcmV0
dXJuIDE7DQorfQ0KKw0KK2ludCBzZXZfc3luY19wYWdlX2VuY19iaXRtYXAodm9pZCAqaGFuZGxl
LCB1aW50OF90ICpob3N0LCB1aW50NjRfdCBzaXplLA0KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyAqYml0bWFwKQ0KK3sNCisgICAgcmV0dXJuIDE7DQorfQ0KZGlm
ZiAtLWdpdCBhL2FjY2VsL3N0dWJzL2t2bS1zdHViLmMgYi9hY2NlbC9zdHVicy9rdm0tc3R1Yi5j
DQppbmRleCA2ZmViNjZlZDgwLi5iZWY3Mzc2OTg1IDEwMDY0NA0KLS0tIGEvYWNjZWwvc3R1YnMv
a3ZtLXN0dWIuYw0KKysrIGIvYWNjZWwvc3R1YnMva3ZtLXN0dWIuYw0KQEAgLTExNCw2ICsxMTQs
MzYgQEAgaW50IGt2bV9tZW1jcnlwdF9lbmNyeXB0X2RhdGEodWludDhfdCAqcHRyLCB1aW50NjRf
dCBsZW4pDQogICByZXR1cm4gMTsNCiB9DQogDQoraW50IGt2bV9tZW1jcnlwdF9zYXZlX291dGdv
aW5nX3BhZ2UoUUVNVUZpbGUgKmYsIHVpbnQ4X3QgKnB0ciwNCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCBzaXplLCB1aW50NjRfdCAqYnl0ZXNfc2VudCkNCit7
DQorICAgIHJldHVybiAxOw0KK30NCisNCitpbnQga3ZtX21lbWNyeXB0X2xvYWRfaW5jb21pbmdf
cGFnZShRRU1VRmlsZSAqZiwgdWludDhfdCAqcHRyKQ0KK3sNCisgICAgcmV0dXJuIDE7DQorfQ0K
Kw0KK2ludCBrdm1fbWVtY3J5cHRfbG9hZF9pbmNvbWluZ19wYWdlX2VuY19iaXRtYXAoUUVNVUZp
bGUgKmYpDQorew0KKyAgICByZXR1cm4gMTsNCit9DQorDQoraW50IGt2bV9tZW1jcnlwdF9zYXZl
X291dGdvaW5nX3BhZ2VfZW5jX2JpdG1hcChRRU1VRmlsZSAqZiwgdWludDhfdCAqaG9zdCwNCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IGxl
bmd0aCwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGxvbmcgKmJtYXApDQorew0KKyAgICByZXR1cm4gMTsNCit9DQorDQoraW50IGt2bV9t
ZW1jcnlwdF9zeW5jX3BhZ2VfZW5jX2JpdG1hcCh1aW50OF90ICpob3N0LCB1aW50NjRfdCBzaXpl
LA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyAq
Yml0bWFwKQ0KK3sNCisgICAgcmV0dXJuIDE7DQorfQ0KKw0KKw0KICNpZm5kZWYgQ09ORklHX1VT
RVJfT05MWQ0KIGludCBrdm1faXJxY2hpcF9hZGRfbXNpX3JvdXRlKEtWTVN0YXRlICpzLCBpbnQg
dmVjdG9yLCBQQ0lEZXZpY2UgKmRldikNCiB7DQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9zeXNlbXUv
a3ZtLmggYi9pbmNsdWRlL3N5c2VtdS9rdm0uaA0KaW5kZXggYTZkMWNkMTkwZi4uZjg1YTYwZTQx
MSAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvc3lzZW11L2t2bS5oDQorKysgYi9pbmNsdWRlL3N5c2Vt
dS9rdm0uaA0KQEAgLTI0Niw2ICsyNDYsMzkgQEAgYm9vbCBrdm1fbWVtY3J5cHRfZW5hYmxlZCh2
b2lkKTsNCiAgKi8NCiBpbnQga3ZtX21lbWNyeXB0X2VuY3J5cHRfZGF0YSh1aW50OF90ICpwdHIs
IHVpbnQ2NF90IGxlbik7DQogDQorLyoqDQorICoga3ZtX21lbWNyeXB0X3NhdmVfb3V0Z29pbmdf
YnVmZmVyIC0gZW5jcnlwdCB0aGUgb3V0Z29pbmcgYnVmZmVyDQorICogYW5kIHdyaXRlIHRvIHRo
ZSB3aXJlLg0KKyAqLw0KK2ludCBrdm1fbWVtY3J5cHRfc2F2ZV9vdXRnb2luZ19wYWdlKFFFTVVG
aWxlICpmLCB1aW50OF90ICpwdHIsIHVpbnQzMl90IHNpemUsDQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDY0X3QgKmJ5dGVzX3NlbnQpOw0KKw0KKy8qKg0KKyAqIGt2
bV9tZW1jcnlwdF9sb2FkX2luY29taW5nX2J1ZmZlciAtIHJlYWQgdGhlIGVuY3J5cHQgaW5jb21p
bmcgYnVmZmVyIGFuZCBjb3B5DQorICogdGhlIGJ1ZmZlciBpbnRvIHRoZSBndWVzdCBtZW1vcnkg
c3BhY2UuDQorICovDQoraW50IGt2bV9tZW1jcnlwdF9sb2FkX2luY29taW5nX3BhZ2UoUUVNVUZp
bGUgKmYsIHVpbnQ4X3QgKnB0cik7DQorDQorLyoqDQorICoga3ZtX21lbWNyeXB0X2xvYWRfaW5j
b21pbmdfcGFnZV9lbmNfYml0bWFwOiByZWFkIHRoZSBwYWdlIGVuY3J5cHRpb24gYml0bWFwDQor
ICogZnJvbSB0aGUgc29ja2V0IGFuZCBwYXNzIGl0IHRvIHRoZSBoeXBlcnZpc29yLg0KKyAqLw0K
K2ludCBrdm1fbWVtY3J5cHRfbG9hZF9pbmNvbWluZ19wYWdlX2VuY19iaXRtYXAoUUVNVUZpbGUg
KmYpOw0KKw0KKy8qKg0KKyAqIGt2bV9tZW1jcnlwdF9zeW5jX3BhZ2VfZW5jX2JpdG1hcDogc3lu
YyB0aGUgcGFnZSBlbmNyeXB0aW9uIGJpdG1hcA0KKyAqIFRoZSBjYWxsZXIgaXMgcmVzcG9uc2li
bGUgdG8gYWxsb2NhdGUvZnJlZSB0aGUgYml0bWFwLg0KKyAqLw0KK2ludCBrdm1fbWVtY3J5cHRf
c3luY19wYWdlX2VuY19iaXRtYXAodWludDhfdCAqaG9zdCwgdWludDY0X3Qgc2l6ZSwNCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgKmJpdG1hcCk7
DQorDQorLyoqDQorICoga3ZtX21lbWNyeXB0X3NhdmVfb3V0Z29pbmdfcGFnZV9lbmNfYml0bWFw
OiB3cml0ZSB0aGUgcGFnZSBlbmNyeXB0aW9uIGJpdG1hcA0KKyAqIG9uIHNvY2tldC4NCisgKi8N
CitpbnQga3ZtX21lbWNyeXB0X3NhdmVfb3V0Z29pbmdfcGFnZV9lbmNfYml0bWFwKFFFTVVGaWxl
ICpmLCB1aW50OF90ICpob3N0LA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDY0X3QgbGVuZ3RoLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyAqYm1hcCk7DQogDQogI2lmZGVmIE5F
RURfQ1BVX0gNCiAjaW5jbHVkZSAiY3B1LmgiDQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9zeXNlbXUv
c2V2LmggYi9pbmNsdWRlL3N5c2VtdS9zZXYuaA0KaW5kZXggOThjMWVjOGQzOC4uMDA5YmU0NTIz
MCAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvc3lzZW11L3Nldi5oDQorKysgYi9pbmNsdWRlL3N5c2Vt
dS9zZXYuaA0KQEAgLTE4LDQgKzE4LDEzIEBADQogDQogdm9pZCAqc2V2X2d1ZXN0X2luaXQoY29u
c3QgY2hhciAqaWQpOw0KIGludCBzZXZfZW5jcnlwdF9kYXRhKHZvaWQgKmhhbmRsZSwgdWludDhf
dCAqcHRyLCB1aW50NjRfdCBsZW4pOw0KK2ludCBzZXZfc2F2ZV9vdXRnb2luZ19wYWdlKHZvaWQg
KmhhbmRsZSwgUUVNVUZpbGUgKmYsIHVpbnQ4X3QgKnB0ciwNCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1aW50MzJfdCBzaXplLCB1aW50NjRfdCAqYnl0ZXNfc2VudCk7DQoraW50IHNldl9s
b2FkX2luY29taW5nX3BhZ2Uodm9pZCAqaGFuZGxlLCBRRU1VRmlsZSAqZiwgdWludDhfdCAqcHRy
KTsNCitpbnQgc2V2X2xvYWRfaW5jb21pbmdfcGFnZV9lbmNfYml0bWFwKHZvaWQgKmhhbmRsZSwg
UUVNVUZpbGUgKmYpOw0KK2ludCBzZXZfc2F2ZV9vdXRnb2luZ19wYWdlX2VuY19iaXRtYXAodm9p
ZCAqaGFuZGxlLCBRRU1VRmlsZSAqZiwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQ4X3QgKmhvc3QsIHVpbnQ2NF90IGxlbmd0aCwNCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgKmJtYXApOw0KK2ludCBzZXZfc3lu
Y19wYWdlX2VuY19iaXRtYXAodm9pZCAqaGFuZGxlLCB1aW50OF90ICpob3N0LCB1aW50NjRfdCBz
aXplLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyAqYml0bWFw
KTsNCiAjZW5kaWYNCi0tIA0KMi4xNy4xDQoNCg==
