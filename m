Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 554426C736D
	for <lists+kvm@lfdr.de>; Thu, 23 Mar 2023 23:55:32 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S231764AbjCWWza (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Thu, 23 Mar 2023 18:55:30 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:47594 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S231741AbjCWWzG (ORCPT <rfc822;kvm@vger.kernel.org>);
        Thu, 23 Mar 2023 18:55:06 -0400
Received: from dfw.source.kernel.org (dfw.source.kernel.org [IPv6:2604:1380:4641:c500::1])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 4207E2CC6E
        for <kvm@vger.kernel.org>; Thu, 23 Mar 2023 15:54:40 -0700 (PDT)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by dfw.source.kernel.org (Postfix) with ESMTPS id 8CAE7628E4
        for <kvm@vger.kernel.org>; Thu, 23 Mar 2023 22:54:39 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id E5C39C433EF;
        Thu, 23 Mar 2023 22:54:38 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1679612078;
        bh=cbMmCXO43gWzyStKL6HvJPBq0R++kwZ+mtlFbjaW6NE=;
        h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
        b=EIgxY6MZm1TsbcXXF1HBfq8giqPf3KXRR45/z1D9ECDRSln/unWya98mMe2WJQen/
         7dTngmdtIA7uPdHT5pqKykay1hNq9T5LiFXrQkTvsZSu0FTlZVHJXF/Zdx/WnihWeu
         GSyOsYUkpotFCny45Ug+Jvsq8Pfa0Yr4hfUJq/edSBM9y+rP2Yt/tIQN/0prmRBHeY
         DfDhJBvUSNHOGc6YJGE8VGewyLGYVTrjuzxPzPKPewOjCE0J6+x214ppddRWN7jahy
         1QJGgAzJ7LIUAUNygJ0/9K1Ny+bG1AGeoE+F+eNQRhu4UKa28BFFRWHMWzaHKKCwrB
         R1a9eCDdu27ag==
Received: from sofa.misterjones.org ([185.219.108.64] helo=goblin-girl.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.95)
        (envelope-from <maz@kernel.org>)
        id 1pfTpM-002fZ0-HB;
        Thu, 23 Mar 2023 22:54:36 +0000
Date:   Thu, 23 Mar 2023 22:54:36 +0000
Message-ID: <864jqbxemr.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Colton Lewis <coltonlewis@google.com>
Cc:     kvmarm@lists.linux.dev, kvm@vger.kernel.org,
        linux-arm-kernel@lists.infradead.org, james.morse@arm.com,
        suzuki.poulose@arm.com, oliver.upton@linux.dev,
        yuzenghui@huawei.com, ricarkol@google.com, sveith@amazon.de,
        reijiw@google.com, joey.gouly@arm.com, dwmw2@infradead.org
Subject: Re: [PATCH v2 00/19] KVM: arm64: Rework timer offsetting for fun and profit
In-Reply-To: <gsntbkkjcdqu.fsf@coltonlewis-kvm.c.googlers.com>
References: <20230313124837.2264882-1-maz@kernel.org>
        <gsntbkkjcdqu.fsf@coltonlewis-kvm.c.googlers.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/28.2
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: coltonlewis@google.com, kvmarm@lists.linux.dev, kvm@vger.kernel.org, linux-arm-kernel@lists.infradead.org, james.morse@arm.com, suzuki.poulose@arm.com, oliver.upton@linux.dev, yuzenghui@huawei.com, ricarkol@google.com, sveith@amazon.de, reijiw@google.com, joey.gouly@arm.com, dwmw2@infradead.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-Spam-Status: No, score=-2.5 required=5.0 tests=DKIMWL_WL_HIGH,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_MED,SPF_HELO_NONE,
        SPF_PASS autolearn=unavailable autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

On Thu, 23 Mar 2023 22:19:21 +0000,
Colton Lewis <coltonlewis@google.com> wrote:
> 
> Hello Marc,
> 
> I had thought I sent this earlier but our conversation today made me
> aware I hadn't.
> 
> Marc Zyngier <maz@kernel.org> writes:
> 
> > way. Colton reported some other issues with this test, but I cannot
> > reproduce them here, making me think this might be related to CNTPOFF
> > (but again, I don't have such HW at hand).
> 
> I can no longer reproduce any issues on any platform with this version.

That's an interesting outcome. I haven't quite worked out what makes
it fail or fixes it, unless this is related to the fix I have for the
test itself.

> Two minor comments:
> 
> - I'm not sure you ever addressed my comment from v1 asking if you
>   should add CNTPOFF_EL2 to vcpu_sysreg in
>   arch/arm64/include/asm/kvm_host.h

I don't think it makes much sense until the NV patches support ECV,
which we do not expose to the guest at the moment. For the time
being, we present to the guest something that is more or less an
ARMv8.1 implementation. Once these patches are in, we will be able to
look at adding more features.

> 
> - You left the capital O flag in your selftest changes even though it is
>   no longer used.

Ah, in the getopt() call! Well spotted. I'll fix that now.

> Otherwise,
> 
> Reviewed-by: Colton Lewis <coltonlewis@google.com>

Thanks!

	M.

-- 
Without deviation from the norm, progress is not possible.
