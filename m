Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 2C59E4DAD83
	for <lists+kvm@lfdr.de>; Wed, 16 Mar 2022 10:29:57 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1346468AbiCPJbI (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Wed, 16 Mar 2022 05:31:08 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:42462 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1354862AbiCPJbH (ORCPT <rfc822;kvm@vger.kernel.org>);
        Wed, 16 Mar 2022 05:31:07 -0400
Received: from ams.source.kernel.org (ams.source.kernel.org [IPv6:2604:1380:4601:e00::1])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id CCD966542D
        for <kvm@vger.kernel.org>; Wed, 16 Mar 2022 02:29:53 -0700 (PDT)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by ams.source.kernel.org (Postfix) with ESMTPS id 7775DB818CC
        for <kvm@vger.kernel.org>; Wed, 16 Mar 2022 09:29:52 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 2AD7BC340E9;
        Wed, 16 Mar 2022 09:29:51 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1647422991;
        bh=1vXKNeCRC0cZGyzI8jX4TQSJODbg9VTgs4jqJgQbSUw=;
        h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
        b=Pi7GoBFZUcF+3h4BPp8qEYOXeUt3hwT7/nE5DtGw5/a+uYrcM9mg2JX85TXVobBLm
         NZO374EHJYqz+ciqQaJ5F16mcwxz89SIQyA/HmDxHcoNO88CSKdpoxOgCVdn8LU5DT
         pVXcUBCVQfP4PYfjA8nPM3WLF+0wy/WzogrTAOokDHUKF21xNaFroIrtM7J/GGILp7
         TV+WlrOk01GTpwzQRn4wp+hJwc/p7YbIRexWBDuoQ7otWVuFgbm01NCs5EmLP3wOi6
         xJBG/9CXRjj0MVthDfTo4gSs0iGW70v3fVZVG6hJdBN9S2+yLovgfxE4TOl1Pil17X
         ChIRGHw+mXrYA==
Received: from sofa.misterjones.org ([185.219.108.64] helo=why.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.94.2)
        (envelope-from <maz@kernel.org>)
        id 1nUPyW-00EsOD-JP; Wed, 16 Mar 2022 09:29:49 +0000
Date:   Wed, 16 Mar 2022 09:29:48 +0000
Message-ID: <87czimz1mb.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Oliver Upton <oupton@google.com>
Cc:     linux-arm-kernel@lists.infradead.org, kvm@vger.kernel.org,
        kvmarm@lists.cs.columbia.edu, kernel-team@android.com,
        Andre Przywara <andre.przywara@arm.com>
Subject: Re: [PATCH 1/4] irqchip/gic-v3: Exposes bit values for GICR_CTLR.{IR, CES}
In-Reply-To: <YjEeNThfYFtTffWz@google.com>
References: <20220314164044.772709-1-maz@kernel.org>
        <20220314164044.772709-2-maz@kernel.org>
        <YjEeNThfYFtTffWz@google.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: oupton@google.com, linux-arm-kernel@lists.infradead.org, kvm@vger.kernel.org, kvmarm@lists.cs.columbia.edu, kernel-team@android.com, andre.przywara@arm.com
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-Spam-Status: No, score=-8.6 required=5.0 tests=BAYES_00,DKIMWL_WL_HIGH,
        DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_HI,
        SPF_HELO_NONE,SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

On Tue, 15 Mar 2022 23:16:05 +0000,
Oliver Upton <oupton@google.com> wrote:
> 
> Hi Marc,
> 
> On Mon, Mar 14, 2022 at 04:40:41PM +0000, Marc Zyngier wrote:
> > As we're about to expose GICR_CTLR.{IR,CES} to guests, populate
> > the include file with the architectural values.
> > 
> > Signed-off-by: Marc Zyngier <maz@kernel.org>
> > ---
> >  include/linux/irqchip/arm-gic-v3.h | 2 ++
> >  1 file changed, 2 insertions(+)
> > 
> > diff --git a/include/linux/irqchip/arm-gic-v3.h b/include/linux/irqchip/arm-gic-v3.h
> > index 12d91f0dedf9..aeb8ced53880 100644
> > --- a/include/linux/irqchip/arm-gic-v3.h
> > +++ b/include/linux/irqchip/arm-gic-v3.h
> > @@ -127,6 +127,8 @@
> >  #define GICR_PIDR2			GICD_PIDR2
> >  
> >  #define GICR_CTLR_ENABLE_LPIS		(1UL << 0)
> > +#define GICR_CTLR_IR			(1UL << 1)
> > +#define GICR_CTLR_CES			(1UL << 2)
> 
> I think these are backwards (IR is bit 2)

How embarrassing... The whole thing only works because we always
advertise the two bits together, and that the GIC driver has the same
bug. Fortunately, I'm running low on paper bags... ;-)

I'll push a fix for that shortly.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.
