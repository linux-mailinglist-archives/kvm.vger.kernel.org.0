Return-Path: <kvm-owner@vger.kernel.org>
X-Original-To: lists+kvm@lfdr.de
Delivered-To: lists+kvm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id ED4784170F7
	for <lists+kvm@lfdr.de>; Fri, 24 Sep 2021 13:38:37 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S244439AbhIXLkJ (ORCPT <rfc822;lists+kvm@lfdr.de>);
        Fri, 24 Sep 2021 07:40:09 -0400
Received: from smtp-fw-6002.amazon.com ([52.95.49.90]:36662 "EHLO
        smtp-fw-6002.amazon.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S244420AbhIXLkI (ORCPT <rfc822;kvm@vger.kernel.org>);
        Fri, 24 Sep 2021 07:40:08 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
  d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
  t=1632483516; x=1664019516;
  h=from:to:cc:subject:date:message-id:mime-version:
   content-transfer-encoding;
  bh=k8lrQhW+f2fKlPGpjOYRi6saRxFAaYxHeLfLaybOflg=;
  b=AgNK8me5/554AiP+6WE+QzJzwecsLnfAIdc1Pj9qCNGDfyTJtEWnKXuM
   ykrBCS1gsy5dNuq85o+1xc2rXy9GQDe7cOh6NArc3HxeUhdAI7OviBszW
   V+N0h5YjSyHi23G99Ld0s32IaI35Psm/g16TqXYdLynhwEWmhb19GmI0N
   o=;
X-IronPort-AV: E=Sophos;i="5.85,319,1624320000"; 
   d="scan'208";a="142918955"
Received: from iad12-co-svc-p1-lb1-vlan2.amazon.com (HELO email-inbound-relay-pdx-2c-b09ea7fa.us-west-2.amazon.com) ([10.43.8.2])
  by smtp-border-fw-6002.iad6.amazon.com with ESMTP; 24 Sep 2021 11:38:27 +0000
Received: from EX13MTAUWC001.ant.amazon.com (pdx1-ws-svc-p6-lb9-vlan2.pdx.amazon.com [10.236.137.194])
        by email-inbound-relay-pdx-2c-b09ea7fa.us-west-2.amazon.com (Postfix) with ESMTPS id 9146E41B93;
        Fri, 24 Sep 2021 11:38:25 +0000 (UTC)
Received: from EX13D20UWC001.ant.amazon.com (10.43.162.244) by
 EX13MTAUWC001.ant.amazon.com (10.43.162.135) with Microsoft SMTP Server (TLS)
 id 15.0.1497.23; Fri, 24 Sep 2021 11:38:24 +0000
Received: from u79c5a0a55de558.ant.amazon.com (10.43.162.186) by
 EX13D20UWC001.ant.amazon.com (10.43.162.244) with Microsoft SMTP Server (TLS)
 id 15.0.1497.23; Fri, 24 Sep 2021 11:38:22 +0000
From:   Alexander Graf <graf@amazon.com>
To:     <kvm@vger.kernel.org>
CC:     Paolo Bonzini <pbonzini@redhat.com>,
        Daniele Ahmed <ahmeddan@amazon.com>,
        Thomas Huth <thuth@redhat.com>,
        Sean Christopherson <sean.j.christopherson@intel.com>,
        Andrew Jones <drjones@redhat.com>,
        "Vitaly Kuznetsov" <vkuznets@redhat.com>
Subject: [PATCH v3] scripts: Add get_maintainer.pl
Date:   Fri, 24 Sep 2021 13:38:14 +0200
Message-ID: <20210924113814.12831-1-graf@amazon.com>
X-Mailer: git-send-email 2.28.0.394.ge197136389
MIME-Version: 1.0
X-Originating-IP: [10.43.162.186]
X-ClientProxiedBy: EX13D35UWC001.ant.amazon.com (10.43.162.197) To
 EX13D20UWC001.ant.amazon.com (10.43.162.244)
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Precedence: bulk
List-ID: <kvm.vger.kernel.org>
X-Mailing-List: kvm@vger.kernel.org

V2hpbGUgd2UgYWRvcHRlZCB0aGUgTUFJTlRBSU5FUlMgZmlsZSBpbiBrdm0tdW5pdC10ZXN0cywg
dGhlIHRvb2wgdG8KZGV0ZXJtaW5lIHdobyB0byBDQyBvbiBwYXRjaCBzdWJtaXNzaW9ucyBpcyBz
dGlsbCBtaXNzaW5nLgoKQ29weSBMaW51eCdzIHZlcnNpb24gZnJvbSB2NS4xNS1yYzIgKGU0ZTcz
N2JiNWMxNzBkZikgb3ZlciBhbmQgYWRqdXN0IGl0CnRvIHdvcmsgd2l0aCBhbmQgY2FsbCBvdXQg
dGhlIGt2bS11bml0LXRlc3RzIHRyZWUuCgpTaWduZWQtb2ZmLWJ5OiBBbGV4YW5kZXIgR3JhZiA8
Z3JhZkBhbWF6b24uY29tPgpBY2tlZC1ieTogQW5kcmV3IEpvbmVzIDxkcmpvbmVzQHJlZGhhdC5j
b20+ClRlc3RlZC1ieTogRGFuaWVsZSBBaG1lZCA8YWhtZWRkYW5AYW1hem9uLmNvbT4KCi0tLQoK
djEgLT4gdjI6CgogIC0gUmVtb3ZlIFBlbmdpdW4gQ2hpZWYgbG9naWMKCnYyIC0+IHYzOgoKICAt
IEFkZCByZWZlcmVuY2UgdG8gc291cmNlIGdpdCBoYXNoCi0tLQogc2NyaXB0cy9nZXRfbWFpbnRh
aW5lci5wbCB8IDI1NDMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogMSBm
aWxlIGNoYW5nZWQsIDI1NDMgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNzU1IHNjcmlw
dHMvZ2V0X21haW50YWluZXIucGwKCmRpZmYgLS1naXQgYS9zY3JpcHRzL2dldF9tYWludGFpbmVy
LnBsIGIvc2NyaXB0cy9nZXRfbWFpbnRhaW5lci5wbApuZXcgZmlsZSBtb2RlIDEwMDc1NQppbmRl
eCAwMDAwMDAwLi4xMTdiNjkxCi0tLSAvZGV2L251bGwKKysrIGIvc2NyaXB0cy9nZXRfbWFpbnRh
aW5lci5wbApAQCAtMCwwICsxLDI1NDMgQEAKKyMhL3Vzci9iaW4vZW52IHBlcmwKKyMgU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKyMKKyMgKGMpIDIwMDcsIEpvZSBQZXJjaGVzIDxq
b2VAcGVyY2hlcy5jb20+CisjICAgICAgICAgICBjcmVhdGVkIGZyb20gY2hlY2twYXRjaC5wbAor
IworIyBQcmludCBzZWxlY3RlZCBNQUlOVEFJTkVSUyBpbmZvcm1hdGlvbiBmb3IKKyMgdGhlIGZp
bGVzIG1vZGlmaWVkIGluIGEgcGF0Y2ggb3IgZm9yIGEgZmlsZQorIworIyB1c2FnZTogcGVybCBz
Y3JpcHRzL2dldF9tYWludGFpbmVyLnBsIFtPUFRJT05TXSA8cGF0Y2g+CisjICAgICAgICBwZXJs
IHNjcmlwdHMvZ2V0X21haW50YWluZXIucGwgW09QVElPTlNdIC1mIDxmaWxlPgorCit1c2Ugd2Fy
bmluZ3M7Cit1c2Ugc3RyaWN0OworCitteSAkUCA9ICQwOworbXkgJFYgPSAnMC4yNic7CisKK3Vz
ZSBHZXRvcHQ6OkxvbmcgcXcoOmNvbmZpZyBub19hdXRvX2FiYnJldik7Cit1c2UgQ3dkOwordXNl
IEZpbGU6OkZpbmQ7Cit1c2UgRmlsZTo6U3BlYzo6RnVuY3Rpb25zOworCitteSAkY3VyX3BhdGgg
PSBmYXN0Z2V0Y3dkKCkgLiAnLyc7CitteSAkbGtfcGF0aCA9ICIuLyI7CitteSAkZW1haWwgPSAx
OworbXkgJGVtYWlsX3VzZW5hbWUgPSAxOworbXkgJGVtYWlsX21haW50YWluZXIgPSAxOworbXkg
JGVtYWlsX3Jldmlld2VyID0gMTsKK215ICRlbWFpbF9maXhlcyA9IDE7CitteSAkZW1haWxfbGlz
dCA9IDE7CitteSAkZW1haWxfbW9kZXJhdGVkX2xpc3QgPSAxOworbXkgJGVtYWlsX3N1YnNjcmli
ZXJfbGlzdCA9IDA7CitteSAkZW1haWxfZ2l0ID0gMDsKK215ICRlbWFpbF9naXRfYWxsX3NpZ25h
dHVyZV90eXBlcyA9IDA7CitteSAkZW1haWxfZ2l0X2JsYW1lID0gMDsKK215ICRlbWFpbF9naXRf
YmxhbWVfc2lnbmF0dXJlcyA9IDE7CitteSAkZW1haWxfZ2l0X2ZhbGxiYWNrID0gMTsKK215ICRl
bWFpbF9naXRfbWluX3NpZ25hdHVyZXMgPSAxOworbXkgJGVtYWlsX2dpdF9tYXhfbWFpbnRhaW5l
cnMgPSA1OworbXkgJGVtYWlsX2dpdF9taW5fcGVyY2VudCA9IDU7CitteSAkZW1haWxfZ2l0X3Np
bmNlID0gIjEteWVhci1hZ28iOworbXkgJGVtYWlsX2hnX3NpbmNlID0gIi0zNjUiOworbXkgJGlu
dGVyYWN0aXZlID0gMDsKK215ICRlbWFpbF9yZW1vdmVfZHVwbGljYXRlcyA9IDE7CitteSAkZW1h
aWxfdXNlX21haWxtYXAgPSAxOworbXkgJG91dHB1dF9tdWx0aWxpbmUgPSAxOworbXkgJG91dHB1
dF9zZXBhcmF0b3IgPSAiLCAiOworbXkgJG91dHB1dF9yb2xlcyA9IDA7CitteSAkb3V0cHV0X3Jv
bGVzdGF0cyA9IDE7CitteSAkb3V0cHV0X3NlY3Rpb25fbWF4bGVuID0gNTA7CitteSAkc2NtID0g
MDsKK215ICR0cmVlID0gMTsKK215ICR3ZWIgPSAwOworbXkgJHN1YnN5c3RlbSA9IDA7CitteSAk
c3RhdHVzID0gMDsKK215ICRsZXR0ZXJzID0gIiI7CitteSAka2V5d29yZHMgPSAxOworbXkgJHNl
Y3Rpb25zID0gMDsKK215ICRlbWFpbF9maWxlX2VtYWlscyA9IDA7CitteSAkZnJvbV9maWxlbmFt
ZSA9IDA7CitteSAkcGF0dGVybl9kZXB0aCA9IDA7CitteSAkc2VsZl90ZXN0ID0gdW5kZWY7Citt
eSAkdmVyc2lvbiA9IDA7CitteSAkaGVscCA9IDA7CitteSAkZmluZF9tYWludGFpbmVyX2ZpbGVz
ID0gMDsKK215ICRtYWludGFpbmVyX3BhdGg7CitteSAkdmNzX3VzZWQgPSAwOworCitteSAkZXhp
dCA9IDA7CisKK215IEBmaWxlcyA9ICgpOworbXkgQGZpeGVzID0gKCk7CQkJIyBJZiBhIHBhdGNo
IGRlc2NyaXB0aW9uIGluY2x1ZGVzIEZpeGVzOiBsaW5lcworbXkgQHJhbmdlID0gKCk7CitteSBA
a2V5d29yZF90dmkgPSAoKTsKK215IEBmaWxlX2VtYWlscyA9ICgpOworCitteSAlY29tbWl0X2F1
dGhvcl9oYXNoOworbXkgJWNvbW1pdF9zaWduZXJfaGFzaDsKKworIyBTaWduYXR1cmUgdHlwZXMg
b2YgcGVvcGxlIHdobyBhcmUgZWl0aGVyCisjIAlhKSByZXNwb25zaWJsZSBmb3IgdGhlIGNvZGUg
aW4gcXVlc3Rpb24sIG9yCisjIAliKSBmYW1pbGlhciBlbm91Z2ggd2l0aCBpdCB0byBnaXZlIHJl
bGV2YW50IGZlZWRiYWNrCitteSBAc2lnbmF0dXJlX3RhZ3MgPSAoKTsKK3B1c2goQHNpZ25hdHVy
ZV90YWdzLCAiU2lnbmVkLW9mZi1ieToiKTsKK3B1c2goQHNpZ25hdHVyZV90YWdzLCAiUmV2aWV3
ZWQtYnk6Iik7CitwdXNoKEBzaWduYXR1cmVfdGFncywgIkFja2VkLWJ5OiIpOworCitteSAkc2ln
bmF0dXJlX3BhdHRlcm4gPSAiXCgiIC4gam9pbigifCIsIEBzaWduYXR1cmVfdGFncykgLiAiXCki
OworCisjIHJmYzgyMiBlbWFpbCBhZGRyZXNzIC0gcHJlbG9hZGVkIG1ldGhvZHMgZ28gaGVyZS4K
K215ICRyZmM4MjJfbHdzcCA9ICIoPzooPzpcXHJcXG4pP1sgXFx0XSkiOworbXkgJHJmYzgyMl9j
aGFyID0gJ1tcXDAwMC1cXDM3N10nOworCisjIFZDUyBjb21tYW5kIHN1cHBvcnQ6IGNsYXNzLWxp
a2UgZnVuY3Rpb25zIGFuZCBzdHJpbmdzCisKK215ICVWQ1NfY21kczsKKworbXkgJVZDU19jbWRz
X2dpdCA9ICgKKyAgICAiZXhlY3V0ZV9jbWQiID0+IFwmZ2l0X2V4ZWN1dGVfY21kLAorICAgICJh
dmFpbGFibGUiID0+ICcod2hpY2goImdpdCIpIG5lICIiKSAmJiAoLWUgIi5naXQiKScsCisgICAg
ImZpbmRfc2lnbmVyc19jbWQiID0+CisJImdpdCBsb2cgLS1uby1jb2xvciAtLWZvbGxvdyAtLXNp
bmNlPVwkZW1haWxfZ2l0X3NpbmNlICIgLgorCSAgICAnLS1udW1zdGF0IC0tbm8tbWVyZ2VzICcg
LgorCSAgICAnLS1mb3JtYXQ9IkdpdENvbW1pdDogJUglbicgLgorCQkgICAgICAnR2l0QXV0aG9y
OiAlYW4gPCVhZT4lbicgLgorCQkgICAgICAnR2l0RGF0ZTogJWFEJW4nIC4KKwkJICAgICAgJ0dp
dFN1YmplY3Q6ICVzJW4nIC4KKwkJICAgICAgJyViJW4iJyAuCisJICAgICIgLS0gXCRmaWxlIiwK
KyAgICAiZmluZF9jb21taXRfc2lnbmVyc19jbWQiID0+CisJImdpdCBsb2cgLS1uby1jb2xvciAi
IC4KKwkgICAgJy0tbnVtc3RhdCAnIC4KKwkgICAgJy0tZm9ybWF0PSJHaXRDb21taXQ6ICVIJW4n
IC4KKwkJICAgICAgJ0dpdEF1dGhvcjogJWFuIDwlYWU+JW4nIC4KKwkJICAgICAgJ0dpdERhdGU6
ICVhRCVuJyAuCisJCSAgICAgICdHaXRTdWJqZWN0OiAlcyVuJyAuCisJCSAgICAgICclYiVuIicg
LgorCSAgICAiIC0xIFwkY29tbWl0IiwKKyAgICAiZmluZF9jb21taXRfYXV0aG9yX2NtZCIgPT4K
KwkiZ2l0IGxvZyAtLW5vLWNvbG9yICIgLgorCSAgICAnLS1udW1zdGF0ICcgLgorCSAgICAnLS1m
b3JtYXQ9IkdpdENvbW1pdDogJUglbicgLgorCQkgICAgICAnR2l0QXV0aG9yOiAlYW4gPCVhZT4l
bicgLgorCQkgICAgICAnR2l0RGF0ZTogJWFEJW4nIC4KKwkJICAgICAgJ0dpdFN1YmplY3Q6ICVz
JW4iJyAuCisJICAgICIgLTEgXCRjb21taXQiLAorICAgICJibGFtZV9yYW5nZV9jbWQiID0+ICJn
aXQgYmxhbWUgLWwgLUwgXCRkaWZmX3N0YXJ0LCtcJGRpZmZfbGVuZ3RoIFwkZmlsZSIsCisgICAg
ImJsYW1lX2ZpbGVfY21kIiA9PiAiZ2l0IGJsYW1lIC1sIFwkZmlsZSIsCisgICAgImNvbW1pdF9w
YXR0ZXJuIiA9PiAiXkdpdENvbW1pdDogKFswLTlhLWZdezQwLDQwfSkiLAorICAgICJibGFtZV9j
b21taXRfcGF0dGVybiIgPT4gIl4oWzAtOWEtZl0rKSAiLAorICAgICJhdXRob3JfcGF0dGVybiIg
PT4gIl5HaXRBdXRob3I6ICguKikiLAorICAgICJzdWJqZWN0X3BhdHRlcm4iID0+ICJeR2l0U3Vi
amVjdDogKC4qKSIsCisgICAgInN0YXRfcGF0dGVybiIgPT4gIl4oXFxkKylcXHQoXFxkKylcXHRc
JGZpbGVcJCIsCisgICAgImZpbGVfZXhpc3RzX2NtZCIgPT4gImdpdCBscy1maWxlcyBcJGZpbGUi
LAorICAgICJsaXN0X2ZpbGVzX2NtZCIgPT4gImdpdCBscy1maWxlcyBcJGZpbGUiLAorKTsKKwor
bXkgJVZDU19jbWRzX2hnID0gKAorICAgICJleGVjdXRlX2NtZCIgPT4gXCZoZ19leGVjdXRlX2Nt
ZCwKKyAgICAiYXZhaWxhYmxlIiA9PiAnKHdoaWNoKCJoZyIpIG5lICIiKSAmJiAoLWQgIi5oZyIp
JywKKyAgICAiZmluZF9zaWduZXJzX2NtZCIgPT4KKwkiaGcgbG9nIC0tZGF0ZT1cJGVtYWlsX2hn
X3NpbmNlICIgLgorCSAgICAiLS10ZW1wbGF0ZT0nSGdDb21taXQ6IHtub2RlfVxcbiIgLgorCSAg
ICAgICAgICAgICAgICAiSGdBdXRob3I6IHthdXRob3J9XFxuIiAuCisJCQkiSGdTdWJqZWN0OiB7
ZGVzY31cXG4nIiAuCisJICAgICIgLS0gXCRmaWxlIiwKKyAgICAiZmluZF9jb21taXRfc2lnbmVy
c19jbWQiID0+CisJImhnIGxvZyAiIC4KKwkgICAgIi0tdGVtcGxhdGU9J0hnU3ViamVjdDoge2Rl
c2N9XFxuJyIgLgorCSAgICAiIC1yIFwkY29tbWl0IiwKKyAgICAiZmluZF9jb21taXRfYXV0aG9y
X2NtZCIgPT4KKwkiaGcgbG9nICIgLgorCSAgICAiLS10ZW1wbGF0ZT0nSGdDb21taXQ6IHtub2Rl
fVxcbiIgLgorCQkgICAgICAgICJIZ0F1dGhvcjoge2F1dGhvcn1cXG4iIC4KKwkJCSJIZ1N1Ympl
Y3Q6IHtkZXNjfGZpcnN0bGluZX1cXG4nIiAuCisJICAgICIgLXIgXCRjb21taXQiLAorICAgICJi
bGFtZV9yYW5nZV9jbWQiID0+ICIiLAkJIyBub3Qgc3VwcG9ydGVkCisgICAgImJsYW1lX2ZpbGVf
Y21kIiA9PiAiaGcgYmxhbWUgLW4gXCRmaWxlIiwKKyAgICAiY29tbWl0X3BhdHRlcm4iID0+ICJe
SGdDb21taXQ6IChbMC05YS1mXXs0MCw0MH0pIiwKKyAgICAiYmxhbWVfY29tbWl0X3BhdHRlcm4i
ID0+ICJeKFsgMC05YS1mXSspOiIsCisgICAgImF1dGhvcl9wYXR0ZXJuIiA9PiAiXkhnQXV0aG9y
OiAoLiopIiwKKyAgICAic3ViamVjdF9wYXR0ZXJuIiA9PiAiXkhnU3ViamVjdDogKC4qKSIsCisg
ICAgInN0YXRfcGF0dGVybiIgPT4gIl4oXFxkKylcdChcXGQrKVx0XCRmaWxlXCQiLAorICAgICJm
aWxlX2V4aXN0c19jbWQiID0+ICJoZyBmaWxlcyBcJGZpbGUiLAorICAgICJsaXN0X2ZpbGVzX2Nt
ZCIgPT4gImhnIG1hbmlmZXN0IC1SIFwkZmlsZSIsCispOworCitteSAkY29uZiA9IHdoaWNoX2Nv
bmYoIi5nZXRfbWFpbnRhaW5lci5jb25mIik7CitpZiAoLWYgJGNvbmYpIHsKKyAgICBteSBAY29u
Zl9hcmdzOworICAgIG9wZW4obXkgJGNvbmZmaWxlLCAnPCcsICIkY29uZiIpCisJb3Igd2FybiAi
JFA6IENhbid0IGZpbmQgYSByZWFkYWJsZSAuZ2V0X21haW50YWluZXIuY29uZiBmaWxlICQhXG4i
OworCisgICAgd2hpbGUgKDwkY29uZmZpbGU+KSB7CisJbXkgJGxpbmUgPSAkXzsKKworCSRsaW5l
ID1+IHMvXHMqXG4/JC8vZzsKKwkkbGluZSA9fiBzL15ccyovL2c7CisJJGxpbmUgPX4gcy9ccysv
IC9nOworCisJbmV4dCBpZiAoJGxpbmUgPX4gbS9eXHMqIy8pOworCW5leHQgaWYgKCRsaW5lID1+
IG0vXlxzKiQvKTsKKworCW15IEB3b3JkcyA9IHNwbGl0KCIgIiwgJGxpbmUpOworCWZvcmVhY2gg
bXkgJHdvcmQgKEB3b3JkcykgeworCSAgICBsYXN0IGlmICgkd29yZCA9fiBtL14jLyk7CisJICAg
IHB1c2ggKEBjb25mX2FyZ3MsICR3b3JkKTsKKwl9CisgICAgfQorICAgIGNsb3NlKCRjb25mZmls
ZSk7CisgICAgdW5zaGlmdChAQVJHViwgQGNvbmZfYXJncykgaWYgQGNvbmZfYXJnczsKK30KKwor
bXkgQGlnbm9yZV9lbWFpbHMgPSAoKTsKK215ICRpZ25vcmVfZmlsZSA9IHdoaWNoX2NvbmYoIi5n
ZXRfbWFpbnRhaW5lci5pZ25vcmUiKTsKK2lmICgtZiAkaWdub3JlX2ZpbGUpIHsKKyAgICBvcGVu
KG15ICRpZ25vcmUsICc8JywgIiRpZ25vcmVfZmlsZSIpCisJb3Igd2FybiAiJFA6IENhbid0IGZp
bmQgYSByZWFkYWJsZSAuZ2V0X21haW50YWluZXIuaWdub3JlIGZpbGUgJCFcbiI7CisgICAgd2hp
bGUgKDwkaWdub3JlPikgeworCW15ICRsaW5lID0gJF87CisKKwkkbGluZSA9fiBzL1xzKlxuPyQv
LzsKKwkkbGluZSA9fiBzL15ccyovLzsKKwkkbGluZSA9fiBzL1xzKyQvLzsKKwkkbGluZSA9fiBz
LyMuKiQvLzsKKworCW5leHQgaWYgKCRsaW5lID1+IG0vXlxzKiQvKTsKKwlpZiAocmZjODIyX3Zh
bGlkKCRsaW5lKSkgeworCSAgICBwdXNoKEBpZ25vcmVfZW1haWxzLCAkbGluZSk7CisJfQorICAg
IH0KKyAgICBjbG9zZSgkaWdub3JlKTsKK30KKworaWYgKCQjQVJHViA+IDApIHsKKyAgICBmb3Jl
YWNoIChAQVJHVikgeworICAgICAgICBpZiAoJF8gPX4gL14tezEsMn1zZWxmLXRlc3QoPzo9fCQp
LykgeworICAgICAgICAgICAgZGllICIkUDogdXNpbmcgLS1zZWxmLXRlc3QgZG9lcyBub3QgYWxs
b3cgYW55IG90aGVyIG9wdGlvbiBvciBhcmd1bWVudFxuIjsKKyAgICAgICAgfQorICAgIH0KK30K
KworaWYgKCFHZXRPcHRpb25zKAorCQknZW1haWwhJyA9PiBcJGVtYWlsLAorCQknZ2l0IScgPT4g
XCRlbWFpbF9naXQsCisJCSdnaXQtYWxsLXNpZ25hdHVyZS10eXBlcyEnID0+IFwkZW1haWxfZ2l0
X2FsbF9zaWduYXR1cmVfdHlwZXMsCisJCSdnaXQtYmxhbWUhJyA9PiBcJGVtYWlsX2dpdF9ibGFt
ZSwKKwkJJ2dpdC1ibGFtZS1zaWduYXR1cmVzIScgPT4gXCRlbWFpbF9naXRfYmxhbWVfc2lnbmF0
dXJlcywKKwkJJ2dpdC1mYWxsYmFjayEnID0+IFwkZW1haWxfZ2l0X2ZhbGxiYWNrLAorCQknZ2l0
LW1pbi1zaWduYXR1cmVzPWknID0+IFwkZW1haWxfZ2l0X21pbl9zaWduYXR1cmVzLAorCQknZ2l0
LW1heC1tYWludGFpbmVycz1pJyA9PiBcJGVtYWlsX2dpdF9tYXhfbWFpbnRhaW5lcnMsCisJCSdn
aXQtbWluLXBlcmNlbnQ9aScgPT4gXCRlbWFpbF9naXRfbWluX3BlcmNlbnQsCisJCSdnaXQtc2lu
Y2U9cycgPT4gXCRlbWFpbF9naXRfc2luY2UsCisJCSdoZy1zaW5jZT1zJyA9PiBcJGVtYWlsX2hn
X3NpbmNlLAorCQknaXxpbnRlcmFjdGl2ZSEnID0+IFwkaW50ZXJhY3RpdmUsCisJCSdyZW1vdmUt
ZHVwbGljYXRlcyEnID0+IFwkZW1haWxfcmVtb3ZlX2R1cGxpY2F0ZXMsCisJCSdtYWlsbWFwIScg
PT4gXCRlbWFpbF91c2VfbWFpbG1hcCwKKwkJJ20hJyA9PiBcJGVtYWlsX21haW50YWluZXIsCisJ
CSdyIScgPT4gXCRlbWFpbF9yZXZpZXdlciwKKwkJJ24hJyA9PiBcJGVtYWlsX3VzZW5hbWUsCisJ
CSdsIScgPT4gXCRlbWFpbF9saXN0LAorCQknZml4ZXMhJyA9PiBcJGVtYWlsX2ZpeGVzLAorCQkn
bW9kZXJhdGVkIScgPT4gXCRlbWFpbF9tb2RlcmF0ZWRfbGlzdCwKKwkJJ3MhJyA9PiBcJGVtYWls
X3N1YnNjcmliZXJfbGlzdCwKKwkJJ211bHRpbGluZSEnID0+IFwkb3V0cHV0X211bHRpbGluZSwK
KwkJJ3JvbGVzIScgPT4gXCRvdXRwdXRfcm9sZXMsCisJCSdyb2xlc3RhdHMhJyA9PiBcJG91dHB1
dF9yb2xlc3RhdHMsCisJCSdzZXBhcmF0b3I9cycgPT4gXCRvdXRwdXRfc2VwYXJhdG9yLAorCQkn
c3Vic3lzdGVtIScgPT4gXCRzdWJzeXN0ZW0sCisJCSdzdGF0dXMhJyA9PiBcJHN0YXR1cywKKwkJ
J3NjbSEnID0+IFwkc2NtLAorCQkndHJlZSEnID0+IFwkdHJlZSwKKwkJJ3dlYiEnID0+IFwkd2Vi
LAorCQknbGV0dGVycz1zJyA9PiBcJGxldHRlcnMsCisJCSdwYXR0ZXJuLWRlcHRoPWknID0+IFwk
cGF0dGVybl9kZXB0aCwKKwkJJ2t8a2V5d29yZHMhJyA9PiBcJGtleXdvcmRzLAorCQknc2VjdGlv
bnMhJyA9PiBcJHNlY3Rpb25zLAorCQknZmV8ZmlsZS1lbWFpbHMhJyA9PiBcJGVtYWlsX2ZpbGVf
ZW1haWxzLAorCQknZnxmaWxlJyA9PiBcJGZyb21fZmlsZW5hbWUsCisJCSdmaW5kLW1haW50YWlu
ZXItZmlsZXMnID0+IFwkZmluZF9tYWludGFpbmVyX2ZpbGVzLAorCQknbXBhdGh8bWFpbnRhaW5l
ci1wYXRoPXMnID0+IFwkbWFpbnRhaW5lcl9wYXRoLAorCQknc2VsZi10ZXN0OnMnID0+IFwkc2Vs
Zl90ZXN0LAorCQkndnx2ZXJzaW9uJyA9PiBcJHZlcnNpb24sCisJCSdofGhlbHB8dXNhZ2UnID0+
IFwkaGVscCwKKwkJKSkgeworICAgIGRpZSAiJFA6IGludmFsaWQgYXJndW1lbnQgLSB1c2UgLS1o
ZWxwIGlmIG5lY2Vzc2FyeVxuIjsKK30KKworaWYgKCRoZWxwICE9IDApIHsKKyAgICB1c2FnZSgp
OworICAgIGV4aXQgMDsKK30KKworaWYgKCR2ZXJzaW9uICE9IDApIHsKKyAgICBwcmludCgiJHtQ
fSAke1Z9XG4iKTsKKyAgICBleGl0IDA7Cit9CisKK2lmIChkZWZpbmVkICRzZWxmX3Rlc3QpIHsK
KyAgICByZWFkX2FsbF9tYWludGFpbmVyX2ZpbGVzKCk7CisgICAgc2VsZl90ZXN0KCk7CisgICAg
ZXhpdCAwOworfQorCitpZiAoLXQgU1RESU4gJiYgIUBBUkdWKSB7CisgICAgIyBXZSdyZSB0YWxr
aW5nIHRvIGEgdGVybWluYWwsIGJ1dCBoYXZlIG5vIGNvbW1hbmQgbGluZSBhcmd1bWVudHMuCisg
ICAgZGllICIkUDogbWlzc2luZyBwYXRjaGZpbGUgb3IgLWYgZmlsZSAtIHVzZSAtLWhlbHAgaWYg
bmVjZXNzYXJ5XG4iOworfQorCiskb3V0cHV0X211bHRpbGluZSA9IDAgaWYgKCRvdXRwdXRfc2Vw
YXJhdG9yIG5lICIsICIpOworJG91dHB1dF9yb2xlc3RhdHMgPSAxIGlmICgkaW50ZXJhY3RpdmUp
OworJG91dHB1dF9yb2xlcyA9IDEgaWYgKCRvdXRwdXRfcm9sZXN0YXRzKTsKKworaWYgKCRzZWN0
aW9ucyB8fCAkbGV0dGVycyBuZSAiIikgeworICAgICRzZWN0aW9ucyA9IDE7CisgICAgJGVtYWls
ID0gMDsKKyAgICAkZW1haWxfbGlzdCA9IDA7CisgICAgJHNjbSA9IDA7CisgICAgJHN0YXR1cyA9
IDA7CisgICAgJHN1YnN5c3RlbSA9IDA7CisgICAgJHdlYiA9IDA7CisgICAgJGtleXdvcmRzID0g
MDsKKyAgICAkaW50ZXJhY3RpdmUgPSAwOworfSBlbHNlIHsKKyAgICBteSAkc2VsZWN0aW9ucyA9
ICRlbWFpbCArICRzY20gKyAkc3RhdHVzICsgJHN1YnN5c3RlbSArICR3ZWI7CisgICAgaWYgKCRz
ZWxlY3Rpb25zID09IDApIHsKKwlkaWUgIiRQOiAgTWlzc2luZyByZXF1aXJlZCBvcHRpb246IGVt
YWlsLCBzY20sIHN0YXR1cywgc3Vic3lzdGVtIG9yIHdlYlxuIjsKKyAgICB9Cit9CisKK2lmICgk
ZW1haWwgJiYKKyAgICAoJGVtYWlsX21haW50YWluZXIgKyAkZW1haWxfcmV2aWV3ZXIgKworICAg
ICAkZW1haWxfbGlzdCArICRlbWFpbF9zdWJzY3JpYmVyX2xpc3QgKworICAgICAkZW1haWxfZ2l0
ICsgJGVtYWlsX2dpdF9ibGFtZSkgPT0gMCkgeworICAgIGRpZSAiJFA6IFBsZWFzZSBzZWxlY3Qg
YXQgbGVhc3QgMSBlbWFpbCBvcHRpb25cbiI7Cit9CisKKyMjIFJlYWQgTUFJTlRBSU5FUlMgZm9y
IHR5cGUvdmFsdWUgcGFpcnMKKworbXkgQHR5cGV2YWx1ZSA9ICgpOworbXkgJWtleXdvcmRfaGFz
aDsKK215IEBtZmlsZXMgPSAoKTsKK215IEBzZWxmX3Rlc3RfaW5mbyA9ICgpOworCitzdWIgcmVh
ZF9tYWludGFpbmVyX2ZpbGUgeworICAgIG15ICgkZmlsZSkgPSBAXzsKKworICAgIG9wZW4gKG15
ICRtYWludCwgJzwnLCAiJGZpbGUiKQorCW9yIGRpZSAiJFA6IENhbid0IG9wZW4gTUFJTlRBSU5F
UlMgZmlsZSAnJGZpbGUnOiAkIVxuIjsKKyAgICBteSAkaSA9IDE7CisgICAgd2hpbGUgKDwkbWFp
bnQ+KSB7CisJbXkgJGxpbmUgPSAkXzsKKwljaG9tcCAkbGluZTsKKworCWlmICgkbGluZSA9fiBt
L14oW0EtWl0pOlxzKiguKikvKSB7CisJICAgIG15ICR0eXBlID0gJDE7CisJICAgIG15ICR2YWx1
ZSA9ICQyOworCisJICAgICMjRmlsZW5hbWUgcGF0dGVybiBtYXRjaGluZworCSAgICBpZiAoJHR5
cGUgZXEgIkYiIHx8ICR0eXBlIGVxICJYIikgeworCQkkdmFsdWUgPX4gc0BcLkBcXFwuQGc7ICAg
ICAgICMjQ29udmVydCAuIHRvIFwuCisJCSR2YWx1ZSA9fiBzL1wqL1wuXCovZzsgICAgICAgIyND
b252ZXJ0ICogdG8gLioKKwkJJHZhbHVlID1+IHMvXD8vXC4vZzsgICAgICAgICAjI0NvbnZlcnQg
PyB0byAuCisJCSMjaWYgcGF0dGVybiBpcyBhIGRpcmVjdG9yeSBhbmQgaXQgbGFja3MgYSB0cmFp
bGluZyBzbGFzaCwgYWRkIG9uZQorCQlpZiAoKC1kICR2YWx1ZSkpIHsKKwkJICAgICR2YWx1ZSA9
fiBzQChbXi9dKSRAJDEvQDsKKwkJfQorCSAgICB9IGVsc2lmICgkdHlwZSBlcSAiSyIpIHsKKwkJ
JGtleXdvcmRfaGFzaHtAdHlwZXZhbHVlfSA9ICR2YWx1ZTsKKwkgICAgfQorCSAgICBwdXNoKEB0
eXBldmFsdWUsICIkdHlwZTokdmFsdWUiKTsKKwl9IGVsc2lmICghKC9eXHMqJC8gfHwgL15ccypc
Iy8pKSB7CisJICAgIHB1c2goQHR5cGV2YWx1ZSwgJGxpbmUpOworCX0KKwlpZiAoZGVmaW5lZCAk
c2VsZl90ZXN0KSB7CisJICAgIHB1c2goQHNlbGZfdGVzdF9pbmZvLCB7ZmlsZT0+JGZpbGUsIGxp
bmVucj0+JGksIGxpbmU9PiRsaW5lfSk7CisJfQorCSRpKys7CisgICAgfQorICAgIGNsb3NlKCRt
YWludCk7Cit9CisKK3N1YiBmaW5kX2lzX21haW50YWluZXJfZmlsZSB7CisgICAgbXkgKCRmaWxl
KSA9ICRfOworICAgIHJldHVybiBpZiAoJGZpbGUgIX4gbUAvTUFJTlRBSU5FUlMkQCk7CisgICAg
JGZpbGUgPSAkRmlsZTo6RmluZDo6bmFtZTsKKyAgICByZXR1cm4gaWYgKCEgLWYgJGZpbGUpOwor
ICAgIHB1c2goQG1maWxlcywgJGZpbGUpOworfQorCitzdWIgZmluZF9pZ25vcmVfZ2l0IHsKKyAg
ICByZXR1cm4gZ3JlcCB7ICRfICF+IC9eXC5naXQkLzsgfSBAXzsKK30KKworcmVhZF9hbGxfbWFp
bnRhaW5lcl9maWxlcygpOworCitzdWIgcmVhZF9hbGxfbWFpbnRhaW5lcl9maWxlcyB7CisgICAg
bXkgJHBhdGggPSAiJHtsa19wYXRofU1BSU5UQUlORVJTIjsKKyAgICBpZiAoZGVmaW5lZCAkbWFp
bnRhaW5lcl9wYXRoKSB7CisJJHBhdGggPSAkbWFpbnRhaW5lcl9wYXRoOworCSMgUGVybCBDb29r
Ym9vayB0aWxkZSBleHBhbnNpb24gaWYgbmVjZXNzYXJ5CisJJHBhdGggPX4gc0BefihbXi9dKilA
ICQxID8gKGdldHB3bmFtKCQxKSlbN10gOiAoICRFTlZ7SE9NRX0gfHwgJEVOVntMT0dESVJ9IHx8
IChnZXRwd3VpZCgkPCkpWzddKUBleDsKKyAgICB9CisKKyAgICBpZiAoLWQgJHBhdGgpIHsKKwkk
cGF0aCAuPSAnLycgaWYgKCRwYXRoICF+IG1ALyRAKTsKKwlpZiAoJGZpbmRfbWFpbnRhaW5lcl9m
aWxlcykgeworCSAgICBmaW5kKCB7IHdhbnRlZCA9PiBcJmZpbmRfaXNfbWFpbnRhaW5lcl9maWxl
LAorCQkgICAgcHJlcHJvY2VzcyA9PiBcJmZpbmRfaWdub3JlX2dpdCwKKwkJICAgIG5vX2NoZGly
ID0+IDEsCisJCX0sICIkcGF0aCIpOworCX0gZWxzZSB7CisJICAgIG9wZW5kaXIoRElSLCAiJHBh
dGgiKSBvciBkaWUgJCE7CisJICAgIG15IEBmaWxlcyA9IHJlYWRkaXIoRElSKTsKKwkgICAgY2xv
c2VkaXIoRElSKTsKKwkgICAgZm9yZWFjaCBteSAkZmlsZSAoQGZpbGVzKSB7CisJCXB1c2goQG1m
aWxlcywgIiRwYXRoJGZpbGUiKSBpZiAoJGZpbGUgIX4gL15cLi8pOworCSAgICB9CisJfQorICAg
IH0gZWxzaWYgKC1mICIkcGF0aCIpIHsKKwlwdXNoKEBtZmlsZXMsICIkcGF0aCIpOworICAgIH0g
ZWxzZSB7CisJZGllICIkUDogTUFJTlRBSU5FUiBmaWxlIG5vdCBmb3VuZCAnJHBhdGgnXG4iOwor
ICAgIH0KKyAgICBkaWUgIiRQOiBObyBNQUlOVEFJTkVSIGZpbGVzIGZvdW5kIGluICckcGF0aCdc
biIgaWYgKHNjYWxhcihAbWZpbGVzKSA9PSAwKTsKKyAgICBmb3JlYWNoIG15ICRmaWxlIChAbWZp
bGVzKSB7CisJcmVhZF9tYWludGFpbmVyX2ZpbGUoIiRmaWxlIik7CisgICAgfQorfQorCitzdWIg
bWFpbnRhaW5lcnNfaW5fZmlsZSB7CisgICAgbXkgKCRmaWxlKSA9IEBfOworCisgICAgcmV0dXJu
IGlmICgkZmlsZSA9fiBtQFxiTUFJTlRBSU5FUlMkQCk7CisKKyAgICBpZiAoLWYgJGZpbGUgJiYg
KCRlbWFpbF9maWxlX2VtYWlscyB8fCAkZmlsZSA9fiAvXC55YW1sJC8pKSB7CisJb3BlbihteSAk
ZiwgJzwnLCAkZmlsZSkKKwkgICAgb3IgZGllICIkUDogQ2FuJ3Qgb3BlbiAkZmlsZTogJCFcbiI7
CisJbXkgJHRleHQgPSBkbyB7IGxvY2FsKCQvKSA7IDwkZj4gfTsKKwljbG9zZSgkZik7CisKKwlt
eSBAcG9zc19hZGRyID0gJHRleHQgPX4gbSRbQS1aYS16w4Atw79cIlwnIFwsXC5cKy1dKlxzKltc
LF0qXHMqW1woXDxce117MCwxfVtBLVphLXowLTlfXC5cKy1dK1xAW0EtWmEtejAtOVwuLV0rXC5b
QS1aYS16MC05XStbXClcPlx9XXswLDF9JGc7CisJcHVzaChAZmlsZV9lbWFpbHMsIGNsZWFuX2Zp
bGVfZW1haWxzKEBwb3NzX2FkZHIpKTsKKyAgICB9Cit9CisKKyMKKyMgUmVhZCBtYWlsIGFkZHJl
c3MgbWFwCisjCisKK215ICRtYWlsbWFwOworCityZWFkX21haWxtYXAoKTsKKworc3ViIHJlYWRf
bWFpbG1hcCB7CisgICAgJG1haWxtYXAgPSB7CisJbmFtZXMgPT4ge30sCisJYWRkcmVzc2VzID0+
IHt9CisgICAgfTsKKworICAgIHJldHVybiBpZiAoISRlbWFpbF91c2VfbWFpbG1hcCB8fCAhKC1m
ICIke2xrX3BhdGh9Lm1haWxtYXAiKSk7CisKKyAgICBvcGVuKG15ICRtYWlsbWFwX2ZpbGUsICc8
JywgIiR7bGtfcGF0aH0ubWFpbG1hcCIpCisJb3Igd2FybiAiJFA6IENhbid0IG9wZW4gLm1haWxt
YXA6ICQhXG4iOworCisgICAgd2hpbGUgKDwkbWFpbG1hcF9maWxlPikgeworCXMvIy4qJC8vOyAj
c3RyaXAgY29tbWVudHMKKwlzL15ccyt8XHMrJC8vZzsgI3RyaW0KKworCW5leHQgaWYgKC9eXHMq
JC8pOyAjc2tpcCBlbXB0eSBsaW5lcworCSNlbnRyaWVzIGhhdmUgb25lIG9mIHRoZSBmb2xsb3dp
bmcgZm9ybWF0czoKKwkjIG5hbWUxIDxtYWlsMT4KKwkjIDxtYWlsMT4gPG1haWwyPgorCSMgbmFt
ZTEgPG1haWwxPiA8bWFpbDI+CisJIyBuYW1lMSA8bWFpbDE+IG5hbWUyIDxtYWlsMj4KKwkjIChz
ZWUgbWFuIGdpdC1zaG9ydGxvZykKKworCWlmICgvXihbXjxdKyk8KFtePl0rKT4kLykgeworCSAg
ICBteSAkcmVhbF9uYW1lID0gJDE7CisJICAgIG15ICRhZGRyZXNzID0gJDI7CisKKwkgICAgJHJl
YWxfbmFtZSA9fiBzL1xzKyQvLzsKKwkgICAgKCRyZWFsX25hbWUsICRhZGRyZXNzKSA9IHBhcnNl
X2VtYWlsKCIkcmVhbF9uYW1lIDwkYWRkcmVzcz4iKTsKKwkgICAgJG1haWxtYXAtPntuYW1lc30t
PnskYWRkcmVzc30gPSAkcmVhbF9uYW1lOworCisJfSBlbHNpZiAoL148KFtePl0rKT5ccyo8KFte
Pl0rKT4kLykgeworCSAgICBteSAkcmVhbF9hZGRyZXNzID0gJDE7CisJICAgIG15ICR3cm9uZ19h
ZGRyZXNzID0gJDI7CisKKwkgICAgJG1haWxtYXAtPnthZGRyZXNzZXN9LT57JHdyb25nX2FkZHJl
c3N9ID0gJHJlYWxfYWRkcmVzczsKKworCX0gZWxzaWYgKC9eKC4rKTwoW14+XSspPlxzKjwoW14+
XSspPiQvKSB7CisJICAgIG15ICRyZWFsX25hbWUgPSAkMTsKKwkgICAgbXkgJHJlYWxfYWRkcmVz
cyA9ICQyOworCSAgICBteSAkd3JvbmdfYWRkcmVzcyA9ICQzOworCisJICAgICRyZWFsX25hbWUg
PX4gcy9ccyskLy87CisJICAgICgkcmVhbF9uYW1lLCAkcmVhbF9hZGRyZXNzKSA9CisJCXBhcnNl
X2VtYWlsKCIkcmVhbF9uYW1lIDwkcmVhbF9hZGRyZXNzPiIpOworCSAgICAkbWFpbG1hcC0+e25h
bWVzfS0+eyR3cm9uZ19hZGRyZXNzfSA9ICRyZWFsX25hbWU7CisJICAgICRtYWlsbWFwLT57YWRk
cmVzc2VzfS0+eyR3cm9uZ19hZGRyZXNzfSA9ICRyZWFsX2FkZHJlc3M7CisKKwl9IGVsc2lmICgv
XiguKyk8KFtePl0rKT5ccyooLispXHMqPChbXj5dKyk+JC8pIHsKKwkgICAgbXkgJHJlYWxfbmFt
ZSA9ICQxOworCSAgICBteSAkcmVhbF9hZGRyZXNzID0gJDI7CisJICAgIG15ICR3cm9uZ19uYW1l
ID0gJDM7CisJICAgIG15ICR3cm9uZ19hZGRyZXNzID0gJDQ7CisKKwkgICAgJHJlYWxfbmFtZSA9
fiBzL1xzKyQvLzsKKwkgICAgKCRyZWFsX25hbWUsICRyZWFsX2FkZHJlc3MpID0KKwkJcGFyc2Vf
ZW1haWwoIiRyZWFsX25hbWUgPCRyZWFsX2FkZHJlc3M+Iik7CisKKwkgICAgJHdyb25nX25hbWUg
PX4gcy9ccyskLy87CisJICAgICgkd3JvbmdfbmFtZSwgJHdyb25nX2FkZHJlc3MpID0KKwkJcGFy
c2VfZW1haWwoIiR3cm9uZ19uYW1lIDwkd3JvbmdfYWRkcmVzcz4iKTsKKworCSAgICBteSAkd3Jv
bmdfZW1haWwgPSBmb3JtYXRfZW1haWwoJHdyb25nX25hbWUsICR3cm9uZ19hZGRyZXNzLCAxKTsK
KwkgICAgJG1haWxtYXAtPntuYW1lc30tPnskd3JvbmdfZW1haWx9ID0gJHJlYWxfbmFtZTsKKwkg
ICAgJG1haWxtYXAtPnthZGRyZXNzZXN9LT57JHdyb25nX2VtYWlsfSA9ICRyZWFsX2FkZHJlc3M7
CisJfQorICAgIH0KKyAgICBjbG9zZSgkbWFpbG1hcF9maWxlKTsKK30KKworIyMgdXNlIHRoZSBm
aWxlbmFtZXMgb24gdGhlIGNvbW1hbmQgbGluZSBvciBmaW5kIHRoZSBmaWxlbmFtZXMgaW4gdGhl
IHBhdGNoZmlsZXMKKworaWYgKCFAQVJHVikgeworICAgIHB1c2goQEFSR1YsICImU1RESU4iKTsK
K30KKworZm9yZWFjaCBteSAkZmlsZSAoQEFSR1YpIHsKKyAgICBpZiAoJGZpbGUgbmUgIiZTVERJ
TiIpIHsKKwkkZmlsZSA9IGNhbm9ucGF0aCgkZmlsZSk7CisJIyNpZiAkZmlsZSBpcyBhIGRpcmVj
dG9yeSBhbmQgaXQgbGFja3MgYSB0cmFpbGluZyBzbGFzaCwgYWRkIG9uZQorCWlmICgoLWQgJGZp
bGUpKSB7CisJICAgICRmaWxlID1+IHNAKFteL10pJEAkMS9AOworCX0gZWxzaWYgKCEoLWYgJGZp
bGUpKSB7CisJICAgIGRpZSAiJFA6IGZpbGUgJyR7ZmlsZX0nIG5vdCBmb3VuZFxuIjsKKwl9Cisg
ICAgfQorICAgIGlmICgkZnJvbV9maWxlbmFtZSAmJiAodmNzX2V4aXN0cygpICYmICF2Y3NfZmls
ZV9leGlzdHMoJGZpbGUpKSkgeworCXdhcm4gIiRQOiBmaWxlICckZmlsZScgbm90IGZvdW5kIGlu
IHZlcnNpb24gY29udHJvbCAkIVxuIjsKKyAgICB9CisgICAgaWYgKCRmcm9tX2ZpbGVuYW1lIHx8
ICgkZmlsZSBuZSAiJlNURElOIiAmJiB2Y3NfZmlsZV9leGlzdHMoJGZpbGUpKSkgeworCSRmaWxl
ID1+IHMvXlxRJHtjdXJfcGF0aH1cRS8vOwkjc3RyaXAgYW55IGFic29sdXRlIHBhdGgKKwkkZmls
ZSA9fiBzL15cUSR7bGtfcGF0aH1cRS8vOwkjb3IgdGhlIHBhdGggdG8gdGhlIGxrIHRyZWUKKwlw
dXNoKEBmaWxlcywgJGZpbGUpOworCWlmICgkZmlsZSBuZSAiTUFJTlRBSU5FUlMiICYmIC1mICRm
aWxlICYmICRrZXl3b3JkcykgeworCSAgICBvcGVuKG15ICRmLCAnPCcsICRmaWxlKQorCQlvciBk
aWUgIiRQOiBDYW4ndCBvcGVuICRmaWxlOiAkIVxuIjsKKwkgICAgbXkgJHRleHQgPSBkbyB7IGxv
Y2FsKCQvKSA7IDwkZj4gfTsKKwkgICAgY2xvc2UoJGYpOworCSAgICBpZiAoJGtleXdvcmRzKSB7
CisJCWZvcmVhY2ggbXkgJGxpbmUgKGtleXMgJWtleXdvcmRfaGFzaCkgeworCQkgICAgaWYgKCR0
ZXh0ID1+IG0vJGtleXdvcmRfaGFzaHskbGluZX0veCkgeworCQkJcHVzaChAa2V5d29yZF90dmks
ICRsaW5lKTsKKwkJICAgIH0KKwkJfQorCSAgICB9CisJfQorICAgIH0gZWxzZSB7CisJbXkgJGZp
bGVfY250ID0gQGZpbGVzOworCW15ICRsYXN0ZmlsZTsKKworCW9wZW4obXkgJHBhdGNoLCAiPCAk
ZmlsZSIpCisJICAgIG9yIGRpZSAiJFA6IENhbid0IG9wZW4gJGZpbGU6ICQhXG4iOworCisJIyBX
ZSBjYW4gY2hlY2sgYXJiaXRyYXJ5IGluZm9ybWF0aW9uIGJlZm9yZSB0aGUgcGF0Y2gKKwkjIGxp
a2UgdGhlIGNvbW1pdCBtZXNzYWdlLCBtYWlsIGhlYWRlcnMsIGV0Yy4uLgorCSMgVGhpcyBhbGxv
d3MgdXMgdG8gbWF0Y2ggYXJiaXRyYXJ5IGtleXdvcmRzIGFnYWluc3QgYW55IHBhcnQKKwkjIG9m
IGEgZ2l0IGZvcm1hdC1wYXRjaCBnZW5lcmF0ZWQgZmlsZSAoc3ViamVjdCB0YWdzLCBldGMuLi4p
CisKKwlteSAkcGF0Y2hfcHJlZml4ID0gIiI7CQkJI1BhcnNpbmcgdGhlIGludHJvCisKKwl3aGls
ZSAoPCRwYXRjaD4pIHsKKwkgICAgbXkgJHBhdGNoX2xpbmUgPSAkXzsKKwkgICAgaWYgKG0vXiBt
b2RlIGNoYW5nZSBbMC03XSsgPT4gWzAtN10rIChcUyspXHMqJC8pIHsKKwkJbXkgJGZpbGVuYW1l
ID0gJDE7CisJCXB1c2goQGZpbGVzLCAkZmlsZW5hbWUpOworCSAgICB9IGVsc2lmIChtL15yZW5h
bWUgKD86ZnJvbXx0bykgKFxTKylccyokLykgeworCQlteSAkZmlsZW5hbWUgPSAkMTsKKwkJcHVz
aChAZmlsZXMsICRmaWxlbmFtZSk7CisJICAgIH0gZWxzaWYgKG0vXmRpZmYgLS1naXQgYVwvKFxT
KykgYlwvKFxTKylccyokLykgeworCQlteSAkZmlsZW5hbWUxID0gJDE7CisJCW15ICRmaWxlbmFt
ZTIgPSAkMjsKKwkJcHVzaChAZmlsZXMsICRmaWxlbmFtZTEpOworCQlwdXNoKEBmaWxlcywgJGZp
bGVuYW1lMik7CisJICAgIH0gZWxzaWYgKG0vXkZpeGVzOlxzKyhbMC05YS1mQS1GXXs2LDQwfSkv
KSB7CisJCXB1c2goQGZpeGVzLCAkMSkgaWYgKCRlbWFpbF9maXhlcyk7CisJICAgIH0gZWxzaWYg
KG0vXlwrXCtcK1xzKyhcUyspLyBvciBtL14tLS1ccysoXFMrKS8pIHsKKwkJbXkgJGZpbGVuYW1l
ID0gJDE7CisJCSRmaWxlbmFtZSA9fiBzQF5bXi9dKi9AQDsKKwkJJGZpbGVuYW1lID1+IHNAXG5A
QDsKKwkJJGxhc3RmaWxlID0gJGZpbGVuYW1lOworCQlwdXNoKEBmaWxlcywgJGZpbGVuYW1lKTsK
KwkJJHBhdGNoX3ByZWZpeCA9ICJeWystXS4qIjsJI05vdyBwYXJzaW5nIHRoZSBhY3R1YWwgcGF0
Y2gKKwkgICAgfSBlbHNpZiAobS9eXEBcQCAtKFxkKyksKFxkKykvKSB7CisJCWlmICgkZW1haWxf
Z2l0X2JsYW1lKSB7CisJCSAgICBwdXNoKEByYW5nZSwgIiRsYXN0ZmlsZTokMTokMiIpOworCQl9
CisJICAgIH0gZWxzaWYgKCRrZXl3b3JkcykgeworCQlmb3JlYWNoIG15ICRsaW5lIChrZXlzICVr
ZXl3b3JkX2hhc2gpIHsKKwkJICAgIGlmICgkcGF0Y2hfbGluZSA9fiBtLyR7cGF0Y2hfcHJlZml4
fSRrZXl3b3JkX2hhc2h7JGxpbmV9L3gpIHsKKwkJCXB1c2goQGtleXdvcmRfdHZpLCAkbGluZSk7
CisJCSAgICB9CisJCX0KKwkgICAgfQorCX0KKwljbG9zZSgkcGF0Y2gpOworCisJaWYgKCRmaWxl
X2NudCA9PSBAZmlsZXMpIHsKKwkgICAgd2FybiAiJFA6IGZpbGUgJyR7ZmlsZX0nIGRvZXNuJ3Qg
YXBwZWFyIHRvIGJlIGEgcGF0Y2guICAiCisJCS4gIkFkZCAtZiB0byBvcHRpb25zP1xuIjsKKwl9
CisJQGZpbGVzID0gc29ydF9hbmRfdW5pcShAZmlsZXMpOworICAgIH0KK30KKworQGZpbGVfZW1h
aWxzID0gdW5pcShAZmlsZV9lbWFpbHMpOworQGZpeGVzID0gdW5pcShAZml4ZXMpOworCitteSAl
ZW1haWxfaGFzaF9uYW1lOworbXkgJWVtYWlsX2hhc2hfYWRkcmVzczsKK215IEBlbWFpbF90byA9
ICgpOworbXkgJWhhc2hfbGlzdF90bzsKK215IEBsaXN0X3RvID0gKCk7CitteSBAc2NtID0gKCk7
CitteSBAd2ViID0gKCk7CitteSBAc3Vic3lzdGVtID0gKCk7CitteSBAc3RhdHVzID0gKCk7Citt
eSAlZGVkdXBsaWNhdGVfbmFtZV9oYXNoID0gKCk7CitteSAlZGVkdXBsaWNhdGVfYWRkcmVzc19o
YXNoID0gKCk7CisKK215IEBtYWludGFpbmVycyA9IGdldF9tYWludGFpbmVycygpOworaWYgKEBt
YWludGFpbmVycykgeworICAgIEBtYWludGFpbmVycyA9IG1lcmdlX2VtYWlsKEBtYWludGFpbmVy
cyk7CisgICAgb3V0cHV0KEBtYWludGFpbmVycyk7Cit9CisKK2lmICgkc2NtKSB7CisgICAgQHNj
bSA9IHVuaXEoQHNjbSk7CisgICAgb3V0cHV0KEBzY20pOworfQorCitpZiAoJHN0YXR1cykgewor
ICAgIEBzdGF0dXMgPSB1bmlxKEBzdGF0dXMpOworICAgIG91dHB1dChAc3RhdHVzKTsKK30KKwor
aWYgKCRzdWJzeXN0ZW0pIHsKKyAgICBAc3Vic3lzdGVtID0gdW5pcShAc3Vic3lzdGVtKTsKKyAg
ICBvdXRwdXQoQHN1YnN5c3RlbSk7Cit9CisKK2lmICgkd2ViKSB7CisgICAgQHdlYiA9IHVuaXEo
QHdlYik7CisgICAgb3V0cHV0KEB3ZWIpOworfQorCitleGl0KCRleGl0KTsKKworc3ViIHNlbGZf
dGVzdCB7CisgICAgbXkgQGxzZmlsZXMgPSAoKTsKKyAgICBteSBAZ29vZF9saW5rcyA9ICgpOwor
ICAgIG15IEBiYWRfbGlua3MgPSAoKTsKKyAgICBteSBAc2VjdGlvbl9oZWFkZXJzID0gKCk7Cisg
ICAgbXkgJGluZGV4ID0gMDsKKworICAgIEBsc2ZpbGVzID0gdmNzX2xpc3RfZmlsZXMoJGxrX3Bh
dGgpOworCisgICAgZm9yIG15ICR4IChAc2VsZl90ZXN0X2luZm8pIHsKKwkkaW5kZXgrKzsKKwor
CSMjIFNlY3Rpb24gaGVhZGVyIGR1cGxpY2F0aW9uIGFuZCBtaXNzaW5nIHNlY3Rpb24gY29udGVu
dAorCWlmICgoJHNlbGZfdGVzdCBlcSAiIiB8fCAkc2VsZl90ZXN0ID1+IC9cYnNlY3Rpb25zXGIv
KSAmJgorCSAgICAkeC0+e2xpbmV9ID1+IC9eXFNbXjpdLyAmJgorCSAgICBkZWZpbmVkICRzZWxm
X3Rlc3RfaW5mb1skaW5kZXhdICYmCisJICAgICRzZWxmX3Rlc3RfaW5mb1skaW5kZXhdLT57bGlu
ZX0gPX4gL14oW0EtWl0pOlxzKlxTLykgeworCSAgICBteSAkaGFzX1MgPSAwOworCSAgICBteSAk
aGFzX0YgPSAwOworCSAgICBteSAkaGFzX01MID0gMDsKKwkgICAgbXkgJHN0YXR1cyA9ICIiOwor
CSAgICBpZiAoZ3JlcChtQF5cUSR4LT57bGluZX1cRUAsIEBzZWN0aW9uX2hlYWRlcnMpKSB7CisJ
CXByaW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogZHVwbGljYXRlIHNlY3Rp
b24gaGVhZGVyXHQkeC0+e2xpbmV9XG4iKTsKKwkgICAgfSBlbHNlIHsKKwkJcHVzaChAc2VjdGlv
bl9oZWFkZXJzLCAkeC0+e2xpbmV9KTsKKwkgICAgfQorCSAgICBteSAkbmV4dGxpbmUgPSAkaW5k
ZXg7CisJICAgIHdoaWxlIChkZWZpbmVkICRzZWxmX3Rlc3RfaW5mb1skbmV4dGxpbmVdICYmCisJ
CSAgICRzZWxmX3Rlc3RfaW5mb1skbmV4dGxpbmVdLT57bGluZX0gPX4gL14oW0EtWl0pOlxzKihc
Uy4qKS8pIHsKKwkJbXkgJHR5cGUgPSAkMTsKKwkJbXkgJHZhbHVlID0gJDI7CisJCWlmICgkdHlw
ZSBlcSAiUyIpIHsKKwkJICAgICRoYXNfUyA9IDE7CisJCSAgICAkc3RhdHVzID0gJHZhbHVlOwor
CQl9IGVsc2lmICgkdHlwZSBlcSAiRiIgfHwgJHR5cGUgZXEgIk4iKSB7CisJCSAgICAkaGFzX0Yg
PSAxOworCQl9IGVsc2lmICgkdHlwZSBlcSAiTSIgfHwgJHR5cGUgZXEgIlIiIHx8ICR0eXBlIGVx
ICJMIikgeworCQkgICAgJGhhc19NTCA9IDE7CisJCX0KKwkJJG5leHRsaW5lKys7CisJICAgIH0K
KwkgICAgaWYgKCEkaGFzX01MICYmICRzdGF0dXMgIX4gL29ycGhhbnxvYnNvbGV0ZS9pKSB7CisJ
CXByaW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogc2VjdGlvbiB3aXRob3V0
IGVtYWlsIGFkZHJlc3NcdCR4LT57bGluZX1cbiIpOworCSAgICB9CisJICAgIGlmICghJGhhc19T
KSB7CisJCXByaW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogc2VjdGlvbiB3
aXRob3V0IHN0YXR1cyBcdCR4LT57bGluZX1cbiIpOworCSAgICB9CisJICAgIGlmICghJGhhc19G
KSB7CisJCXByaW50KCIkeC0+e2ZpbGV9OiR4LT57bGluZW5yfTogd2FybmluZzogc2VjdGlvbiB3
aXRob3V0IGZpbGUgcGF0dGVyblx0JHgtPntsaW5lfVxuIik7CisJICAgIH0KKwl9CisKKwluZXh0
IGlmICgkeC0+e2xpbmV9ICF+IC9eKFtBLVpdKTpccyooLiopLyk7CisKKwlteSAkdHlwZSA9ICQx
OworCW15ICR2YWx1ZSA9ICQyOworCisJIyMgRmlsZW5hbWUgcGF0dGVybiBtYXRjaGluZworCWlm
ICgoJHR5cGUgZXEgIkYiIHx8ICR0eXBlIGVxICJYIikgJiYKKwkgICAgKCRzZWxmX3Rlc3QgZXEg
IiIgfHwgJHNlbGZfdGVzdCA9fiAvXGJwYXR0ZXJuc1xiLykpIHsKKwkgICAgJHZhbHVlID1+IHNA
XC5AXFxcLkBnOyAgICAgICAjI0NvbnZlcnQgLiB0byBcLgorCSAgICAkdmFsdWUgPX4gcy9cKi9c
LlwqL2c7ICAgICAgICMjQ29udmVydCAqIHRvIC4qCisJICAgICR2YWx1ZSA9fiBzL1w/L1wuL2c7
ICAgICAgICAgIyNDb252ZXJ0ID8gdG8gLgorCSAgICAjI2lmIHBhdHRlcm4gaXMgYSBkaXJlY3Rv
cnkgYW5kIGl0IGxhY2tzIGEgdHJhaWxpbmcgc2xhc2gsIGFkZCBvbmUKKwkgICAgaWYgKCgtZCAk
dmFsdWUpKSB7CisJCSR2YWx1ZSA9fiBzQChbXi9dKSRAJDEvQDsKKwkgICAgfQorCSAgICBpZiAo
IWdyZXAobUBeJHZhbHVlQCwgQGxzZmlsZXMpKSB7CisJCXByaW50KCIkeC0+e2ZpbGV9OiR4LT57
bGluZW5yfTogd2FybmluZzogbm8gZmlsZSBtYXRjaGVzXHQkeC0+e2xpbmV9XG4iKTsKKwkgICAg
fQorCisJIyMgTGluayByZWFjaGFiaWxpdHkKKwl9IGVsc2lmICgoJHR5cGUgZXEgIlciIHx8ICR0
eXBlIGVxICJRIiB8fCAkdHlwZSBlcSAiQiIpICYmCisJCSAkdmFsdWUgPX4gL15odHRwcz86LyAm
JgorCQkgKCRzZWxmX3Rlc3QgZXEgIiIgfHwgJHNlbGZfdGVzdCA9fiAvXGJsaW5rc1xiLykpIHsK
KwkgICAgbmV4dCBpZiAoZ3JlcChtQF5cUSR2YWx1ZVxFJEAsIEBnb29kX2xpbmtzKSk7CisJICAg
IG15ICRpc2JhZCA9IDA7CisJICAgIGlmIChncmVwKG1AXlxRJHZhbHVlXEUkQCwgQGJhZF9saW5r
cykpIHsKKwkgICAgICAgICRpc2JhZCA9IDE7CisJICAgIH0gZWxzZSB7CisJCW15ICRvdXRwdXQg
PSBgd2dldCAtLXNwaWRlciAtcSAtLW5vLWNoZWNrLWNlcnRpZmljYXRlIC0tdGltZW91dCAxMCAt
LXRyaWVzIDEgJHZhbHVlYDsKKwkJaWYgKCQ/ID09IDApIHsKKwkJICAgIHB1c2goQGdvb2RfbGlu
a3MsICR2YWx1ZSk7CisJCX0gZWxzZSB7CisJCSAgICBwdXNoKEBiYWRfbGlua3MsICR2YWx1ZSk7
CisJCSAgICAkaXNiYWQgPSAxOworCQl9CisJICAgIH0KKwkgICAgaWYgKCRpc2JhZCkgeworCSAg
ICAgICAgcHJpbnQoIiR4LT57ZmlsZX06JHgtPntsaW5lbnJ9OiB3YXJuaW5nOiBwb3NzaWJsZSBi
YWQgbGlua1x0JHgtPntsaW5lfVxuIik7CisJICAgIH0KKworCSMjIFNDTSByZWFjaGFiaWxpdHkK
Kwl9IGVsc2lmICgkdHlwZSBlcSAiVCIgJiYKKwkJICgkc2VsZl90ZXN0IGVxICIiIHx8ICRzZWxm
X3Rlc3QgPX4gL1xic2NtXGIvKSkgeworCSAgICBuZXh0IGlmIChncmVwKG1AXlxRJHZhbHVlXEUk
QCwgQGdvb2RfbGlua3MpKTsKKwkgICAgbXkgJGlzYmFkID0gMDsKKwkgICAgaWYgKGdyZXAobUBe
XFEkdmFsdWVcRSRALCBAYmFkX2xpbmtzKSkgeworCSAgICAgICAgJGlzYmFkID0gMTsKKyAgICAg
ICAgICAgIH0gZWxzaWYgKCR2YWx1ZSAhfiAvXig/OmdpdHxxdWlsdHxoZylccytcUy8pIHsKKwkJ
cHJpbnQoIiR4LT57ZmlsZX06JHgtPntsaW5lbnJ9OiB3YXJuaW5nOiBtYWxmb3JtZWQgZW50cnlc
dCR4LT57bGluZX1cbiIpOworCSAgICB9IGVsc2lmICgkdmFsdWUgPX4gL15naXRccysoXFMrKShc
cysoW15cKF0rXFMrKSk/LykgeworCQlteSAkdXJsID0gJDE7CisJCW15ICRicmFuY2ggPSAiIjsK
KwkJJGJyYW5jaCA9ICQzIGlmICQzOworCQlteSAkb3V0cHV0ID0gYGdpdCBscy1yZW1vdGUgLS1l
eGl0LWNvZGUgLWggIiR1cmwiICRicmFuY2ggPiAvZGV2L251bGwgMj4mMWA7CisJCWlmICgkPyA9
PSAwKSB7CisJCSAgICBwdXNoKEBnb29kX2xpbmtzLCAkdmFsdWUpOworCQl9IGVsc2UgeworCQkg
ICAgcHVzaChAYmFkX2xpbmtzLCAkdmFsdWUpOworCQkgICAgJGlzYmFkID0gMTsKKwkJfQorCSAg
ICB9IGVsc2lmICgkdmFsdWUgPX4gL14oPzpxdWlsdHxoZylccysoaHR0cHM/OlxTKykvKSB7CisJ
CW15ICR1cmwgPSAkMTsKKwkJbXkgJG91dHB1dCA9IGB3Z2V0IC0tc3BpZGVyIC1xIC0tbm8tY2hl
Y2stY2VydGlmaWNhdGUgLS10aW1lb3V0IDEwIC0tdHJpZXMgMSAkdXJsYDsKKwkJaWYgKCQ/ID09
IDApIHsKKwkJICAgIHB1c2goQGdvb2RfbGlua3MsICR2YWx1ZSk7CisJCX0gZWxzZSB7CisJCSAg
ICBwdXNoKEBiYWRfbGlua3MsICR2YWx1ZSk7CisJCSAgICAkaXNiYWQgPSAxOworCQl9CisJICAg
IH0KKwkgICAgaWYgKCRpc2JhZCkgeworCQlwcmludCgiJHgtPntmaWxlfTokeC0+e2xpbmVucn06
IHdhcm5pbmc6IHBvc3NpYmxlIGJhZCBsaW5rXHQkeC0+e2xpbmV9XG4iKTsKKwkgICAgfQorCX0K
KyAgICB9Cit9CisKK3N1YiBpZ25vcmVfZW1haWxfYWRkcmVzcyB7CisgICAgbXkgKCRhZGRyZXNz
KSA9IEBfOworCisgICAgZm9yZWFjaCBteSAkaWdub3JlIChAaWdub3JlX2VtYWlscykgeworCXJl
dHVybiAxIGlmICgkaWdub3JlIGVxICRhZGRyZXNzKTsKKyAgICB9CisKKyAgICByZXR1cm4gMDsK
K30KKworc3ViIHJhbmdlX2lzX21haW50YWluZWQgeworICAgIG15ICgkc3RhcnQsICRlbmQpID0g
QF87CisKKyAgICBmb3IgKG15ICRpID0gJHN0YXJ0OyAkaSA8ICRlbmQ7ICRpKyspIHsKKwlteSAk
bGluZSA9ICR0eXBldmFsdWVbJGldOworCWlmICgkbGluZSA9fiBtL14oW0EtWl0pOlxzKiguKikv
KSB7CisJICAgIG15ICR0eXBlID0gJDE7CisJICAgIG15ICR2YWx1ZSA9ICQyOworCSAgICBpZiAo
JHR5cGUgZXEgJ1MnKSB7CisJCWlmICgkdmFsdWUgPX4gLyhtYWludGFpbnxzdXBwb3J0KS9pKSB7
CisJCSAgICByZXR1cm4gMTsKKwkJfQorCSAgICB9CisJfQorICAgIH0KKyAgICByZXR1cm4gMDsK
K30KKworc3ViIHJhbmdlX2hhc19tYWludGFpbmVyIHsKKyAgICBteSAoJHN0YXJ0LCAkZW5kKSA9
IEBfOworCisgICAgZm9yIChteSAkaSA9ICRzdGFydDsgJGkgPCAkZW5kOyAkaSsrKSB7CisJbXkg
JGxpbmUgPSAkdHlwZXZhbHVlWyRpXTsKKwlpZiAoJGxpbmUgPX4gbS9eKFtBLVpdKTpccyooLiop
LykgeworCSAgICBteSAkdHlwZSA9ICQxOworCSAgICBteSAkdmFsdWUgPSAkMjsKKwkgICAgaWYg
KCR0eXBlIGVxICdNJykgeworCQlyZXR1cm4gMTsKKwkgICAgfQorCX0KKyAgICB9CisgICAgcmV0
dXJuIDA7Cit9CisKK3N1YiBnZXRfbWFpbnRhaW5lcnMgeworICAgICVlbWFpbF9oYXNoX25hbWUg
PSAoKTsKKyAgICAlZW1haWxfaGFzaF9hZGRyZXNzID0gKCk7CisgICAgJWNvbW1pdF9hdXRob3Jf
aGFzaCA9ICgpOworICAgICVjb21taXRfc2lnbmVyX2hhc2ggPSAoKTsKKyAgICBAZW1haWxfdG8g
PSAoKTsKKyAgICAlaGFzaF9saXN0X3RvID0gKCk7CisgICAgQGxpc3RfdG8gPSAoKTsKKyAgICBA
c2NtID0gKCk7CisgICAgQHdlYiA9ICgpOworICAgIEBzdWJzeXN0ZW0gPSAoKTsKKyAgICBAc3Rh
dHVzID0gKCk7CisgICAgJWRlZHVwbGljYXRlX25hbWVfaGFzaCA9ICgpOworICAgICVkZWR1cGxp
Y2F0ZV9hZGRyZXNzX2hhc2ggPSAoKTsKKyAgICBpZiAoJGVtYWlsX2dpdF9hbGxfc2lnbmF0dXJl
X3R5cGVzKSB7CisJJHNpZ25hdHVyZV9wYXR0ZXJuID0gIiguKz8pW0JiXVtZeV06IjsKKyAgICB9
IGVsc2UgeworCSRzaWduYXR1cmVfcGF0dGVybiA9ICJcKCIgLiBqb2luKCJ8IiwgQHNpZ25hdHVy
ZV90YWdzKSAuICJcKSI7CisgICAgfQorCisgICAgIyBGaW5kIHJlc3BvbnNpYmxlIHBhcnRpZXMK
KworICAgIG15ICVleGFjdF9wYXR0ZXJuX21hdGNoX2hhc2ggPSAoKTsKKworICAgIGZvcmVhY2gg
bXkgJGZpbGUgKEBmaWxlcykgeworCisJbXkgJWhhc2g7CisJbXkgJHR2aSA9IGZpbmRfZmlyc3Rf
c2VjdGlvbigpOworCXdoaWxlICgkdHZpIDwgQHR5cGV2YWx1ZSkgeworCSAgICBteSAkc3RhcnQg
PSBmaW5kX3N0YXJ0aW5nX2luZGV4KCR0dmkpOworCSAgICBteSAkZW5kID0gZmluZF9lbmRpbmdf
aW5kZXgoJHR2aSk7CisJICAgIG15ICRleGNsdWRlID0gMDsKKwkgICAgbXkgJGk7CisKKwkgICAg
I0RvIG5vdCBtYXRjaCBleGNsdWRlZCBmaWxlIHBhdHRlcm5zCisKKwkgICAgZm9yICgkaSA9ICRz
dGFydDsgJGkgPCAkZW5kOyAkaSsrKSB7CisJCW15ICRsaW5lID0gJHR5cGV2YWx1ZVskaV07CisJ
CWlmICgkbGluZSA9fiBtL14oW0EtWl0pOlxzKiguKikvKSB7CisJCSAgICBteSAkdHlwZSA9ICQx
OworCQkgICAgbXkgJHZhbHVlID0gJDI7CisJCSAgICBpZiAoJHR5cGUgZXEgJ1gnKSB7CisJCQlp
ZiAoZmlsZV9tYXRjaF9wYXR0ZXJuKCRmaWxlLCAkdmFsdWUpKSB7CisJCQkgICAgJGV4Y2x1ZGUg
PSAxOworCQkJICAgIGxhc3Q7CisJCQl9CisJCSAgICB9CisJCX0KKwkgICAgfQorCisJICAgIGlm
ICghJGV4Y2x1ZGUpIHsKKwkJZm9yICgkaSA9ICRzdGFydDsgJGkgPCAkZW5kOyAkaSsrKSB7CisJ
CSAgICBteSAkbGluZSA9ICR0eXBldmFsdWVbJGldOworCQkgICAgaWYgKCRsaW5lID1+IG0vXihb
QS1aXSk6XHMqKC4qKS8pIHsKKwkJCW15ICR0eXBlID0gJDE7CisJCQlteSAkdmFsdWUgPSAkMjsK
KwkJCWlmICgkdHlwZSBlcSAnRicpIHsKKwkJCSAgICBpZiAoZmlsZV9tYXRjaF9wYXR0ZXJuKCRm
aWxlLCAkdmFsdWUpKSB7CisJCQkJbXkgJHZhbHVlX3BkID0gKCR2YWx1ZSA9fiB0ckAvQEApOwor
CQkJCW15ICRmaWxlX3BkID0gKCRmaWxlICA9fiB0ckAvQEApOworCQkJCSR2YWx1ZV9wZCsrIGlm
IChzdWJzdHIoJHZhbHVlLC0xLDEpIG5lICIvIik7CisJCQkJJHZhbHVlX3BkID0gLTEgaWYgKCR2
YWx1ZSA9fiAvXlwuXCovKTsKKwkJCQlpZiAoJHZhbHVlX3BkID49ICRmaWxlX3BkICYmCisJCQkJ
ICAgIHJhbmdlX2lzX21haW50YWluZWQoJHN0YXJ0LCAkZW5kKSAmJgorCQkJCSAgICByYW5nZV9o
YXNfbWFpbnRhaW5lcigkc3RhcnQsICRlbmQpKSB7CisJCQkJICAgICRleGFjdF9wYXR0ZXJuX21h
dGNoX2hhc2h7JGZpbGV9ID0gMTsKKwkJCQl9CisJCQkJaWYgKCRwYXR0ZXJuX2RlcHRoID09IDAg
fHwKKwkJCQkgICAgKCgkZmlsZV9wZCAtICR2YWx1ZV9wZCkgPCAkcGF0dGVybl9kZXB0aCkpIHsK
KwkJCQkgICAgJGhhc2h7JHR2aX0gPSAkdmFsdWVfcGQ7CisJCQkJfQorCQkJICAgIH0KKwkJCX0g
ZWxzaWYgKCR0eXBlIGVxICdOJykgeworCQkJICAgIGlmICgkZmlsZSA9fiBtLyR2YWx1ZS94KSB7
CisJCQkJJGhhc2h7JHR2aX0gPSAwOworCQkJICAgIH0KKwkJCX0KKwkJICAgIH0KKwkJfQorCSAg
ICB9CisJICAgICR0dmkgPSAkZW5kICsgMTsKKwl9CisKKwlmb3JlYWNoIG15ICRsaW5lIChzb3J0
IHskaGFzaHskYn0gPD0+ICRoYXNoeyRhfX0ga2V5cyAlaGFzaCkgeworCSAgICBhZGRfY2F0ZWdv
cmllcygkbGluZSk7CisJICAgIGlmICgkc2VjdGlvbnMpIHsKKwkJbXkgJGk7CisJCW15ICRzdGFy
dCA9IGZpbmRfc3RhcnRpbmdfaW5kZXgoJGxpbmUpOworCQlteSAkZW5kID0gZmluZF9lbmRpbmdf
aW5kZXgoJGxpbmUpOworCQlmb3IgKCRpID0gJHN0YXJ0OyAkaSA8ICRlbmQ7ICRpKyspIHsKKwkJ
ICAgIG15ICRsaW5lID0gJHR5cGV2YWx1ZVskaV07CisJCSAgICBpZiAoJGxpbmUgPX4gL15bRlhd
Oi8pIHsJCSMjUmVzdG9yZSBmaWxlIHBhdHRlcm5zCisJCQkkbGluZSA9fiBzLyhbXlxcXSlcLihb
XlwqXSkvJDFcPyQyL2c7CisJCQkkbGluZSA9fiBzLyhbXlxcXSlcLiQvJDFcPy9nOwkjI0NvbnZl
cnQgLiBiYWNrIHRvID8KKwkJCSRsaW5lID1+IHMvXFxcLi9cLi9nOyAgICAgICAJIyNDb252ZXJ0
IFwuIHRvIC4KKwkJCSRsaW5lID1+IHMvXC5cKi9cKi9nOyAgICAgICAJIyNDb252ZXJ0IC4qIHRv
ICoKKwkJICAgIH0KKwkJICAgIG15ICRjb3VudCA9ICRsaW5lID1+IHMvXihbQS1aXSk6LyQxOlx0
L2c7CisJCSAgICBpZiAoJGxldHRlcnMgZXEgIiIgfHwgKCEkY291bnQgfHwgJGxldHRlcnMgPX4g
LyQxL2kpKSB7CisJCQlwcmludCgiJGxpbmVcbiIpOworCQkgICAgfQorCQl9CisJCXByaW50KCJc
biIpOworCSAgICB9CisJfQorCisJbWFpbnRhaW5lcnNfaW5fZmlsZSgkZmlsZSk7CisgICAgfQor
CisgICAgaWYgKCRrZXl3b3JkcykgeworCUBrZXl3b3JkX3R2aSA9IHNvcnRfYW5kX3VuaXEoQGtl
eXdvcmRfdHZpKTsKKwlmb3JlYWNoIG15ICRsaW5lIChAa2V5d29yZF90dmkpIHsKKwkgICAgYWRk
X2NhdGVnb3JpZXMoJGxpbmUpOworCX0KKyAgICB9CisKKyAgICBmb3JlYWNoIG15ICRlbWFpbCAo
QGVtYWlsX3RvLCBAbGlzdF90bykgeworCSRlbWFpbC0+WzBdID0gZGVkdXBsaWNhdGVfZW1haWwo
JGVtYWlsLT5bMF0pOworICAgIH0KKworICAgIGZvcmVhY2ggbXkgJGZpbGUgKEBmaWxlcykgewor
CWlmICgkZW1haWwgJiYKKwkgICAgKCRlbWFpbF9naXQgfHwKKwkgICAgICgkZW1haWxfZ2l0X2Zh
bGxiYWNrICYmCisJICAgICAgJGZpbGUgIX4gL01BSU5UQUlORVJTJC8gJiYKKwkgICAgICAhJGV4
YWN0X3BhdHRlcm5fbWF0Y2hfaGFzaHskZmlsZX0pKSkgeworCSAgICB2Y3NfZmlsZV9zaWdub2Zm
cygkZmlsZSk7CisJfQorCWlmICgkZW1haWwgJiYgJGVtYWlsX2dpdF9ibGFtZSkgeworCSAgICB2
Y3NfZmlsZV9ibGFtZSgkZmlsZSk7CisJfQorICAgIH0KKworICAgIGlmICgkZW1haWwpIHsKKwlm
b3JlYWNoIG15ICRlbWFpbCAoQGZpbGVfZW1haWxzKSB7CisJICAgIG15ICgkbmFtZSwgJGFkZHJl
c3MpID0gcGFyc2VfZW1haWwoJGVtYWlsKTsKKworCSAgICBteSAkdG1wX2VtYWlsID0gZm9ybWF0
X2VtYWlsKCRuYW1lLCAkYWRkcmVzcywgJGVtYWlsX3VzZW5hbWUpOworCSAgICBwdXNoX2VtYWls
X2FkZHJlc3MoJHRtcF9lbWFpbCwgJycpOworCSAgICBhZGRfcm9sZSgkdG1wX2VtYWlsLCAnaW4g
ZmlsZScpOworCX0KKyAgICB9CisKKyAgICBmb3JlYWNoIG15ICRmaXggKEBmaXhlcykgeworCXZj
c19hZGRfY29tbWl0X3NpZ25lcnMoJGZpeCwgImJsYW1lZF9maXhlcyIpOworICAgIH0KKworICAg
IG15IEB0byA9ICgpOworICAgIGlmICgkZW1haWwgfHwgJGVtYWlsX2xpc3QpIHsKKwlpZiAoJGVt
YWlsKSB7CisJICAgIEB0byA9IChAdG8sIEBlbWFpbF90byk7CisJfQorCWlmICgkZW1haWxfbGlz
dCkgeworCSAgICBAdG8gPSAoQHRvLCBAbGlzdF90byk7CisJfQorICAgIH0KKworICAgIGlmICgk
aW50ZXJhY3RpdmUpIHsKKwlAdG8gPSBpbnRlcmFjdGl2ZV9nZXRfbWFpbnRhaW5lcnMoXEB0byk7
CisgICAgfQorCisgICAgcmV0dXJuIEB0bzsKK30KKworc3ViIGZpbGVfbWF0Y2hfcGF0dGVybiB7
CisgICAgbXkgKCRmaWxlLCAkcGF0dGVybikgPSBAXzsKKyAgICBpZiAoc3Vic3RyKCRwYXR0ZXJu
LCAtMSkgZXEgIi8iKSB7CisJaWYgKCRmaWxlID1+IG1AXiRwYXR0ZXJuQCkgeworCSAgICByZXR1
cm4gMTsKKwl9CisgICAgfSBlbHNlIHsKKwlpZiAoJGZpbGUgPX4gbUBeJHBhdHRlcm5AKSB7CisJ
ICAgIG15ICRzMSA9ICgkZmlsZSA9fiB0ckAvQEApOworCSAgICBteSAkczIgPSAoJHBhdHRlcm4g
PX4gdHJAL0BAKTsKKwkgICAgaWYgKCRzMSA9PSAkczIpIHsKKwkJcmV0dXJuIDE7CisJICAgIH0K
Kwl9CisgICAgfQorICAgIHJldHVybiAwOworfQorCitzdWIgdXNhZ2UgeworICAgIHByaW50IDw8
RU9UOwordXNhZ2U6ICRQIFtvcHRpb25zXSBwYXRjaGZpbGUKKyAgICAgICAkUCBbb3B0aW9uc10g
LWYgZmlsZXxkaXJlY3RvcnkKK3ZlcnNpb246ICRWCisKK01BSU5UQUlORVIgZmllbGQgc2VsZWN0
aW9uIG9wdGlvbnM6CisgIC0tZW1haWwgPT4gcHJpbnQgZW1haWwgYWRkcmVzcyhlcykgaWYgYW55
CisgICAgLS1naXQgPT4gaW5jbHVkZSByZWNlbnQgZ2l0IFwqLWJ5OiBzaWduZXJzCisgICAgLS1n
aXQtYWxsLXNpZ25hdHVyZS10eXBlcyA9PiBpbmNsdWRlIHNpZ25lcnMgcmVnYXJkbGVzcyBvZiBz
aWduYXR1cmUgdHlwZQorICAgICAgICBvciB1c2Ugb25seSAke3NpZ25hdHVyZV9wYXR0ZXJufSBz
aWduZXJzIChkZWZhdWx0OiAkZW1haWxfZ2l0X2FsbF9zaWduYXR1cmVfdHlwZXMpCisgICAgLS1n
aXQtZmFsbGJhY2sgPT4gdXNlIGdpdCB3aGVuIG5vIGV4YWN0IE1BSU5UQUlORVJTIHBhdHRlcm4g
KGRlZmF1bHQ6ICRlbWFpbF9naXRfZmFsbGJhY2spCisgICAgLS1naXQtbWluLXNpZ25hdHVyZXMg
PT4gbnVtYmVyIG9mIHNpZ25hdHVyZXMgcmVxdWlyZWQgKGRlZmF1bHQ6ICRlbWFpbF9naXRfbWlu
X3NpZ25hdHVyZXMpCisgICAgLS1naXQtbWF4LW1haW50YWluZXJzID0+IG1heGltdW0gbWFpbnRh
aW5lcnMgdG8gYWRkIChkZWZhdWx0OiAkZW1haWxfZ2l0X21heF9tYWludGFpbmVycykKKyAgICAt
LWdpdC1taW4tcGVyY2VudCA9PiBtaW5pbXVtIHBlcmNlbnRhZ2Ugb2YgY29tbWl0cyByZXF1aXJl
ZCAoZGVmYXVsdDogJGVtYWlsX2dpdF9taW5fcGVyY2VudCkKKyAgICAtLWdpdC1ibGFtZSA9PiB1
c2UgZ2l0IGJsYW1lIHRvIGZpbmQgbW9kaWZpZWQgY29tbWl0cyBmb3IgcGF0Y2ggb3IgZmlsZQor
ICAgIC0tZ2l0LWJsYW1lLXNpZ25hdHVyZXMgPT4gd2hlbiB1c2VkIHdpdGggLS1naXQtYmxhbWUs
IGFsc28gaW5jbHVkZSBhbGwgY29tbWl0IHNpZ25lcnMKKyAgICAtLWdpdC1zaW5jZSA9PiBnaXQg
aGlzdG9yeSB0byB1c2UgKGRlZmF1bHQ6ICRlbWFpbF9naXRfc2luY2UpCisgICAgLS1oZy1zaW5j
ZSA9PiBoZyBoaXN0b3J5IHRvIHVzZSAoZGVmYXVsdDogJGVtYWlsX2hnX3NpbmNlKQorICAgIC0t
aW50ZXJhY3RpdmUgPT4gZGlzcGxheSBhIG1lbnUgKG1vc3RseSB1c2VmdWwgaWYgdXNlZCB3aXRo
IHRoZSAtLWdpdCBvcHRpb24pCisgICAgLS1tID0+IGluY2x1ZGUgbWFpbnRhaW5lcihzKSBpZiBh
bnkKKyAgICAtLXIgPT4gaW5jbHVkZSByZXZpZXdlcihzKSBpZiBhbnkKKyAgICAtLW4gPT4gaW5j
bHVkZSBuYW1lICdGdWxsIE5hbWUgPGFkZHJcQGRvbWFpbi50bGQ+JworICAgIC0tbCA9PiBpbmNs
dWRlIGxpc3QocykgaWYgYW55CisgICAgLS1tb2RlcmF0ZWQgPT4gaW5jbHVkZSBtb2RlcmF0ZWQg
bGlzdHMocykgaWYgYW55IChkZWZhdWx0OiB0cnVlKQorICAgIC0tcyA9PiBpbmNsdWRlIHN1YnNj
cmliZXIgb25seSBsaXN0KHMpIGlmIGFueSAoZGVmYXVsdDogZmFsc2UpCisgICAgLS1yZW1vdmUt
ZHVwbGljYXRlcyA9PiBtaW5pbWl6ZSBkdXBsaWNhdGUgZW1haWwgbmFtZXMvYWRkcmVzc2VzCisg
ICAgLS1yb2xlcyA9PiBzaG93IHJvbGVzIChzdGF0dXM6c3Vic3lzdGVtLCBnaXQtc2lnbmVyLCBs
aXN0LCBldGMuLi4pCisgICAgLS1yb2xlc3RhdHMgPT4gc2hvdyByb2xlcyBhbmQgc3RhdGlzdGlj
cyAoY29tbWl0cy90b3RhbF9jb21taXRzLCAlKQorICAgIC0tZmlsZS1lbWFpbHMgPT4gYWRkIGVt
YWlsIGFkZHJlc3NlcyBmb3VuZCBpbiAtZiBmaWxlIChkZWZhdWx0OiAwIChvZmYpKQorICAgIC0t
Zml4ZXMgPT4gZm9yIHBhdGNoZXMsIGFkZCBzaWduYXR1cmVzIG9mIGNvbW1pdHMgd2l0aCAnRml4
ZXM6IDxjb21taXQ+JyAoZGVmYXVsdDogMSAob24pKQorICAtLXNjbSA9PiBwcmludCBTQ00gdHJl
ZShzKSBpZiBhbnkKKyAgLS1zdGF0dXMgPT4gcHJpbnQgc3RhdHVzIGlmIGFueQorICAtLXN1YnN5
c3RlbSA9PiBwcmludCBzdWJzeXN0ZW0gbmFtZSBpZiBhbnkKKyAgLS13ZWIgPT4gcHJpbnQgd2Vi
c2l0ZShzKSBpZiBhbnkKKworT3V0cHV0IHR5cGUgb3B0aW9uczoKKyAgLS1zZXBhcmF0b3IgWywg
XSA9PiBzZXBhcmF0b3IgZm9yIG11bHRpcGxlIGVudHJpZXMgb24gMSBsaW5lCisgICAgdXNpbmcg
LS1zZXBhcmF0b3IgYWxzbyBzZXRzIC0tbm9tdWx0aWxpbmUgaWYgLS1zZXBhcmF0b3IgaXMgbm90
IFssIF0KKyAgLS1tdWx0aWxpbmUgPT4gcHJpbnQgMSBlbnRyeSBwZXIgbGluZQorCitPdGhlciBv
cHRpb25zOgorICAtLXBhdHRlcm4tZGVwdGggPT4gTnVtYmVyIG9mIHBhdHRlcm4gZGlyZWN0b3J5
IHRyYXZlcnNhbHMgKGRlZmF1bHQ6IDAgKGFsbCkpCisgIC0ta2V5d29yZHMgPT4gc2NhbiBwYXRj
aCBmb3Iga2V5d29yZHMgKGRlZmF1bHQ6ICRrZXl3b3JkcykKKyAgLS1zZWN0aW9ucyA9PiBwcmlu
dCBhbGwgb2YgdGhlIHN1YnN5c3RlbSBzZWN0aW9ucyB3aXRoIHBhdHRlcm4gbWF0Y2hlcworICAt
LWxldHRlcnMgPT4gcHJpbnQgYWxsIG1hdGNoaW5nICdsZXR0ZXInIHR5cGVzIGZyb20gYWxsIG1h
dGNoaW5nIHNlY3Rpb25zCisgIC0tbWFpbG1hcCA9PiB1c2UgLm1haWxtYXAgZmlsZSAoZGVmYXVs
dDogJGVtYWlsX3VzZV9tYWlsbWFwKQorICAtLW5vLXRyZWUgPT4gcnVuIHdpdGhvdXQgYSBrdm0t
dXNlci1zcGFjZSB0cmVlCisgIC0tc2VsZi10ZXN0ID0+IHNob3cgcG90ZW50aWFsIGlzc3VlcyB3
aXRoIE1BSU5UQUlORVJTIGZpbGUgY29udGVudAorICAtLXZlcnNpb24gPT4gc2hvdyB2ZXJzaW9u
CisgIC0taGVscCA9PiBzaG93IHRoaXMgaGVscCBpbmZvcm1hdGlvbgorCitEZWZhdWx0IG9wdGlv
bnM6CisgIFstLWVtYWlsIC0tdHJlZSAtLW5vZ2l0IC0tZ2l0LWZhbGxiYWNrIC0tbSAtLXIgLS1u
IC0tbCAtLW11bHRpbGluZQorICAgLS1wYXR0ZXJuLWRlcHRoPTAgLS1yZW1vdmUtZHVwbGljYXRl
cyAtLXJvbGVzdGF0c10KKworTm90ZXM6CisgIFVzaW5nICItZiBkaXJlY3RvcnkiIG1heSBnaXZl
IHVuZXhwZWN0ZWQgcmVzdWx0czoKKyAgICAgIFVzZWQgd2l0aCAiLS1naXQiLCBnaXQgc2lnbmF0
b3JzIGZvciBfYWxsXyBmaWxlcyBpbiBhbmQgYmVsb3cKKyAgICAgICAgICBkaXJlY3RvcnkgYXJl
IGV4YW1pbmVkIGFzIGdpdCByZWN1cnNlcyBkaXJlY3Rvcmllcy4KKyAgICAgICAgICBBbnkgc3Bl
Y2lmaWVkIFg6IChleGNsdWRlKSBwYXR0ZXJuIG1hdGNoZXMgYXJlIF9ub3RfIGlnbm9yZWQuCisg
ICAgICBVc2VkIHdpdGggIi0tbm9naXQiLCBkaXJlY3RvcnkgaXMgdXNlZCBhcyBhIHBhdHRlcm4g
bWF0Y2gsCisgICAgICAgICAgbm8gaW5kaXZpZHVhbCBmaWxlIHdpdGhpbiB0aGUgZGlyZWN0b3J5
IG9yIHN1YmRpcmVjdG9yeQorICAgICAgICAgIGlzIG1hdGNoZWQuCisgICAgICBVc2VkIHdpdGgg
Ii0tZ2l0LWJsYW1lIiwgZG9lcyBub3QgaXRlcmF0ZSBhbGwgZmlsZXMgaW4gZGlyZWN0b3J5Cisg
IFVzaW5nICItLWdpdC1ibGFtZSIgaXMgc2xvdyBhbmQgbWF5IGFkZCBvbGQgY29tbWl0dGVycyBh
bmQgYXV0aG9ycworICAgICAgdGhhdCBhcmUgbm8gbG9uZ2VyIGFjdGl2ZSBtYWludGFpbmVycyB0
byB0aGUgb3V0cHV0LgorICBVc2luZyAiLS1yb2xlcyIgb3IgIi0tcm9sZXN0YXRzIiB3aXRoIGdp
dCBzZW5kLWVtYWlsIC0tY2MtY21kIG9yIGFueQorICAgICAgb3RoZXIgYXV0b21hdGVkIHRvb2xz
IHRoYXQgZXhwZWN0IG9ubHkgWyJuYW1lIl0gPGVtYWlsIGFkZHJlc3M+CisgICAgICBtYXkgbm90
IHdvcmsgYmVjYXVzZSBvZiBhZGRpdGlvbmFsIG91dHB1dCBhZnRlciA8ZW1haWwgYWRkcmVzcz4u
CisgIFVzaW5nICItLXJvbGVzdGF0cyIgYW5kICItLWdpdC1ibGFtZSIgc2hvd3MgdGhlICMvdG90
YWw9JSBjb21taXRzLAorICAgICAgbm90IHRoZSBwZXJjZW50YWdlIG9mIHRoZSBlbnRpcmUgZmls
ZSBhdXRob3JlZC4gICMgb2YgY29tbWl0cyBpcworICAgICAgbm90IGEgZ29vZCBtZWFzdXJlIG9m
IGFtb3VudCBvZiBjb2RlIGF1dGhvcmVkLiAgMSBtYWpvciBjb21taXQgbWF5CisgICAgICBjb250
YWluIGEgdGhvdXNhbmQgbGluZXMsIDUgdHJpdmlhbCBjb21taXRzIG1heSBtb2RpZnkgYSBzaW5n
bGUgbGluZS4KKyAgSWYgZ2l0IGlzIG5vdCBpbnN0YWxsZWQsIGJ1dCBtZXJjdXJpYWwgKGhnKSBp
cyBpbnN0YWxsZWQgYW5kIGFuIC5oZworICAgICAgcmVwb3NpdG9yeSBleGlzdHMsIHRoZSBmb2xs
b3dpbmcgb3B0aW9ucyBhcHBseSB0byBtZXJjdXJpYWw6CisgICAgICAgICAgLS1naXQsCisgICAg
ICAgICAgLS1naXQtbWluLXNpZ25hdHVyZXMsIC0tZ2l0LW1heC1tYWludGFpbmVycywgLS1naXQt
bWluLXBlcmNlbnQsIGFuZAorICAgICAgICAgIC0tZ2l0LWJsYW1lCisgICAgICBVc2UgLS1oZy1z
aW5jZSBub3QgLS1naXQtc2luY2UgdG8gY29udHJvbCBkYXRlIHNlbGVjdGlvbgorICBGaWxlICIu
Z2V0X21haW50YWluZXIuY29uZiIsIGlmIGl0IGV4aXN0cyBpbiB0aGUga3ZtLXVuaXQtdGVzdHMg
c291cmNlIHJvb3QKKyAgICAgIGRpcmVjdG9yeSwgY2FuIGNoYW5nZSB3aGF0ZXZlciBnZXRfbWFp
bnRhaW5lciBkZWZhdWx0cyBhcmUgZGVzaXJlZC4KKyAgICAgIEVudHJpZXMgaW4gdGhpcyBmaWxl
IGNhbiBiZSBhbnkgY29tbWFuZCBsaW5lIGFyZ3VtZW50LgorICAgICAgVGhpcyBmaWxlIGlzIHBy
ZXBlbmRlZCB0byBhbnkgYWRkaXRpb25hbCBjb21tYW5kIGxpbmUgYXJndW1lbnRzLgorICAgICAg
TXVsdGlwbGUgbGluZXMgYW5kICMgY29tbWVudHMgYXJlIGFsbG93ZWQuCisgIE1vc3Qgb3B0aW9u
cyBoYXZlIGJvdGggcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIGZvcm1zLgorICAgICAgVGhlIG5lZ2F0
aXZlIGZvcm1zIGZvciAtLTxmb28+IGFyZSAtLW5vPGZvbz4gYW5kIC0tbm8tPGZvbz4uCisKK0VP
VAorfQorCitzdWIgcGFyc2VfZW1haWwgeworICAgIG15ICgkZm9ybWF0dGVkX2VtYWlsKSA9IEBf
OworCisgICAgbXkgJG5hbWUgPSAiIjsKKyAgICBteSAkYWRkcmVzcyA9ICIiOworCisgICAgaWYg
KCRmb3JtYXR0ZWRfZW1haWwgPX4gL14oW148XSspPCguK1xALiopPi4qJC8pIHsKKwkkbmFtZSA9
ICQxOworCSRhZGRyZXNzID0gJDI7CisgICAgfSBlbHNpZiAoJGZvcm1hdHRlZF9lbWFpbCA9fiAv
XlxzKjwoLitcQFxTKik+LiokLykgeworCSRhZGRyZXNzID0gJDE7CisgICAgfSBlbHNpZiAoJGZv
cm1hdHRlZF9lbWFpbCA9fiAvXiguK1xAXFMqKS4qJC8pIHsKKwkkYWRkcmVzcyA9ICQxOworICAg
IH0KKworICAgICRuYW1lID1+IHMvXlxzK3xccyskLy9nOworICAgICRuYW1lID1+IHMvXlwifFwi
JC8vZzsKKyAgICAkYWRkcmVzcyA9fiBzL15ccyt8XHMrJC8vZzsKKworICAgIGlmICgkbmFtZSA9
fiAvW15cdyBcLV0vaSkgeyAgCSAjI2hhcyAibXVzdCBxdW90ZSIgY2hhcnMKKwkkbmFtZSA9fiBz
Lyg/PCFcXCkiL1xcIi9nOyAgICAgICAjI2VzY2FwZSBxdW90ZXMKKwkkbmFtZSA9ICJcIiRuYW1l
XCIiOworICAgIH0KKworICAgIHJldHVybiAoJG5hbWUsICRhZGRyZXNzKTsKK30KKworc3ViIGZv
cm1hdF9lbWFpbCB7CisgICAgbXkgKCRuYW1lLCAkYWRkcmVzcywgJHVzZW5hbWUpID0gQF87CisK
KyAgICBteSAkZm9ybWF0dGVkX2VtYWlsOworCisgICAgJG5hbWUgPX4gcy9eXHMrfFxzKyQvL2c7
CisgICAgJG5hbWUgPX4gcy9eXCJ8XCIkLy9nOworICAgICRhZGRyZXNzID1+IHMvXlxzK3xccysk
Ly9nOworCisgICAgaWYgKCRuYW1lID1+IC9bXlx3IFwtXS9pKSB7ICAgICAgICAgICMjaGFzICJt
dXN0IHF1b3RlIiBjaGFycworCSRuYW1lID1+IHMvKD88IVxcKSIvXFwiL2c7ICAgICAgICMjZXNj
YXBlIHF1b3RlcworCSRuYW1lID0gIlwiJG5hbWVcIiI7CisgICAgfQorCisgICAgaWYgKCR1c2Vu
YW1lKSB7CisJaWYgKCIkbmFtZSIgZXEgIiIpIHsKKwkgICAgJGZvcm1hdHRlZF9lbWFpbCA9ICIk
YWRkcmVzcyI7CisJfSBlbHNlIHsKKwkgICAgJGZvcm1hdHRlZF9lbWFpbCA9ICIkbmFtZSA8JGFk
ZHJlc3M+IjsKKwl9CisgICAgfSBlbHNlIHsKKwkkZm9ybWF0dGVkX2VtYWlsID0gJGFkZHJlc3M7
CisgICAgfQorCisgICAgcmV0dXJuICRmb3JtYXR0ZWRfZW1haWw7Cit9CisKK3N1YiBmaW5kX2Zp
cnN0X3NlY3Rpb24geworICAgIG15ICRpbmRleCA9IDA7CisKKyAgICB3aGlsZSAoJGluZGV4IDwg
QHR5cGV2YWx1ZSkgeworCW15ICR0diA9ICR0eXBldmFsdWVbJGluZGV4XTsKKwlpZiAoKCR0diA9
fiBtL14oW0EtWl0pOlxzKiguKikvKSkgeworCSAgICBsYXN0OworCX0KKwkkaW5kZXgrKzsKKyAg
ICB9CisKKyAgICByZXR1cm4gJGluZGV4OworfQorCitzdWIgZmluZF9zdGFydGluZ19pbmRleCB7
CisgICAgbXkgKCRpbmRleCkgPSBAXzsKKworICAgIHdoaWxlICgkaW5kZXggPiAwKSB7CisJbXkg
JHR2ID0gJHR5cGV2YWx1ZVskaW5kZXhdOworCWlmICghKCR0diA9fiBtL14oW0EtWl0pOlxzKigu
KikvKSkgeworCSAgICBsYXN0OworCX0KKwkkaW5kZXgtLTsKKyAgICB9CisKKyAgICByZXR1cm4g
JGluZGV4OworfQorCitzdWIgZmluZF9lbmRpbmdfaW5kZXggeworICAgIG15ICgkaW5kZXgpID0g
QF87CisKKyAgICB3aGlsZSAoJGluZGV4IDwgQHR5cGV2YWx1ZSkgeworCW15ICR0diA9ICR0eXBl
dmFsdWVbJGluZGV4XTsKKwlpZiAoISgkdHYgPX4gbS9eKFtBLVpdKTpccyooLiopLykpIHsKKwkg
ICAgbGFzdDsKKwl9CisJJGluZGV4Kys7CisgICAgfQorCisgICAgcmV0dXJuICRpbmRleDsKK30K
Kworc3ViIGdldF9zdWJzeXN0ZW1fbmFtZSB7CisgICAgbXkgKCRpbmRleCkgPSBAXzsKKworICAg
IG15ICRzdGFydCA9IGZpbmRfc3RhcnRpbmdfaW5kZXgoJGluZGV4KTsKKworICAgIG15ICRzdWJz
eXN0ZW0gPSAkdHlwZXZhbHVlWyRzdGFydF07CisgICAgaWYgKCRvdXRwdXRfc2VjdGlvbl9tYXhs
ZW4gJiYgbGVuZ3RoKCRzdWJzeXN0ZW0pID4gJG91dHB1dF9zZWN0aW9uX21heGxlbikgeworCSRz
dWJzeXN0ZW0gPSBzdWJzdHIoJHN1YnN5c3RlbSwgMCwgJG91dHB1dF9zZWN0aW9uX21heGxlbiAt
IDMpOworCSRzdWJzeXN0ZW0gPX4gcy9ccyokLy87CisJJHN1YnN5c3RlbSA9ICRzdWJzeXN0ZW0g
LiAiLi4uIjsKKyAgICB9CisgICAgcmV0dXJuICRzdWJzeXN0ZW07Cit9CisKK3N1YiBnZXRfbWFp
bnRhaW5lcl9yb2xlIHsKKyAgICBteSAoJGluZGV4KSA9IEBfOworCisgICAgbXkgJGk7CisgICAg
bXkgJHN0YXJ0ID0gZmluZF9zdGFydGluZ19pbmRleCgkaW5kZXgpOworICAgIG15ICRlbmQgPSBm
aW5kX2VuZGluZ19pbmRleCgkaW5kZXgpOworCisgICAgbXkgJHJvbGUgPSAidW5rbm93biI7Cisg
ICAgbXkgJHN1YnN5c3RlbSA9IGdldF9zdWJzeXN0ZW1fbmFtZSgkaW5kZXgpOworCisgICAgZm9y
ICgkaSA9ICRzdGFydCArIDE7ICRpIDwgJGVuZDsgJGkrKykgeworCW15ICR0diA9ICR0eXBldmFs
dWVbJGldOworCWlmICgkdHYgPX4gbS9eKFtBLVpdKTpccyooLiopLykgeworCSAgICBteSAkcHR5
cGUgPSAkMTsKKwkgICAgbXkgJHB2YWx1ZSA9ICQyOworCSAgICBpZiAoJHB0eXBlIGVxICJTIikg
eworCQkkcm9sZSA9ICRwdmFsdWU7CisJICAgIH0KKwl9CisgICAgfQorCisgICAgJHJvbGUgPSBs
Yygkcm9sZSk7CisgICAgaWYgICAgICAoJHJvbGUgZXEgInN1cHBvcnRlZCIpIHsKKwkkcm9sZSA9
ICJzdXBwb3J0ZXIiOworICAgIH0gZWxzaWYgKCRyb2xlIGVxICJtYWludGFpbmVkIikgeworCSRy
b2xlID0gIm1haW50YWluZXIiOworICAgIH0gZWxzaWYgKCRyb2xlIGVxICJvZGQgZml4ZXMiKSB7
CisJJHJvbGUgPSAib2RkIGZpeGVyIjsKKyAgICB9IGVsc2lmICgkcm9sZSBlcSAib3JwaGFuIikg
eworCSRyb2xlID0gIm9ycGhhbiBtaW5kZXIiOworICAgIH0gZWxzaWYgKCRyb2xlIGVxICJvYnNv
bGV0ZSIpIHsKKwkkcm9sZSA9ICJvYnNvbGV0ZSBtaW5kZXIiOworICAgIH0gZWxzaWYgKCRyb2xl
IGVxICJidXJpZWQgYWxpdmUgaW4gcmVwb3J0ZXJzIikgeworCSRyb2xlID0gImNoaWVmIHBlbmd1
aW4iOworICAgIH0KKworICAgIHJldHVybiAkcm9sZSAuICI6IiAuICRzdWJzeXN0ZW07Cit9CisK
K3N1YiBnZXRfbGlzdF9yb2xlIHsKKyAgICBteSAoJGluZGV4KSA9IEBfOworCisgICAgbXkgJHN1
YnN5c3RlbSA9IGdldF9zdWJzeXN0ZW1fbmFtZSgkaW5kZXgpOworCisgICAgaWYgKCRzdWJzeXN0
ZW0gZXEgIlRIRSBSRVNUIikgeworCSRzdWJzeXN0ZW0gPSAiIjsKKyAgICB9CisKKyAgICByZXR1
cm4gJHN1YnN5c3RlbTsKK30KKworc3ViIGFkZF9jYXRlZ29yaWVzIHsKKyAgICBteSAoJGluZGV4
KSA9IEBfOworCisgICAgbXkgJGk7CisgICAgbXkgJHN0YXJ0ID0gZmluZF9zdGFydGluZ19pbmRl
eCgkaW5kZXgpOworICAgIG15ICRlbmQgPSBmaW5kX2VuZGluZ19pbmRleCgkaW5kZXgpOworCisg
ICAgcHVzaChAc3Vic3lzdGVtLCAkdHlwZXZhbHVlWyRzdGFydF0pOworCisgICAgZm9yICgkaSA9
ICRzdGFydCArIDE7ICRpIDwgJGVuZDsgJGkrKykgeworCW15ICR0diA9ICR0eXBldmFsdWVbJGld
OworCWlmICgkdHYgPX4gbS9eKFtBLVpdKTpccyooLiopLykgeworCSAgICBteSAkcHR5cGUgPSAk
MTsKKwkgICAgbXkgJHB2YWx1ZSA9ICQyOworCSAgICBpZiAoJHB0eXBlIGVxICJMIikgeworCQlt
eSAkbGlzdF9hZGRyZXNzID0gJHB2YWx1ZTsKKwkJbXkgJGxpc3RfYWRkaXRpb25hbCA9ICIiOwor
CQlteSAkbGlzdF9yb2xlID0gZ2V0X2xpc3Rfcm9sZSgkaSk7CisKKwkJaWYgKCRsaXN0X3JvbGUg
bmUgIiIpIHsKKwkJICAgICRsaXN0X3JvbGUgPSAiOiIgLiAkbGlzdF9yb2xlOworCQl9CisJCWlm
ICgkbGlzdF9hZGRyZXNzID1+IG0vKFteXHNdKylccysoLiopJC8pIHsKKwkJICAgICRsaXN0X2Fk
ZHJlc3MgPSAkMTsKKwkJICAgICRsaXN0X2FkZGl0aW9uYWwgPSAkMjsKKwkJfQorCQlpZiAoJGxp
c3RfYWRkaXRpb25hbCA9fiBtL3N1YnNjcmliZXJzLW9ubHkvKSB7CisJCSAgICBpZiAoJGVtYWls
X3N1YnNjcmliZXJfbGlzdCkgeworCQkJaWYgKCEkaGFzaF9saXN0X3Rve2xjKCRsaXN0X2FkZHJl
c3MpfSkgeworCQkJICAgICRoYXNoX2xpc3RfdG97bGMoJGxpc3RfYWRkcmVzcyl9ID0gMTsKKwkJ
CSAgICBwdXNoKEBsaXN0X3RvLCBbJGxpc3RfYWRkcmVzcywKKwkJCQkJICAgICJzdWJzY3JpYmVy
IGxpc3Qke2xpc3Rfcm9sZX0iXSk7CisJCQl9CisJCSAgICB9CisJCX0gZWxzZSB7CisJCSAgICBp
ZiAoJGVtYWlsX2xpc3QpIHsKKwkJCWlmICghJGhhc2hfbGlzdF90b3tsYygkbGlzdF9hZGRyZXNz
KX0pIHsKKwkJCSAgICBpZiAoJGxpc3RfYWRkaXRpb25hbCA9fiBtL21vZGVyYXRlZC8pIHsKKwkJ
CQlpZiAoJGVtYWlsX21vZGVyYXRlZF9saXN0KSB7CisJCQkJICAgICRoYXNoX2xpc3RfdG97bGMo
JGxpc3RfYWRkcmVzcyl9ID0gMTsKKwkJCQkgICAgcHVzaChAbGlzdF90bywgWyRsaXN0X2FkZHJl
c3MsCisJCQkJCQkgICAgIm1vZGVyYXRlZCBsaXN0JHtsaXN0X3JvbGV9Il0pOworCQkJCX0KKwkJ
CSAgICB9IGVsc2UgeworCQkJCSRoYXNoX2xpc3RfdG97bGMoJGxpc3RfYWRkcmVzcyl9ID0gMTsK
KwkJCQlwdXNoKEBsaXN0X3RvLCBbJGxpc3RfYWRkcmVzcywKKwkJCQkJCSJvcGVuIGxpc3Qke2xp
c3Rfcm9sZX0iXSk7CisJCQkgICAgfQorCQkJfQorCQkgICAgfQorCQl9CisJICAgIH0gZWxzaWYg
KCRwdHlwZSBlcSAiTSIpIHsKKwkJaWYgKCRlbWFpbF9tYWludGFpbmVyKSB7CisJCSAgICBteSAk
cm9sZSA9IGdldF9tYWludGFpbmVyX3JvbGUoJGkpOworCQkgICAgcHVzaF9lbWFpbF9hZGRyZXNz
ZXMoJHB2YWx1ZSwgJHJvbGUpOworCQl9CisJICAgIH0gZWxzaWYgKCRwdHlwZSBlcSAiUiIpIHsK
KwkJaWYgKCRlbWFpbF9yZXZpZXdlcikgeworCQkgICAgbXkgJHN1YnN5c3RlbSA9IGdldF9zdWJz
eXN0ZW1fbmFtZSgkaSk7CisJCSAgICBwdXNoX2VtYWlsX2FkZHJlc3NlcygkcHZhbHVlLCAicmV2
aWV3ZXI6JHN1YnN5c3RlbSIpOworCQl9CisJICAgIH0gZWxzaWYgKCRwdHlwZSBlcSAiVCIpIHsK
KwkJcHVzaChAc2NtLCAkcHZhbHVlKTsKKwkgICAgfSBlbHNpZiAoJHB0eXBlIGVxICJXIikgewor
CQlwdXNoKEB3ZWIsICRwdmFsdWUpOworCSAgICB9IGVsc2lmICgkcHR5cGUgZXEgIlMiKSB7CisJ
CXB1c2goQHN0YXR1cywgJHB2YWx1ZSk7CisJICAgIH0KKwl9CisgICAgfQorfQorCitzdWIgZW1h
aWxfaW51c2UgeworICAgIG15ICgkbmFtZSwgJGFkZHJlc3MpID0gQF87CisKKyAgICByZXR1cm4g
MSBpZiAoKCRuYW1lIGVxICIiKSAmJiAoJGFkZHJlc3MgZXEgIiIpKTsKKyAgICByZXR1cm4gMSBp
ZiAoKCRuYW1lIG5lICIiKSAmJiBleGlzdHMoJGVtYWlsX2hhc2hfbmFtZXtsYygkbmFtZSl9KSk7
CisgICAgcmV0dXJuIDEgaWYgKCgkYWRkcmVzcyBuZSAiIikgJiYgZXhpc3RzKCRlbWFpbF9oYXNo
X2FkZHJlc3N7bGMoJGFkZHJlc3MpfSkpOworCisgICAgcmV0dXJuIDA7Cit9CisKK3N1YiBwdXNo
X2VtYWlsX2FkZHJlc3MgeworICAgIG15ICgkbGluZSwgJHJvbGUpID0gQF87CisKKyAgICBteSAo
JG5hbWUsICRhZGRyZXNzKSA9IHBhcnNlX2VtYWlsKCRsaW5lKTsKKworICAgIGlmICgkYWRkcmVz
cyBlcSAiIikgeworCXJldHVybiAwOworICAgIH0KKworICAgIGlmICghJGVtYWlsX3JlbW92ZV9k
dXBsaWNhdGVzKSB7CisJcHVzaChAZW1haWxfdG8sIFtmb3JtYXRfZW1haWwoJG5hbWUsICRhZGRy
ZXNzLCAkZW1haWxfdXNlbmFtZSksICRyb2xlXSk7CisgICAgfSBlbHNpZiAoIWVtYWlsX2ludXNl
KCRuYW1lLCAkYWRkcmVzcykpIHsKKwlwdXNoKEBlbWFpbF90bywgW2Zvcm1hdF9lbWFpbCgkbmFt
ZSwgJGFkZHJlc3MsICRlbWFpbF91c2VuYW1lKSwgJHJvbGVdKTsKKwkkZW1haWxfaGFzaF9uYW1l
e2xjKCRuYW1lKX0rKyBpZiAoJG5hbWUgbmUgIiIpOworCSRlbWFpbF9oYXNoX2FkZHJlc3N7bGMo
JGFkZHJlc3MpfSsrOworICAgIH0KKworICAgIHJldHVybiAxOworfQorCitzdWIgcHVzaF9lbWFp
bF9hZGRyZXNzZXMgeworICAgIG15ICgkYWRkcmVzcywgJHJvbGUpID0gQF87CisKKyAgICBteSBA
YWRkcmVzc19saXN0ID0gKCk7CisKKyAgICBpZiAocmZjODIyX3ZhbGlkKCRhZGRyZXNzKSkgewor
CXB1c2hfZW1haWxfYWRkcmVzcygkYWRkcmVzcywgJHJvbGUpOworICAgIH0gZWxzaWYgKEBhZGRy
ZXNzX2xpc3QgPSByZmM4MjJfdmFsaWRsaXN0KCRhZGRyZXNzKSkgeworCW15ICRhcnJheV9jb3Vu
dCA9IHNoaWZ0KEBhZGRyZXNzX2xpc3QpOworCXdoaWxlIChteSAkZW50cnkgPSBzaGlmdChAYWRk
cmVzc19saXN0KSkgeworCSAgICBwdXNoX2VtYWlsX2FkZHJlc3MoJGVudHJ5LCAkcm9sZSk7CisJ
fQorICAgIH0gZWxzZSB7CisJaWYgKCFwdXNoX2VtYWlsX2FkZHJlc3MoJGFkZHJlc3MsICRyb2xl
KSkgeworCSAgICB3YXJuKCJJbnZhbGlkIE1BSU5UQUlORVJTIGFkZHJlc3M6ICciIC4gJGFkZHJl
c3MgLiAiJ1xuIik7CisJfQorICAgIH0KK30KKworc3ViIGFkZF9yb2xlIHsKKyAgICBteSAoJGxp
bmUsICRyb2xlKSA9IEBfOworCisgICAgbXkgKCRuYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFp
bCgkbGluZSk7CisgICAgbXkgJGVtYWlsID0gZm9ybWF0X2VtYWlsKCRuYW1lLCAkYWRkcmVzcywg
JGVtYWlsX3VzZW5hbWUpOworCisgICAgZm9yZWFjaCBteSAkZW50cnkgKEBlbWFpbF90bykgewor
CWlmICgkZW1haWxfcmVtb3ZlX2R1cGxpY2F0ZXMpIHsKKwkgICAgbXkgKCRlbnRyeV9uYW1lLCAk
ZW50cnlfYWRkcmVzcykgPSBwYXJzZV9lbWFpbCgkZW50cnktPlswXSk7CisJICAgIGlmICgoJG5h
bWUgZXEgJGVudHJ5X25hbWUgfHwgJGFkZHJlc3MgZXEgJGVudHJ5X2FkZHJlc3MpCisJCSYmICgk
cm9sZSBlcSAiIiB8fCAhKCRlbnRyeS0+WzFdID1+IG0vJHJvbGUvKSkKKwkgICAgKSB7CisJCWlm
ICgkZW50cnktPlsxXSBlcSAiIikgeworCQkgICAgJGVudHJ5LT5bMV0gPSAiJHJvbGUiOworCQl9
IGVsc2UgeworCQkgICAgJGVudHJ5LT5bMV0gPSAiJGVudHJ5LT5bMV0sJHJvbGUiOworCQl9CisJ
ICAgIH0KKwl9IGVsc2UgeworCSAgICBpZiAoJGVtYWlsIGVxICRlbnRyeS0+WzBdCisJCSYmICgk
cm9sZSBlcSAiIiB8fCAhKCRlbnRyeS0+WzFdID1+IG0vJHJvbGUvKSkKKwkgICAgKSB7CisJCWlm
ICgkZW50cnktPlsxXSBlcSAiIikgeworCQkgICAgJGVudHJ5LT5bMV0gPSAiJHJvbGUiOworCQl9
IGVsc2UgeworCQkgICAgJGVudHJ5LT5bMV0gPSAiJGVudHJ5LT5bMV0sJHJvbGUiOworCQl9CisJ
ICAgIH0KKwl9CisgICAgfQorfQorCitzdWIgd2hpY2ggeworICAgIG15ICgkYmluKSA9IEBfOwor
CisgICAgZm9yZWFjaCBteSAkcGF0aCAoc3BsaXQoLzovLCAkRU5We1BBVEh9KSkgeworCWlmICgt
ZSAiJHBhdGgvJGJpbiIpIHsKKwkgICAgcmV0dXJuICIkcGF0aC8kYmluIjsKKwl9CisgICAgfQor
CisgICAgcmV0dXJuICIiOworfQorCitzdWIgd2hpY2hfY29uZiB7CisgICAgbXkgKCRjb25mKSA9
IEBfOworCisgICAgZm9yZWFjaCBteSAkcGF0aCAoc3BsaXQoLzovLCAiLjokRU5We0hPTUV9Oi5z
Y3JpcHRzIikpIHsKKwlpZiAoLWUgIiRwYXRoLyRjb25mIikgeworCSAgICByZXR1cm4gIiRwYXRo
LyRjb25mIjsKKwl9CisgICAgfQorCisgICAgcmV0dXJuICIiOworfQorCitzdWIgbWFpbG1hcF9l
bWFpbCB7CisgICAgbXkgKCRsaW5lKSA9IEBfOworCisgICAgbXkgKCRuYW1lLCAkYWRkcmVzcykg
PSBwYXJzZV9lbWFpbCgkbGluZSk7CisgICAgbXkgJGVtYWlsID0gZm9ybWF0X2VtYWlsKCRuYW1l
LCAkYWRkcmVzcywgMSk7CisgICAgbXkgJHJlYWxfbmFtZSA9ICRuYW1lOworICAgIG15ICRyZWFs
X2FkZHJlc3MgPSAkYWRkcmVzczsKKworICAgIGlmIChleGlzdHMgJG1haWxtYXAtPntuYW1lc30t
PnskZW1haWx9IHx8CisJZXhpc3RzICRtYWlsbWFwLT57YWRkcmVzc2VzfS0+eyRlbWFpbH0pIHsK
KwlpZiAoZXhpc3RzICRtYWlsbWFwLT57bmFtZXN9LT57JGVtYWlsfSkgeworCSAgICAkcmVhbF9u
YW1lID0gJG1haWxtYXAtPntuYW1lc30tPnskZW1haWx9OworCX0KKwlpZiAoZXhpc3RzICRtYWls
bWFwLT57YWRkcmVzc2VzfS0+eyRlbWFpbH0pIHsKKwkgICAgJHJlYWxfYWRkcmVzcyA9ICRtYWls
bWFwLT57YWRkcmVzc2VzfS0+eyRlbWFpbH07CisJfQorICAgIH0gZWxzZSB7CisJaWYgKGV4aXN0
cyAkbWFpbG1hcC0+e25hbWVzfS0+eyRhZGRyZXNzfSkgeworCSAgICAkcmVhbF9uYW1lID0gJG1h
aWxtYXAtPntuYW1lc30tPnskYWRkcmVzc307CisJfQorCWlmIChleGlzdHMgJG1haWxtYXAtPnth
ZGRyZXNzZXN9LT57JGFkZHJlc3N9KSB7CisJICAgICRyZWFsX2FkZHJlc3MgPSAkbWFpbG1hcC0+
e2FkZHJlc3Nlc30tPnskYWRkcmVzc307CisJfQorICAgIH0KKyAgICByZXR1cm4gZm9ybWF0X2Vt
YWlsKCRyZWFsX25hbWUsICRyZWFsX2FkZHJlc3MsIDEpOworfQorCitzdWIgbWFpbG1hcCB7Cisg
ICAgbXkgKEBhZGRyZXNzZXMpID0gQF87CisKKyAgICBteSBAbWFwcGVkX2VtYWlscyA9ICgpOwor
ICAgIGZvcmVhY2ggbXkgJGxpbmUgKEBhZGRyZXNzZXMpIHsKKwlwdXNoKEBtYXBwZWRfZW1haWxz
LCBtYWlsbWFwX2VtYWlsKCRsaW5lKSk7CisgICAgfQorICAgIG1lcmdlX2J5X3JlYWxuYW1lKEBt
YXBwZWRfZW1haWxzKSBpZiAoJGVtYWlsX3VzZV9tYWlsbWFwKTsKKyAgICByZXR1cm4gQG1hcHBl
ZF9lbWFpbHM7Cit9CisKK3N1YiBtZXJnZV9ieV9yZWFsbmFtZSB7CisgICAgbXkgJWFkZHJlc3Nf
bWFwOworICAgIG15IChAZW1haWxzKSA9IEBfOworCisgICAgZm9yZWFjaCBteSAkZW1haWwgKEBl
bWFpbHMpIHsKKwlteSAoJG5hbWUsICRhZGRyZXNzKSA9IHBhcnNlX2VtYWlsKCRlbWFpbCk7CisJ
aWYgKGV4aXN0cyAkYWRkcmVzc19tYXB7JG5hbWV9KSB7CisJICAgICRhZGRyZXNzID0gJGFkZHJl
c3NfbWFweyRuYW1lfTsKKwkgICAgJGVtYWlsID0gZm9ybWF0X2VtYWlsKCRuYW1lLCAkYWRkcmVz
cywgMSk7CisJfSBlbHNlIHsKKwkgICAgJGFkZHJlc3NfbWFweyRuYW1lfSA9ICRhZGRyZXNzOwor
CX0KKyAgICB9Cit9CisKK3N1YiBnaXRfZXhlY3V0ZV9jbWQgeworICAgIG15ICgkY21kKSA9IEBf
OworICAgIG15IEBsaW5lcyA9ICgpOworCisgICAgbXkgJG91dHB1dCA9IGAkY21kYDsKKyAgICAk
b3V0cHV0ID1+IHMvXlxzKi8vZ207CisgICAgQGxpbmVzID0gc3BsaXQoIlxuIiwgJG91dHB1dCk7
CisKKyAgICByZXR1cm4gQGxpbmVzOworfQorCitzdWIgaGdfZXhlY3V0ZV9jbWQgeworICAgIG15
ICgkY21kKSA9IEBfOworICAgIG15IEBsaW5lcyA9ICgpOworCisgICAgbXkgJG91dHB1dCA9IGAk
Y21kYDsKKyAgICBAbGluZXMgPSBzcGxpdCgiXG4iLCAkb3V0cHV0KTsKKworICAgIHJldHVybiBA
bGluZXM7Cit9CisKK3N1YiBleHRyYWN0X2Zvcm1hdHRlZF9zaWduYXR1cmVzIHsKKyAgICBteSAo
QHNpZ25hdHVyZV9saW5lcykgPSBAXzsKKworICAgIG15IEB0eXBlID0gQHNpZ25hdHVyZV9saW5l
czsKKworICAgIHMvXHMqKC4qKTouKi8kMS8gZm9yIChAdHlwZSk7CisKKyAgICAjIGN1dCAtZjIt
IC1kIjoiCisgICAgcy9ccyouKjpccyooLispXHMqLyQxLyBmb3IgKEBzaWduYXR1cmVfbGluZXMp
OworCisjIyBSZWZvcm1hdCBlbWFpbCBhZGRyZXNzZXMgKHdpdGggbmFtZXMpIHRvIGF2b2lkIGJh
ZGx5IHdyaXR0ZW4gc2lnbmF0dXJlcworCisgICAgZm9yZWFjaCBteSAkc2lnbmVyIChAc2lnbmF0
dXJlX2xpbmVzKSB7CisJJHNpZ25lciA9IGRlZHVwbGljYXRlX2VtYWlsKCRzaWduZXIpOworICAg
IH0KKworICAgIHJldHVybiAoXEB0eXBlLCBcQHNpZ25hdHVyZV9saW5lcyk7Cit9CisKK3N1YiB2
Y3NfZmluZF9zaWduZXJzIHsKKyAgICBteSAoJGNtZCwgJGZpbGUpID0gQF87CisgICAgbXkgJGNv
bW1pdHM7CisgICAgbXkgQGxpbmVzID0gKCk7CisgICAgbXkgQHNpZ25hdHVyZXMgPSAoKTsKKyAg
ICBteSBAYXV0aG9ycyA9ICgpOworICAgIG15IEBzdGF0cyA9ICgpOworCisgICAgQGxpbmVzID0g
JnskVkNTX2NtZHN7ImV4ZWN1dGVfY21kIn19KCRjbWQpOworCisgICAgbXkgJHBhdHRlcm4gPSAk
VkNTX2NtZHN7ImNvbW1pdF9wYXR0ZXJuIn07CisgICAgbXkgJGF1dGhvcl9wYXR0ZXJuID0gJFZD
U19jbWRzeyJhdXRob3JfcGF0dGVybiJ9OworICAgIG15ICRzdGF0X3BhdHRlcm4gPSAkVkNTX2Nt
ZHN7InN0YXRfcGF0dGVybiJ9OworCisgICAgJHN0YXRfcGF0dGVybiA9fiBzLyhcJFx3KykvJDEv
ZWVnOwkJI2ludGVycG9sYXRlICRzdGF0X3BhdHRlcm4KKworICAgICRjb21taXRzID0gZ3JlcCgv
JHBhdHRlcm4vLCBAbGluZXMpOwkjIG9mIGNvbW1pdHMKKworICAgIEBhdXRob3JzID0gZ3JlcCgv
JGF1dGhvcl9wYXR0ZXJuLywgQGxpbmVzKTsKKyAgICBAc2lnbmF0dXJlcyA9IGdyZXAoL15bIFx0
XSoke3NpZ25hdHVyZV9wYXR0ZXJufS4qXEAuKiQvLCBAbGluZXMpOworICAgIEBzdGF0cyA9IGdy
ZXAoLyRzdGF0X3BhdHRlcm4vLCBAbGluZXMpOworCisjICAgIHByaW50KCJzdGF0czogPEBzdGF0
cz5cbiIpOworCisgICAgcmV0dXJuICgwLCBcQHNpZ25hdHVyZXMsIFxAYXV0aG9ycywgXEBzdGF0
cykgaWYgIUBzaWduYXR1cmVzOworCisgICAgc2F2ZV9jb21taXRzX2J5X2F1dGhvcihAbGluZXMp
IGlmICgkaW50ZXJhY3RpdmUpOworICAgIHNhdmVfY29tbWl0c19ieV9zaWduZXIoQGxpbmVzKSBp
ZiAoJGludGVyYWN0aXZlKTsKKworICAgIG15ICgkYXV0aG9yX3JlZiwgJGF1dGhvcnNfcmVmKSA9
IGV4dHJhY3RfZm9ybWF0dGVkX3NpZ25hdHVyZXMoQGF1dGhvcnMpOworICAgIG15ICgkdHlwZXNf
cmVmLCAkc2lnbmVyc19yZWYpID0gZXh0cmFjdF9mb3JtYXR0ZWRfc2lnbmF0dXJlcyhAc2lnbmF0
dXJlcyk7CisKKyAgICByZXR1cm4gKCRjb21taXRzLCAkc2lnbmVyc19yZWYsICRhdXRob3JzX3Jl
ZiwgXEBzdGF0cyk7Cit9CisKK3N1YiB2Y3NfZmluZF9hdXRob3IgeworICAgIG15ICgkY21kKSA9
IEBfOworICAgIG15IEBsaW5lcyA9ICgpOworCisgICAgQGxpbmVzID0gJnskVkNTX2NtZHN7ImV4
ZWN1dGVfY21kIn19KCRjbWQpOworCisgICAgcmV0dXJuIEBsaW5lcyBpZiAhQGxpbmVzOworCisg
ICAgbXkgQGF1dGhvcnMgPSAoKTsKKyAgICBmb3JlYWNoIG15ICRsaW5lIChAbGluZXMpIHsKKwlp
ZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7ImF1dGhvcl9wYXR0ZXJuIn0vKSB7CisJICAgIG15ICRh
dXRob3IgPSAkMTsKKwkgICAgbXkgKCRuYW1lLCAkYWRkcmVzcykgPSBwYXJzZV9lbWFpbCgkYXV0
aG9yKTsKKwkgICAgJGF1dGhvciA9IGZvcm1hdF9lbWFpbCgkbmFtZSwgJGFkZHJlc3MsIDEpOwor
CSAgICBwdXNoKEBhdXRob3JzLCAkYXV0aG9yKTsKKwl9CisgICAgfQorCisgICAgc2F2ZV9jb21t
aXRzX2J5X2F1dGhvcihAbGluZXMpIGlmICgkaW50ZXJhY3RpdmUpOworICAgIHNhdmVfY29tbWl0
c19ieV9zaWduZXIoQGxpbmVzKSBpZiAoJGludGVyYWN0aXZlKTsKKworICAgIHJldHVybiBAYXV0
aG9yczsKK30KKworc3ViIHZjc19zYXZlX2NvbW1pdHMgeworICAgIG15ICgkY21kKSA9IEBfOwor
ICAgIG15IEBsaW5lcyA9ICgpOworICAgIG15IEBjb21taXRzID0gKCk7CisKKyAgICBAbGluZXMg
PSAmeyRWQ1NfY21kc3siZXhlY3V0ZV9jbWQifX0oJGNtZCk7CisKKyAgICBmb3JlYWNoIG15ICRs
aW5lIChAbGluZXMpIHsKKwlpZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7ImJsYW1lX2NvbW1pdF9w
YXR0ZXJuIn0vKSB7CisJICAgIHB1c2goQGNvbW1pdHMsICQxKTsKKwl9CisgICAgfQorCisgICAg
cmV0dXJuIEBjb21taXRzOworfQorCitzdWIgdmNzX2JsYW1lIHsKKyAgICBteSAoJGZpbGUpID0g
QF87CisgICAgbXkgJGNtZDsKKyAgICBteSBAY29tbWl0cyA9ICgpOworCisgICAgcmV0dXJuIEBj
b21taXRzIGlmICghKC1mICRmaWxlKSk7CisKKyAgICBpZiAoQHJhbmdlICYmICRWQ1NfY21kc3si
YmxhbWVfcmFuZ2VfY21kIn0gZXEgIiIpIHsKKwlteSBAYWxsX2NvbW1pdHMgPSAoKTsKKworCSRj
bWQgPSAkVkNTX2NtZHN7ImJsYW1lX2ZpbGVfY21kIn07CisJJGNtZCA9fiBzLyhcJFx3KykvJDEv
ZWVnOwkJI2ludGVycG9sYXRlICRjbWQKKwlAYWxsX2NvbW1pdHMgPSB2Y3Nfc2F2ZV9jb21taXRz
KCRjbWQpOworCisJZm9yZWFjaCBteSAkZmlsZV9yYW5nZV9kaWZmIChAcmFuZ2UpIHsKKwkgICAg
bmV4dCBpZiAoISgkZmlsZV9yYW5nZV9kaWZmID1+IG0vKC4rKTooLispOiguKykvKSk7CisJICAg
IG15ICRkaWZmX2ZpbGUgPSAkMTsKKwkgICAgbXkgJGRpZmZfc3RhcnQgPSAkMjsKKwkgICAgbXkg
JGRpZmZfbGVuZ3RoID0gJDM7CisJICAgIG5leHQgaWYgKCIkZmlsZSIgbmUgIiRkaWZmX2ZpbGUi
KTsKKwkgICAgZm9yIChteSAkaSA9ICRkaWZmX3N0YXJ0OyAkaSA8ICRkaWZmX3N0YXJ0ICsgJGRp
ZmZfbGVuZ3RoOyAkaSsrKSB7CisJCXB1c2goQGNvbW1pdHMsICRhbGxfY29tbWl0c1skaV0pOwor
CSAgICB9CisJfQorICAgIH0gZWxzaWYgKEByYW5nZSkgeworCWZvcmVhY2ggbXkgJGZpbGVfcmFu
Z2VfZGlmZiAoQHJhbmdlKSB7CisJICAgIG5leHQgaWYgKCEoJGZpbGVfcmFuZ2VfZGlmZiA9fiBt
LyguKyk6KC4rKTooLispLykpOworCSAgICBteSAkZGlmZl9maWxlID0gJDE7CisJICAgIG15ICRk
aWZmX3N0YXJ0ID0gJDI7CisJICAgIG15ICRkaWZmX2xlbmd0aCA9ICQzOworCSAgICBuZXh0IGlm
ICgiJGZpbGUiIG5lICIkZGlmZl9maWxlIik7CisJICAgICRjbWQgPSAkVkNTX2NtZHN7ImJsYW1l
X3JhbmdlX2NtZCJ9OworCSAgICAkY21kID1+IHMvKFwkXHcrKS8kMS9lZWc7CQkjaW50ZXJwb2xh
dGUgJGNtZAorCSAgICBwdXNoKEBjb21taXRzLCB2Y3Nfc2F2ZV9jb21taXRzKCRjbWQpKTsKKwl9
CisgICAgfSBlbHNlIHsKKwkkY21kID0gJFZDU19jbWRzeyJibGFtZV9maWxlX2NtZCJ9OworCSRj
bWQgPX4gcy8oXCRcdyspLyQxL2VlZzsJCSNpbnRlcnBvbGF0ZSAkY21kCisJQGNvbW1pdHMgPSB2
Y3Nfc2F2ZV9jb21taXRzKCRjbWQpOworICAgIH0KKworICAgIGZvcmVhY2ggbXkgJGNvbW1pdCAo
QGNvbW1pdHMpIHsKKwkkY29tbWl0ID1+IHMvXlxeLy9nOworICAgIH0KKworICAgIHJldHVybiBA
Y29tbWl0czsKK30KKworbXkgJHByaW50ZWRfbm92Y3MgPSAwOworc3ViIHZjc19leGlzdHMgewor
ICAgICVWQ1NfY21kcyA9ICVWQ1NfY21kc19naXQ7CisgICAgcmV0dXJuIDEgaWYgZXZhbCAkVkNT
X2NtZHN7ImF2YWlsYWJsZSJ9OworICAgICVWQ1NfY21kcyA9ICVWQ1NfY21kc19oZzsKKyAgICBy
ZXR1cm4gMiBpZiBldmFsICRWQ1NfY21kc3siYXZhaWxhYmxlIn07CisgICAgJVZDU19jbWRzID0g
KCk7CisgICAgaWYgKCEkcHJpbnRlZF9ub3ZjcykgeworCXdhcm4oIiRQOiBObyBzdXBwb3J0ZWQg
VkNTIGZvdW5kLiAgQWRkIC0tbm9naXQgdG8gb3B0aW9ucz9cbiIpOworCXdhcm4oIlVzaW5nIGEg
Z2l0IHJlcG9zaXRvcnkgcHJvZHVjZXMgYmV0dGVyIHJlc3VsdHMuXG4iKTsKKwl3YXJuKCJUcnkg
a3ZtLXVuaXQtdGVzdHMncyBsYXRlc3QgZ2l0IHJlcG9zaXRvcnkgdXNpbmc6XG4iKTsKKwl3YXJu
KCJnaXQgY2xvbmUgaHR0cHM6Ly9naXRsYWIuY29tL2t2bS11bml0LXRlc3RzL2t2bS11bml0LXRl
c3RzXG4iKTsKKwkkcHJpbnRlZF9ub3ZjcyA9IDE7CisgICAgfQorICAgIHJldHVybiAwOworfQor
CitzdWIgdmNzX2lzX2dpdCB7CisgICAgdmNzX2V4aXN0cygpOworICAgIHJldHVybiAkdmNzX3Vz
ZWQgPT0gMTsKK30KKworc3ViIHZjc19pc19oZyB7CisgICAgcmV0dXJuICR2Y3NfdXNlZCA9PSAy
OworfQorCitzdWIgdmNzX2FkZF9jb21taXRfc2lnbmVycyB7CisgICAgcmV0dXJuIGlmICghdmNz
X2V4aXN0cygpKTsKKworICAgIG15ICgkY29tbWl0LCAkZGVzYykgPSBAXzsKKyAgICBteSAkY29t
bWl0X2NvdW50ID0gMDsKKyAgICBteSAkY29tbWl0X2F1dGhvcnNfcmVmOworICAgIG15ICRjb21t
aXRfc2lnbmVyc19yZWY7CisgICAgbXkgJHN0YXRzX3JlZjsKKyAgICBteSBAY29tbWl0X2F1dGhv
cnMgPSAoKTsKKyAgICBteSBAY29tbWl0X3NpZ25lcnMgPSAoKTsKKyAgICBteSAkY21kOworCisg
ICAgJGNtZCA9ICRWQ1NfY21kc3siZmluZF9jb21taXRfc2lnbmVyc19jbWQifTsKKyAgICAkY21k
ID1+IHMvKFwkXHcrKS8kMS9lZWc7CSNzdWJzdGl0dXRlIHZhcmlhYmxlcyBpbiAkY21kCisKKyAg
ICAoJGNvbW1pdF9jb3VudCwgJGNvbW1pdF9zaWduZXJzX3JlZiwgJGNvbW1pdF9hdXRob3JzX3Jl
ZiwgJHN0YXRzX3JlZikgPSB2Y3NfZmluZF9zaWduZXJzKCRjbWQsICIiKTsKKyAgICBAY29tbWl0
X2F1dGhvcnMgPSBAeyRjb21taXRfYXV0aG9yc19yZWZ9IGlmIGRlZmluZWQgJGNvbW1pdF9hdXRo
b3JzX3JlZjsKKyAgICBAY29tbWl0X3NpZ25lcnMgPSBAeyRjb21taXRfc2lnbmVyc19yZWZ9IGlm
IGRlZmluZWQgJGNvbW1pdF9zaWduZXJzX3JlZjsKKworICAgIGZvcmVhY2ggbXkgJHNpZ25lciAo
QGNvbW1pdF9zaWduZXJzKSB7CisJJHNpZ25lciA9IGRlZHVwbGljYXRlX2VtYWlsKCRzaWduZXIp
OworICAgIH0KKworICAgIHZjc19hc3NpZ24oJGRlc2MsIDEsIEBjb21taXRfc2lnbmVycyk7Cit9
CisKK3N1YiBpbnRlcmFjdGl2ZV9nZXRfbWFpbnRhaW5lcnMgeworICAgIG15ICgkbGlzdF9yZWYp
ID0gQF87CisgICAgbXkgQGxpc3QgPSBAJGxpc3RfcmVmOworCisgICAgdmNzX2V4aXN0cygpOwor
CisgICAgbXkgJXNlbGVjdGVkOworICAgIG15ICVhdXRob3JlZDsKKyAgICBteSAlc2lnbmVkOwor
ICAgIG15ICRjb3VudCA9IDA7CisgICAgbXkgJG1haW50YWluZWQgPSAwOworICAgIGZvcmVhY2gg
bXkgJGVudHJ5IChAbGlzdCkgeworCSRtYWludGFpbmVkID0gMSBpZiAoJGVudHJ5LT5bMV0gPX4g
L14obWFpbnRhaW5lcnxzdXBwb3J0ZXIpL2kpOworCSRzZWxlY3RlZHskY291bnR9ID0gMTsKKwkk
YXV0aG9yZWR7JGNvdW50fSA9IDA7CisJJHNpZ25lZHskY291bnR9ID0gMDsKKwkkY291bnQrKzsK
KyAgICB9CisKKyAgICAjbWVudSBsb29wCisgICAgbXkgJGRvbmUgPSAwOworICAgIG15ICRwcmlu
dF9vcHRpb25zID0gMDsKKyAgICBteSAkcmVkcmF3ID0gMTsKKyAgICB3aGlsZSAoISRkb25lKSB7
CisJJGNvdW50ID0gMDsKKwlpZiAoJHJlZHJhdykgeworCSAgICBwcmludGYgU1RERVJSICJcbiUx
cyAlMnMgJS02NXMiLAorCQkJICAiKiIsICIjIiwgImVtYWlsL2xpc3QgYW5kIHJvbGU6c3RhdHMi
OworCSAgICBpZiAoJGVtYWlsX2dpdCB8fAorCQkoJGVtYWlsX2dpdF9mYWxsYmFjayAmJiAhJG1h
aW50YWluZWQpIHx8CisJCSRlbWFpbF9naXRfYmxhbWUpIHsKKwkJcHJpbnQgU1RERVJSICJhdXRo
IHNpZ24iOworCSAgICB9CisJICAgIHByaW50IFNUREVSUiAiXG4iOworCSAgICBmb3JlYWNoIG15
ICRlbnRyeSAoQGxpc3QpIHsKKwkJbXkgJGVtYWlsID0gJGVudHJ5LT5bMF07CisJCW15ICRyb2xl
ID0gJGVudHJ5LT5bMV07CisJCW15ICRzZWwgPSAiIjsKKwkJJHNlbCA9ICIqIiBpZiAoJHNlbGVj
dGVkeyRjb3VudH0pOworCQlteSAkY29tbWl0X2F1dGhvciA9ICRjb21taXRfYXV0aG9yX2hhc2h7
JGVtYWlsfTsKKwkJbXkgJGNvbW1pdF9zaWduZXIgPSAkY29tbWl0X3NpZ25lcl9oYXNoeyRlbWFp
bH07CisJCW15ICRhdXRob3JlZCA9IDA7CisJCW15ICRzaWduZWQgPSAwOworCQkkYXV0aG9yZWQr
KyBmb3IgKEB7JGNvbW1pdF9hdXRob3J9KTsKKwkJJHNpZ25lZCsrIGZvciAoQHskY29tbWl0X3Np
Z25lcn0pOworCQlwcmludGYgU1RERVJSICIlMXMgJTJkICUtNjVzIiwgJHNlbCwgJGNvdW50ICsg
MSwgJGVtYWlsOworCQlwcmludGYgU1RERVJSICIlNGQgJTRkIiwgJGF1dGhvcmVkLCAkc2lnbmVk
CisJCSAgICBpZiAoJGF1dGhvcmVkID4gMCB8fCAkc2lnbmVkID4gMCk7CisJCXByaW50ZiBTVERF
UlIgIlxuICAgICAlc1xuIiwgJHJvbGU7CisJCWlmICgkYXV0aG9yZWR7JGNvdW50fSkgeworCQkg
ICAgbXkgJGNvbW1pdF9hdXRob3IgPSAkY29tbWl0X2F1dGhvcl9oYXNoeyRlbWFpbH07CisJCSAg
ICBmb3JlYWNoIG15ICRyZWYgKEB7JGNvbW1pdF9hdXRob3J9KSB7CisJCQlwcmludCBTVERFUlIg
IiAgICAgQXV0aG9yOiBAeyRyZWZ9WzFdXG4iOworCQkgICAgfQorCQl9CisJCWlmICgkc2lnbmVk
eyRjb3VudH0pIHsKKwkJICAgIG15ICRjb21taXRfc2lnbmVyID0gJGNvbW1pdF9zaWduZXJfaGFz
aHskZW1haWx9OworCQkgICAgZm9yZWFjaCBteSAkcmVmIChAeyRjb21taXRfc2lnbmVyfSkgewor
CQkJcHJpbnQgU1RERVJSICIgICAgIEB7JHJlZn1bMl06IEB7JHJlZn1bMV1cbiI7CisJCSAgICB9
CisJCX0KKworCQkkY291bnQrKzsKKwkgICAgfQorCX0KKwlteSAkZGF0ZV9yZWYgPSBcJGVtYWls
X2dpdF9zaW5jZTsKKwkkZGF0ZV9yZWYgPSBcJGVtYWlsX2hnX3NpbmNlIGlmICh2Y3NfaXNfaGco
KSk7CisJaWYgKCRwcmludF9vcHRpb25zKSB7CisJICAgICRwcmludF9vcHRpb25zID0gMDsKKwkg
ICAgaWYgKHZjc19leGlzdHMoKSkgeworCQlwcmludCBTVERFUlIgPDxFT1QKKworVmVyc2lvbiBD
b250cm9sIG9wdGlvbnM6CitnICB1c2UgZ2l0IGhpc3RvcnkgICAgICBbJGVtYWlsX2dpdF0KK2dm
IHVzZSBnaXQtZmFsbGJhY2sgICAgIFskZW1haWxfZ2l0X2ZhbGxiYWNrXQorYiAgdXNlIGdpdCBi
bGFtZSAgICAgICAgWyRlbWFpbF9naXRfYmxhbWVdCiticyB1c2UgYmxhbWUgc2lnbmF0dXJlcyBb
JGVtYWlsX2dpdF9ibGFtZV9zaWduYXR1cmVzXQorYyMgbWluaW11bSBjb21taXRzICAgICAgWyRl
bWFpbF9naXRfbWluX3NpZ25hdHVyZXNdCislIyBtaW4gcGVyY2VudCAgICAgICAgICBbJGVtYWls
X2dpdF9taW5fcGVyY2VudF0KK2QjIGhpc3RvcnkgdG8gdXNlICAgICAgIFskJGRhdGVfcmVmXQor
eCMgbWF4IG1haW50YWluZXJzICAgICAgWyRlbWFpbF9naXRfbWF4X21haW50YWluZXJzXQordCAg
YWxsIHNpZ25hdHVyZSB0eXBlcyAgWyRlbWFpbF9naXRfYWxsX3NpZ25hdHVyZV90eXBlc10KK20g
IHVzZSAubWFpbG1hcCAgICAgICAgIFskZW1haWxfdXNlX21haWxtYXBdCitFT1QKKwkgICAgfQor
CSAgICBwcmludCBTVERFUlIgPDxFT1QKKworQWRkaXRpb25hbCBvcHRpb25zOgorMCAgdG9nZ2xl
IGFsbAordG0gdG9nZ2xlIG1haW50YWluZXJzCit0ZyB0b2dnbGUgZ2l0IGVudHJpZXMKK3RsIHRv
Z2dsZSBvcGVuIGxpc3QgZW50cmllcwordHMgdG9nZ2xlIHN1YnNjcmliZXIgbGlzdCBlbnRyaWVz
CitmICBlbWFpbHMgaW4gZmlsZSAgICAgICBbJGVtYWlsX2ZpbGVfZW1haWxzXQorayAga2V5d29y
ZHMgaW4gZmlsZSAgICAgWyRrZXl3b3Jkc10KK3IgIHJlbW92ZSBkdXBsaWNhdGVzICAgIFskZW1h
aWxfcmVtb3ZlX2R1cGxpY2F0ZXNdCitwIyBwYXR0ZXJuIG1hdGNoIGRlcHRoICBbJHBhdHRlcm5f
ZGVwdGhdCitFT1QKKwl9CisJcHJpbnQgU1RERVJSCisiXG4jKHRvZ2dsZSksIEEjKGF1dGhvciks
IFMjKHNpZ25lZCkgKihhbGwpLCBeKG5vbmUpLCBPKG9wdGlvbnMpLCBZKGFwcHJvdmUpOiAiOwor
CisJbXkgJGlucHV0ID0gPFNURElOPjsKKwljaG9tcCgkaW5wdXQpOworCisJJHJlZHJhdyA9IDE7
CisJbXkgJHJlcnVuID0gMDsKKwlteSBAd2lzaCA9IHNwbGl0KC9bLCBdKy8sICRpbnB1dCk7CisJ
Zm9yZWFjaCBteSAkbnIgKEB3aXNoKSB7CisJICAgICRuciA9IGxjKCRucik7CisJICAgIG15ICRz
ZWwgPSBzdWJzdHIoJG5yLCAwLCAxKTsKKwkgICAgbXkgJHN0ciA9IHN1YnN0cigkbnIsIDEpOwor
CSAgICBteSAkdmFsID0gMDsKKwkgICAgJHZhbCA9ICQxIGlmICRzdHIgPX4gL14oXGQrKSQvOwor
CisJICAgIGlmICgkc2VsIGVxICJ5IikgeworCQkkaW50ZXJhY3RpdmUgPSAwOworCQkkZG9uZSA9
IDE7CisJCSRvdXRwdXRfcm9sZXN0YXRzID0gMDsKKwkJJG91dHB1dF9yb2xlcyA9IDA7CisJCWxh
c3Q7CisJICAgIH0gZWxzaWYgKCRuciA9fiAvXlxkKyQvICYmICRuciA+IDAgJiYgJG5yIDw9ICRj
b3VudCkgeworCQkkc2VsZWN0ZWR7JG5yIC0gMX0gPSAhJHNlbGVjdGVkeyRuciAtIDF9OworCSAg
ICB9IGVsc2lmICgkc2VsIGVxICIqIiB8fCAkc2VsIGVxICdeJykgeworCQlteSAkdG9nZ2xlID0g
MDsKKwkJJHRvZ2dsZSA9IDEgaWYgKCRzZWwgZXEgJyonKTsKKwkJZm9yIChteSAkaSA9IDA7ICRp
IDwgJGNvdW50OyAkaSsrKSB7CisJCSAgICAkc2VsZWN0ZWR7JGl9ID0gJHRvZ2dsZTsKKwkJfQor
CSAgICB9IGVsc2lmICgkc2VsIGVxICIwIikgeworCQlmb3IgKG15ICRpID0gMDsgJGkgPCAkY291
bnQ7ICRpKyspIHsKKwkJICAgICRzZWxlY3RlZHskaX0gPSAhJHNlbGVjdGVkeyRpfTsKKwkJfQor
CSAgICB9IGVsc2lmICgkc2VsIGVxICJ0IikgeworCQlpZiAobGMoJHN0cikgZXEgIm0iKSB7CisJ
CSAgICBmb3IgKG15ICRpID0gMDsgJGkgPCAkY291bnQ7ICRpKyspIHsKKwkJCSRzZWxlY3RlZHsk
aX0gPSAhJHNlbGVjdGVkeyRpfQorCQkJICAgIGlmICgkbGlzdFskaV0tPlsxXSA9fiAvXihtYWlu
dGFpbmVyfHN1cHBvcnRlcikvaSk7CisJCSAgICB9CisJCX0gZWxzaWYgKGxjKCRzdHIpIGVxICJn
IikgeworCQkgICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGNvdW50OyAkaSsrKSB7CisJCQkkc2Vs
ZWN0ZWR7JGl9ID0gISRzZWxlY3RlZHskaX0KKwkJCSAgICBpZiAoJGxpc3RbJGldLT5bMV0gPX4g
L14oYXV0aG9yfGNvbW1pdHxzaWduZXIpL2kpOworCQkgICAgfQorCQl9IGVsc2lmIChsYygkc3Ry
KSBlcSAibCIpIHsKKwkJICAgIGZvciAobXkgJGkgPSAwOyAkaSA8ICRjb3VudDsgJGkrKykgewor
CQkJJHNlbGVjdGVkeyRpfSA9ICEkc2VsZWN0ZWR7JGl9CisJCQkgICAgaWYgKCRsaXN0WyRpXS0+
WzFdID1+IC9eKG9wZW4gbGlzdCkvaSk7CisJCSAgICB9CisJCX0gZWxzaWYgKGxjKCRzdHIpIGVx
ICJzIikgeworCQkgICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGNvdW50OyAkaSsrKSB7CisJCQkk
c2VsZWN0ZWR7JGl9ID0gISRzZWxlY3RlZHskaX0KKwkJCSAgICBpZiAoJGxpc3RbJGldLT5bMV0g
PX4gL14oc3Vic2NyaWJlciBsaXN0KS9pKTsKKwkJICAgIH0KKwkJfQorCSAgICB9IGVsc2lmICgk
c2VsIGVxICJhIikgeworCQlpZiAoJHZhbCA+IDAgJiYgJHZhbCA8PSAkY291bnQpIHsKKwkJICAg
ICRhdXRob3JlZHskdmFsIC0gMX0gPSAhJGF1dGhvcmVkeyR2YWwgLSAxfTsKKwkJfSBlbHNpZiAo
JHN0ciBlcSAnKicgfHwgJHN0ciBlcSAnXicpIHsKKwkJICAgIG15ICR0b2dnbGUgPSAwOworCQkg
ICAgJHRvZ2dsZSA9IDEgaWYgKCRzdHIgZXEgJyonKTsKKwkJICAgIGZvciAobXkgJGkgPSAwOyAk
aSA8ICRjb3VudDsgJGkrKykgeworCQkJJGF1dGhvcmVkeyRpfSA9ICR0b2dnbGU7CisJCSAgICB9
CisJCX0KKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAicyIpIHsKKwkJaWYgKCR2YWwgPiAwICYmICR2
YWwgPD0gJGNvdW50KSB7CisJCSAgICAkc2lnbmVkeyR2YWwgLSAxfSA9ICEkc2lnbmVkeyR2YWwg
LSAxfTsKKwkJfSBlbHNpZiAoJHN0ciBlcSAnKicgfHwgJHN0ciBlcSAnXicpIHsKKwkJICAgIG15
ICR0b2dnbGUgPSAwOworCQkgICAgJHRvZ2dsZSA9IDEgaWYgKCRzdHIgZXEgJyonKTsKKwkJICAg
IGZvciAobXkgJGkgPSAwOyAkaSA8ICRjb3VudDsgJGkrKykgeworCQkJJHNpZ25lZHskaX0gPSAk
dG9nZ2xlOworCQkgICAgfQorCQl9CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgIm8iKSB7CisJCSRw
cmludF9vcHRpb25zID0gMTsKKwkJJHJlZHJhdyA9IDE7CisJICAgIH0gZWxzaWYgKCRzZWwgZXEg
ImciKSB7CisJCWlmICgkc3RyIGVxICJmIikgeworCQkgICAgYm9vbF9pbnZlcnQoXCRlbWFpbF9n
aXRfZmFsbGJhY2spOworCQl9IGVsc2UgeworCQkgICAgYm9vbF9pbnZlcnQoXCRlbWFpbF9naXQp
OworCQl9CisJCSRyZXJ1biA9IDE7CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgImIiKSB7CisJCWlm
ICgkc3RyIGVxICJzIikgeworCQkgICAgYm9vbF9pbnZlcnQoXCRlbWFpbF9naXRfYmxhbWVfc2ln
bmF0dXJlcyk7CisJCX0gZWxzZSB7CisJCSAgICBib29sX2ludmVydChcJGVtYWlsX2dpdF9ibGFt
ZSk7CisJCX0KKwkJJHJlcnVuID0gMTsKKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAiYyIpIHsKKwkJ
aWYgKCR2YWwgPiAwKSB7CisJCSAgICAkZW1haWxfZ2l0X21pbl9zaWduYXR1cmVzID0gJHZhbDsK
KwkJICAgICRyZXJ1biA9IDE7CisJCX0KKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAieCIpIHsKKwkJ
aWYgKCR2YWwgPiAwKSB7CisJCSAgICAkZW1haWxfZ2l0X21heF9tYWludGFpbmVycyA9ICR2YWw7
CisJCSAgICAkcmVydW4gPSAxOworCQl9CisJICAgIH0gZWxzaWYgKCRzZWwgZXEgIiUiKSB7CisJ
CWlmICgkc3RyIG5lICIiICYmICR2YWwgPj0gMCkgeworCQkgICAgJGVtYWlsX2dpdF9taW5fcGVy
Y2VudCA9ICR2YWw7CisJCSAgICAkcmVydW4gPSAxOworCQl9CisJICAgIH0gZWxzaWYgKCRzZWwg
ZXEgImQiKSB7CisJCWlmICh2Y3NfaXNfZ2l0KCkpIHsKKwkJICAgICRlbWFpbF9naXRfc2luY2Ug
PSAkc3RyOworCQl9IGVsc2lmICh2Y3NfaXNfaGcoKSkgeworCQkgICAgJGVtYWlsX2hnX3NpbmNl
ID0gJHN0cjsKKwkJfQorCQkkcmVydW4gPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJ0Iikg
eworCQlib29sX2ludmVydChcJGVtYWlsX2dpdF9hbGxfc2lnbmF0dXJlX3R5cGVzKTsKKwkJJHJl
cnVuID0gMTsKKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAiZiIpIHsKKwkJYm9vbF9pbnZlcnQoXCRl
bWFpbF9maWxlX2VtYWlscyk7CisJCSRyZXJ1biA9IDE7CisJICAgIH0gZWxzaWYgKCRzZWwgZXEg
InIiKSB7CisJCWJvb2xfaW52ZXJ0KFwkZW1haWxfcmVtb3ZlX2R1cGxpY2F0ZXMpOworCQkkcmVy
dW4gPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJtIikgeworCQlib29sX2ludmVydChcJGVt
YWlsX3VzZV9tYWlsbWFwKTsKKwkJcmVhZF9tYWlsbWFwKCk7CisJCSRyZXJ1biA9IDE7CisJICAg
IH0gZWxzaWYgKCRzZWwgZXEgImsiKSB7CisJCWJvb2xfaW52ZXJ0KFwka2V5d29yZHMpOworCQkk
cmVydW4gPSAxOworCSAgICB9IGVsc2lmICgkc2VsIGVxICJwIikgeworCQlpZiAoJHN0ciBuZSAi
IiAmJiAkdmFsID49IDApIHsKKwkJICAgICRwYXR0ZXJuX2RlcHRoID0gJHZhbDsKKwkJICAgICRy
ZXJ1biA9IDE7CisJCX0KKwkgICAgfSBlbHNpZiAoJHNlbCBlcSAiaCIgfHwgJHNlbCBlcSAiPyIp
IHsKKwkJcHJpbnQgU1RERVJSIDw8RU9UCisKK0ludGVyYWN0aXZlIG1vZGUgYWxsb3dzIHlvdSB0
byBzZWxlY3QgdGhlIHZhcmlvdXMgbWFpbnRhaW5lcnMsIHN1Ym1pdHRlcnMsCitjb21taXQgc2ln
bmVycyBhbmQgbWFpbGluZyBsaXN0cyB0aGF0IGNvdWxkIGJlIENDJ2Qgb24gYSBwYXRjaC4KKwor
QW55IConZCBlbnRyeSBpcyBzZWxlY3RlZC4KKworSWYgeW91IGhhdmUgZ2l0IG9yIGhnIGluc3Rh
bGxlZCwgeW91IGNhbiBjaG9vc2UgdG8gc3VtbWFyaXplIHRoZSBjb21taXQKK2hpc3Rvcnkgb2Yg
ZmlsZXMgaW4gdGhlIHBhdGNoLiAgQWxzbywgZWFjaCBsaW5lIG9mIHRoZSBjdXJyZW50IGZpbGUg
Y2FuCitiZSBtYXRjaGVkIHRvIGl0cyBjb21taXQgYXV0aG9yIGFuZCB0aGF0IGNvbW1pdHMgc2ln
bmVycyB3aXRoIGJsYW1lLgorCitWYXJpb3VzIGtub2JzIGV4aXN0IHRvIGNvbnRyb2wgdGhlIGxl
bmd0aCBvZiB0aW1lIGZvciBhY3RpdmUgY29tbWl0Cit0cmFja2luZywgdGhlIG1heGltdW0gbnVt
YmVyIG9mIGNvbW1pdCBhdXRob3JzIGFuZCBzaWduZXJzIHRvIGFkZCwKK2FuZCBzdWNoLgorCitF
bnRlciBzZWxlY3Rpb25zIGF0IHRoZSBwcm9tcHQgdW50aWwgeW91IGFyZSBzYXRpc2ZpZWQgdGhh
dCB0aGUgc2VsZWN0ZWQKK21haW50YWluZXJzIGFyZSBhcHByb3ByaWF0ZS4gIFlvdSBtYXkgZW50
ZXIgbXVsdGlwbGUgc2VsZWN0aW9ucyBzZXBhcmF0ZWQKK2J5IGVpdGhlciBjb21tYXMgb3Igc3Bh
Y2VzLgorCitFT1QKKwkgICAgfSBlbHNlIHsKKwkJcHJpbnQgU1RERVJSICJpbnZhbGlkIG9wdGlv
bjogJyRucidcbiI7CisJCSRyZWRyYXcgPSAwOworCSAgICB9CisJfQorCWlmICgkcmVydW4pIHsK
KwkgICAgcHJpbnQgU1RERVJSICJnaXQtYmxhbWUgY2FuIGJlIHZlcnkgc2xvdywgcGxlYXNlIGhh
dmUgcGF0aWVuY2UuLi4iCisJCWlmICgkZW1haWxfZ2l0X2JsYW1lKTsKKwkgICAgZ290byAmZ2V0
X21haW50YWluZXJzOworCX0KKyAgICB9CisKKyAgICAjZHJvcCBub3Qgc2VsZWN0ZWQgZW50cmll
cworICAgICRjb3VudCA9IDA7CisgICAgbXkgQG5ld19lbWFpbHRvID0gKCk7CisgICAgZm9yZWFj
aCBteSAkZW50cnkgKEBsaXN0KSB7CisJaWYgKCRzZWxlY3RlZHskY291bnR9KSB7CisJICAgIHB1
c2goQG5ld19lbWFpbHRvLCAkbGlzdFskY291bnRdKTsKKwl9CisJJGNvdW50Kys7CisgICAgfQor
ICAgIHJldHVybiBAbmV3X2VtYWlsdG87Cit9CisKK3N1YiBib29sX2ludmVydCB7CisgICAgbXkg
KCRib29sX3JlZikgPSBAXzsKKworICAgIGlmICgkJGJvb2xfcmVmKSB7CisJJCRib29sX3JlZiA9
IDA7CisgICAgfSBlbHNlIHsKKwkkJGJvb2xfcmVmID0gMTsKKyAgICB9Cit9CisKK3N1YiBkZWR1
cGxpY2F0ZV9lbWFpbCB7CisgICAgbXkgKCRlbWFpbCkgPSBAXzsKKworICAgIG15ICRtYXRjaGVk
ID0gMDsKKyAgICBteSAoJG5hbWUsICRhZGRyZXNzKSA9IHBhcnNlX2VtYWlsKCRlbWFpbCk7Cisg
ICAgJGVtYWlsID0gZm9ybWF0X2VtYWlsKCRuYW1lLCAkYWRkcmVzcywgMSk7CisgICAgJGVtYWls
ID0gbWFpbG1hcF9lbWFpbCgkZW1haWwpOworCisgICAgcmV0dXJuICRlbWFpbCBpZiAoISRlbWFp
bF9yZW1vdmVfZHVwbGljYXRlcyk7CisKKyAgICAoJG5hbWUsICRhZGRyZXNzKSA9IHBhcnNlX2Vt
YWlsKCRlbWFpbCk7CisKKyAgICBpZiAoJG5hbWUgbmUgIiIgJiYgJGRlZHVwbGljYXRlX25hbWVf
aGFzaHtsYygkbmFtZSl9KSB7CisJJG5hbWUgPSAkZGVkdXBsaWNhdGVfbmFtZV9oYXNoe2xjKCRu
YW1lKX0tPlswXTsKKwkkYWRkcmVzcyA9ICRkZWR1cGxpY2F0ZV9uYW1lX2hhc2h7bGMoJG5hbWUp
fS0+WzFdOworCSRtYXRjaGVkID0gMTsKKyAgICB9IGVsc2lmICgkZGVkdXBsaWNhdGVfYWRkcmVz
c19oYXNoe2xjKCRhZGRyZXNzKX0pIHsKKwkkbmFtZSA9ICRkZWR1cGxpY2F0ZV9hZGRyZXNzX2hh
c2h7bGMoJGFkZHJlc3MpfS0+WzBdOworCSRhZGRyZXNzID0gJGRlZHVwbGljYXRlX2FkZHJlc3Nf
aGFzaHtsYygkYWRkcmVzcyl9LT5bMV07CisJJG1hdGNoZWQgPSAxOworICAgIH0KKyAgICBpZiAo
ISRtYXRjaGVkKSB7CisJJGRlZHVwbGljYXRlX25hbWVfaGFzaHtsYygkbmFtZSl9ID0gWyAkbmFt
ZSwgJGFkZHJlc3MgXTsKKwkkZGVkdXBsaWNhdGVfYWRkcmVzc19oYXNoe2xjKCRhZGRyZXNzKX0g
PSBbICRuYW1lLCAkYWRkcmVzcyBdOworICAgIH0KKyAgICAkZW1haWwgPSBmb3JtYXRfZW1haWwo
JG5hbWUsICRhZGRyZXNzLCAxKTsKKyAgICAkZW1haWwgPSBtYWlsbWFwX2VtYWlsKCRlbWFpbCk7
CisgICAgcmV0dXJuICRlbWFpbDsKK30KKworc3ViIHNhdmVfY29tbWl0c19ieV9hdXRob3Igewor
ICAgIG15IChAbGluZXMpID0gQF87CisKKyAgICBteSBAYXV0aG9ycyA9ICgpOworICAgIG15IEBj
b21taXRzID0gKCk7CisgICAgbXkgQHN1YmplY3RzID0gKCk7CisKKyAgICBmb3JlYWNoIG15ICRs
aW5lIChAbGluZXMpIHsKKwlpZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7ImF1dGhvcl9wYXR0ZXJu
In0vKSB7CisJICAgIG15ICRhdXRob3IgPSAkMTsKKwkgICAgJGF1dGhvciA9IGRlZHVwbGljYXRl
X2VtYWlsKCRhdXRob3IpOworCSAgICBwdXNoKEBhdXRob3JzLCAkYXV0aG9yKTsKKwl9CisJcHVz
aChAY29tbWl0cywgJDEpIGlmICgkbGluZSA9fiBtLyRWQ1NfY21kc3siY29tbWl0X3BhdHRlcm4i
fS8pOworCXB1c2goQHN1YmplY3RzLCAkMSkgaWYgKCRsaW5lID1+IG0vJFZDU19jbWRzeyJzdWJq
ZWN0X3BhdHRlcm4ifS8pOworICAgIH0KKworICAgIGZvciAobXkgJGkgPSAwOyAkaSA8IEBhdXRo
b3JzOyAkaSsrKSB7CisJbXkgJGV4aXN0cyA9IDA7CisJZm9yZWFjaCBteSAkcmVmKEB7JGNvbW1p
dF9hdXRob3JfaGFzaHskYXV0aG9yc1skaV19fSkgeworCSAgICBpZiAoQHskcmVmfVswXSBlcSAk
Y29tbWl0c1skaV0gJiYKKwkJQHskcmVmfVsxXSBlcSAkc3ViamVjdHNbJGldKSB7CisJCSRleGlz
dHMgPSAxOworCQlsYXN0OworCSAgICB9CisJfQorCWlmICghJGV4aXN0cykgeworCSAgICBwdXNo
KEB7JGNvbW1pdF9hdXRob3JfaGFzaHskYXV0aG9yc1skaV19fSwKKwkJIFsgKCRjb21taXRzWyRp
XSwgJHN1YmplY3RzWyRpXSkgXSk7CisJfQorICAgIH0KK30KKworc3ViIHNhdmVfY29tbWl0c19i
eV9zaWduZXIgeworICAgIG15IChAbGluZXMpID0gQF87CisKKyAgICBteSAkY29tbWl0ID0gIiI7
CisgICAgbXkgJHN1YmplY3QgPSAiIjsKKworICAgIGZvcmVhY2ggbXkgJGxpbmUgKEBsaW5lcykg
eworCSRjb21taXQgPSAkMSBpZiAoJGxpbmUgPX4gbS8kVkNTX2NtZHN7ImNvbW1pdF9wYXR0ZXJu
In0vKTsKKwkkc3ViamVjdCA9ICQxIGlmICgkbGluZSA9fiBtLyRWQ1NfY21kc3sic3ViamVjdF9w
YXR0ZXJuIn0vKTsKKwlpZiAoJGxpbmUgPX4gL15bIFx0XSoke3NpZ25hdHVyZV9wYXR0ZXJufS4q
XEAuKiQvKSB7CisJICAgIG15IEBzaWduYXR1cmVzID0gKCRsaW5lKTsKKwkgICAgbXkgKCR0eXBl
c19yZWYsICRzaWduZXJzX3JlZikgPSBleHRyYWN0X2Zvcm1hdHRlZF9zaWduYXR1cmVzKEBzaWdu
YXR1cmVzKTsKKwkgICAgbXkgQHR5cGVzID0gQCR0eXBlc19yZWY7CisJICAgIG15IEBzaWduZXJz
ID0gQCRzaWduZXJzX3JlZjsKKworCSAgICBteSAkdHlwZSA9ICR0eXBlc1swXTsKKwkgICAgbXkg
JHNpZ25lciA9ICRzaWduZXJzWzBdOworCisJICAgICRzaWduZXIgPSBkZWR1cGxpY2F0ZV9lbWFp
bCgkc2lnbmVyKTsKKworCSAgICBteSAkZXhpc3RzID0gMDsKKwkgICAgZm9yZWFjaCBteSAkcmVm
KEB7JGNvbW1pdF9zaWduZXJfaGFzaHskc2lnbmVyfX0pIHsKKwkJaWYgKEB7JHJlZn1bMF0gZXEg
JGNvbW1pdCAmJgorCQkgICAgQHskcmVmfVsxXSBlcSAkc3ViamVjdCAmJgorCQkgICAgQHskcmVm
fVsyXSBlcSAkdHlwZSkgeworCQkgICAgJGV4aXN0cyA9IDE7CisJCSAgICBsYXN0OworCQl9CisJ
ICAgIH0KKwkgICAgaWYgKCEkZXhpc3RzKSB7CisJCXB1c2goQHskY29tbWl0X3NpZ25lcl9oYXNo
eyRzaWduZXJ9fSwKKwkJICAgICBbICgkY29tbWl0LCAkc3ViamVjdCwgJHR5cGUpIF0pOworCSAg
ICB9CisJfQorICAgIH0KK30KKworc3ViIHZjc19hc3NpZ24geworICAgIG15ICgkcm9sZSwgJGRp
dmlzb3IsIEBsaW5lcykgPSBAXzsKKworICAgIG15ICVoYXNoOworICAgIG15ICRjb3VudCA9IDA7
CisKKyAgICByZXR1cm4gaWYgKEBsaW5lcyA8PSAwKTsKKworICAgIGlmICgkZGl2aXNvciA8PSAw
KSB7CisJd2FybigiQmFkIGRpdmlzb3IgaW4gIiAuIChjYWxsZXIoMCkpWzNdIC4gIjogJGRpdmlz
b3JcbiIpOworCSRkaXZpc29yID0gMTsKKyAgICB9CisKKyAgICBAbGluZXMgPSBtYWlsbWFwKEBs
aW5lcyk7CisKKyAgICByZXR1cm4gaWYgKEBsaW5lcyA8PSAwKTsKKworICAgIEBsaW5lcyA9IHNv
cnQoQGxpbmVzKTsKKworICAgICMgdW5pcSAtYworICAgICRoYXNoeyRffSsrIGZvciBAbGluZXM7
CisKKyAgICAjIHNvcnQgLXJuCisgICAgZm9yZWFjaCBteSAkbGluZSAoc29ydCB7JGhhc2h7JGJ9
IDw9PiAkaGFzaHskYX19IGtleXMgJWhhc2gpIHsKKwlteSAkc2lnbl9vZmZzID0gJGhhc2h7JGxp
bmV9OworCW15ICRwZXJjZW50ID0gJHNpZ25fb2ZmcyAqIDEwMCAvICRkaXZpc29yOworCisJJHBl
cmNlbnQgPSAxMDAgaWYgKCRwZXJjZW50ID4gMTAwKTsKKwluZXh0IGlmIChpZ25vcmVfZW1haWxf
YWRkcmVzcygkbGluZSkpOworCSRjb3VudCsrOworCWxhc3QgaWYgKCRzaWduX29mZnMgPCAkZW1h
aWxfZ2l0X21pbl9zaWduYXR1cmVzIHx8CisJCSAkY291bnQgPiAkZW1haWxfZ2l0X21heF9tYWlu
dGFpbmVycyB8fAorCQkgJHBlcmNlbnQgPCAkZW1haWxfZ2l0X21pbl9wZXJjZW50KTsKKwlwdXNo
X2VtYWlsX2FkZHJlc3MoJGxpbmUsICcnKTsKKwlpZiAoJG91dHB1dF9yb2xlc3RhdHMpIHsKKwkg
ICAgbXkgJGZtdF9wZXJjZW50ID0gc3ByaW50ZigiJS4wZiIsICRwZXJjZW50KTsKKwkgICAgYWRk
X3JvbGUoJGxpbmUsICIkcm9sZTokc2lnbl9vZmZzLyRkaXZpc29yPSRmbXRfcGVyY2VudCUiKTsK
Kwl9IGVsc2UgeworCSAgICBhZGRfcm9sZSgkbGluZSwgJHJvbGUpOworCX0KKyAgICB9Cit9CisK
K3N1YiB2Y3NfZmlsZV9zaWdub2ZmcyB7CisgICAgbXkgKCRmaWxlKSA9IEBfOworCisgICAgbXkg
JGF1dGhvcnNfcmVmOworICAgIG15ICRzaWduZXJzX3JlZjsKKyAgICBteSAkc3RhdHNfcmVmOwor
ICAgIG15IEBhdXRob3JzID0gKCk7CisgICAgbXkgQHNpZ25lcnMgPSAoKTsKKyAgICBteSBAc3Rh
dHMgPSAoKTsKKyAgICBteSAkY29tbWl0czsKKworICAgICR2Y3NfdXNlZCA9IHZjc19leGlzdHMo
KTsKKyAgICByZXR1cm4gaWYgKCEkdmNzX3VzZWQpOworCisgICAgbXkgJGNtZCA9ICRWQ1NfY21k
c3siZmluZF9zaWduZXJzX2NtZCJ9OworICAgICRjbWQgPX4gcy8oXCRcdyspLyQxL2VlZzsJCSMg
aW50ZXJwb2xhdGUgJGNtZAorCisgICAgKCRjb21taXRzLCAkc2lnbmVyc19yZWYsICRhdXRob3Jz
X3JlZiwgJHN0YXRzX3JlZikgPSB2Y3NfZmluZF9zaWduZXJzKCRjbWQsICRmaWxlKTsKKworICAg
IEBzaWduZXJzID0gQHskc2lnbmVyc19yZWZ9IGlmIGRlZmluZWQgJHNpZ25lcnNfcmVmOworICAg
IEBhdXRob3JzID0gQHskYXV0aG9yc19yZWZ9IGlmIGRlZmluZWQgJGF1dGhvcnNfcmVmOworICAg
IEBzdGF0cyA9IEB7JHN0YXRzX3JlZn0gaWYgZGVmaW5lZCAkc3RhdHNfcmVmOworCisjICAgIHBy
aW50KCJjb21taXRzOiA8JGNvbW1pdHM+XG5zaWduZXJzOjxAc2lnbmVycz5cbmF1dGhvcnM6IDxA
YXV0aG9ycz5cbnN0YXRzOiA8QHN0YXRzPlxuIik7CisKKyAgICBmb3JlYWNoIG15ICRzaWduZXIg
KEBzaWduZXJzKSB7CisJJHNpZ25lciA9IGRlZHVwbGljYXRlX2VtYWlsKCRzaWduZXIpOworICAg
IH0KKworICAgIHZjc19hc3NpZ24oImNvbW1pdF9zaWduZXIiLCAkY29tbWl0cywgQHNpZ25lcnMp
OworICAgIHZjc19hc3NpZ24oImF1dGhvcmVkIiwgJGNvbW1pdHMsIEBhdXRob3JzKTsKKyAgICBp
ZiAoJCNhdXRob3JzID09ICQjc3RhdHMpIHsKKwlteSAkc3RhdF9wYXR0ZXJuID0gJFZDU19jbWRz
eyJzdGF0X3BhdHRlcm4ifTsKKwkkc3RhdF9wYXR0ZXJuID1+IHMvKFwkXHcrKS8kMS9lZWc7CSNp
bnRlcnBvbGF0ZSAkc3RhdF9wYXR0ZXJuCisKKwlteSAkYWRkZWQgPSAwOworCW15ICRkZWxldGVk
ID0gMDsKKwlmb3IgKG15ICRpID0gMDsgJGkgPD0gJCNzdGF0czsgJGkrKykgeworCSAgICBpZiAo
JHN0YXRzWyRpXSA9fiAvJHN0YXRfcGF0dGVybi8pIHsKKwkJJGFkZGVkICs9ICQxOworCQkkZGVs
ZXRlZCArPSAkMjsKKwkgICAgfQorCX0KKwlteSBAdG1wX2F1dGhvcnMgPSB1bmlxKEBhdXRob3Jz
KTsKKwlmb3JlYWNoIG15ICRhdXRob3IgKEB0bXBfYXV0aG9ycykgeworCSAgICAkYXV0aG9yID0g
ZGVkdXBsaWNhdGVfZW1haWwoJGF1dGhvcik7CisJfQorCUB0bXBfYXV0aG9ycyA9IHVuaXEoQHRt
cF9hdXRob3JzKTsKKwlteSBAbGlzdF9hZGRlZCA9ICgpOworCW15IEBsaXN0X2RlbGV0ZWQgPSAo
KTsKKwlmb3JlYWNoIG15ICRhdXRob3IgKEB0bXBfYXV0aG9ycykgeworCSAgICBteSAkYXV0aF9h
ZGRlZCA9IDA7CisJICAgIG15ICRhdXRoX2RlbGV0ZWQgPSAwOworCSAgICBmb3IgKG15ICRpID0g
MDsgJGkgPD0gJCNzdGF0czsgJGkrKykgeworCQlpZiAoJGF1dGhvciBlcSBkZWR1cGxpY2F0ZV9l
bWFpbCgkYXV0aG9yc1skaV0pICYmCisJCSAgICAkc3RhdHNbJGldID1+IC8kc3RhdF9wYXR0ZXJu
LykgeworCQkgICAgJGF1dGhfYWRkZWQgKz0gJDE7CisJCSAgICAkYXV0aF9kZWxldGVkICs9ICQy
OworCQl9CisJICAgIH0KKwkgICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGF1dGhfYWRkZWQ7ICRp
KyspIHsKKwkJcHVzaChAbGlzdF9hZGRlZCwgJGF1dGhvcik7CisJICAgIH0KKwkgICAgZm9yICht
eSAkaSA9IDA7ICRpIDwgJGF1dGhfZGVsZXRlZDsgJGkrKykgeworCQlwdXNoKEBsaXN0X2RlbGV0
ZWQsICRhdXRob3IpOworCSAgICB9CisJfQorCXZjc19hc3NpZ24oImFkZGVkX2xpbmVzIiwgJGFk
ZGVkLCBAbGlzdF9hZGRlZCk7CisJdmNzX2Fzc2lnbigicmVtb3ZlZF9saW5lcyIsICRkZWxldGVk
LCBAbGlzdF9kZWxldGVkKTsKKyAgICB9Cit9CisKK3N1YiB2Y3NfZmlsZV9ibGFtZSB7CisgICAg
bXkgKCRmaWxlKSA9IEBfOworCisgICAgbXkgQHNpZ25lcnMgPSAoKTsKKyAgICBteSBAYWxsX2Nv
bW1pdHMgPSAoKTsKKyAgICBteSBAY29tbWl0cyA9ICgpOworICAgIG15ICR0b3RhbF9jb21taXRz
OworICAgIG15ICR0b3RhbF9saW5lczsKKworICAgICR2Y3NfdXNlZCA9IHZjc19leGlzdHMoKTsK
KyAgICByZXR1cm4gaWYgKCEkdmNzX3VzZWQpOworCisgICAgQGFsbF9jb21taXRzID0gdmNzX2Js
YW1lKCRmaWxlKTsKKyAgICBAY29tbWl0cyA9IHVuaXEoQGFsbF9jb21taXRzKTsKKyAgICAkdG90
YWxfY29tbWl0cyA9IEBjb21taXRzOworICAgICR0b3RhbF9saW5lcyA9IEBhbGxfY29tbWl0czsK
KworICAgIGlmICgkZW1haWxfZ2l0X2JsYW1lX3NpZ25hdHVyZXMpIHsKKwlpZiAodmNzX2lzX2hn
KCkpIHsKKwkgICAgbXkgJGNvbW1pdF9jb3VudDsKKwkgICAgbXkgJGNvbW1pdF9hdXRob3JzX3Jl
ZjsKKwkgICAgbXkgJGNvbW1pdF9zaWduZXJzX3JlZjsKKwkgICAgbXkgJHN0YXRzX3JlZjsKKwkg
ICAgbXkgQGNvbW1pdF9hdXRob3JzID0gKCk7CisJICAgIG15IEBjb21taXRfc2lnbmVycyA9ICgp
OworCSAgICBteSAkY29tbWl0ID0gam9pbigiIC1yICIsIEBjb21taXRzKTsKKwkgICAgbXkgJGNt
ZDsKKworCSAgICAkY21kID0gJFZDU19jbWRzeyJmaW5kX2NvbW1pdF9zaWduZXJzX2NtZCJ9Owor
CSAgICAkY21kID1+IHMvKFwkXHcrKS8kMS9lZWc7CSNzdWJzdGl0dXRlIHZhcmlhYmxlcyBpbiAk
Y21kCisKKwkgICAgKCRjb21taXRfY291bnQsICRjb21taXRfc2lnbmVyc19yZWYsICRjb21taXRf
YXV0aG9yc19yZWYsICRzdGF0c19yZWYpID0gdmNzX2ZpbmRfc2lnbmVycygkY21kLCAkZmlsZSk7
CisJICAgIEBjb21taXRfYXV0aG9ycyA9IEB7JGNvbW1pdF9hdXRob3JzX3JlZn0gaWYgZGVmaW5l
ZCAkY29tbWl0X2F1dGhvcnNfcmVmOworCSAgICBAY29tbWl0X3NpZ25lcnMgPSBAeyRjb21taXRf
c2lnbmVyc19yZWZ9IGlmIGRlZmluZWQgJGNvbW1pdF9zaWduZXJzX3JlZjsKKworCSAgICBwdXNo
KEBzaWduZXJzLCBAY29tbWl0X3NpZ25lcnMpOworCX0gZWxzZSB7CisJICAgIGZvcmVhY2ggbXkg
JGNvbW1pdCAoQGNvbW1pdHMpIHsKKwkJbXkgJGNvbW1pdF9jb3VudDsKKwkJbXkgJGNvbW1pdF9h
dXRob3JzX3JlZjsKKwkJbXkgJGNvbW1pdF9zaWduZXJzX3JlZjsKKwkJbXkgJHN0YXRzX3JlZjsK
KwkJbXkgQGNvbW1pdF9hdXRob3JzID0gKCk7CisJCW15IEBjb21taXRfc2lnbmVycyA9ICgpOwor
CQlteSAkY21kOworCisJCSRjbWQgPSAkVkNTX2NtZHN7ImZpbmRfY29tbWl0X3NpZ25lcnNfY21k
In07CisJCSRjbWQgPX4gcy8oXCRcdyspLyQxL2VlZzsJI3N1YnN0aXR1dGUgdmFyaWFibGVzIGlu
ICRjbWQKKworCQkoJGNvbW1pdF9jb3VudCwgJGNvbW1pdF9zaWduZXJzX3JlZiwgJGNvbW1pdF9h
dXRob3JzX3JlZiwgJHN0YXRzX3JlZikgPSB2Y3NfZmluZF9zaWduZXJzKCRjbWQsICRmaWxlKTsK
KwkJQGNvbW1pdF9hdXRob3JzID0gQHskY29tbWl0X2F1dGhvcnNfcmVmfSBpZiBkZWZpbmVkICRj
b21taXRfYXV0aG9yc19yZWY7CisJCUBjb21taXRfc2lnbmVycyA9IEB7JGNvbW1pdF9zaWduZXJz
X3JlZn0gaWYgZGVmaW5lZCAkY29tbWl0X3NpZ25lcnNfcmVmOworCisJCXB1c2goQHNpZ25lcnMs
IEBjb21taXRfc2lnbmVycyk7CisJICAgIH0KKwl9CisgICAgfQorCisgICAgaWYgKCRmcm9tX2Zp
bGVuYW1lKSB7CisJaWYgKCRvdXRwdXRfcm9sZXN0YXRzKSB7CisJICAgIG15IEBibGFtZV9zaWdu
ZXJzOworCSAgICBpZiAodmNzX2lzX2hnKCkpIHt7CQkjIERvdWJsZSBicmFjZSBmb3IgbGFzdCBl
eGl0CisJCW15ICRjb21taXRfY291bnQ7CisJCW15IEBjb21taXRfc2lnbmVycyA9ICgpOworCQlA
Y29tbWl0cyA9IHVuaXEoQGNvbW1pdHMpOworCQlAY29tbWl0cyA9IHNvcnQoQGNvbW1pdHMpOwor
CQlteSAkY29tbWl0ID0gam9pbigiIC1yICIsIEBjb21taXRzKTsKKwkJbXkgJGNtZDsKKworCQkk
Y21kID0gJFZDU19jbWRzeyJmaW5kX2NvbW1pdF9hdXRob3JfY21kIn07CisJCSRjbWQgPX4gcy8o
XCRcdyspLyQxL2VlZzsJI3N1YnN0aXR1dGUgdmFyaWFibGVzIGluICRjbWQKKworCQlteSBAbGlu
ZXMgPSAoKTsKKworCQlAbGluZXMgPSAmeyRWQ1NfY21kc3siZXhlY3V0ZV9jbWQifX0oJGNtZCk7
CisKKwkJbGFzdCBpZiAhQGxpbmVzOworCisJCW15IEBhdXRob3JzID0gKCk7CisJCWZvcmVhY2gg
bXkgJGxpbmUgKEBsaW5lcykgeworCQkgICAgaWYgKCRsaW5lID1+IG0vJFZDU19jbWRzeyJhdXRo
b3JfcGF0dGVybiJ9LykgeworCQkJbXkgJGF1dGhvciA9ICQxOworCQkJJGF1dGhvciA9IGRlZHVw
bGljYXRlX2VtYWlsKCRhdXRob3IpOworCQkJcHVzaChAYXV0aG9ycywgJGF1dGhvcik7CisJCSAg
ICB9CisJCX0KKworCQlzYXZlX2NvbW1pdHNfYnlfYXV0aG9yKEBsaW5lcykgaWYgKCRpbnRlcmFj
dGl2ZSk7CisJCXNhdmVfY29tbWl0c19ieV9zaWduZXIoQGxpbmVzKSBpZiAoJGludGVyYWN0aXZl
KTsKKworCQlwdXNoKEBzaWduZXJzLCBAYXV0aG9ycyk7CisJICAgIH19CisJICAgIGVsc2Ugewor
CQlmb3JlYWNoIG15ICRjb21taXQgKEBjb21taXRzKSB7CisJCSAgICBteSAkaTsKKwkJICAgIG15
ICRjbWQgPSAkVkNTX2NtZHN7ImZpbmRfY29tbWl0X2F1dGhvcl9jbWQifTsKKwkJICAgICRjbWQg
PX4gcy8oXCRcdyspLyQxL2VlZzsJI2ludGVycG9sYXRlICRjbWQKKwkJICAgIG15IEBhdXRob3Ig
PSB2Y3NfZmluZF9hdXRob3IoJGNtZCk7CisJCSAgICBuZXh0IGlmICFAYXV0aG9yOworCisJCSAg
ICBteSAkZm9ybWF0dGVkX2F1dGhvciA9IGRlZHVwbGljYXRlX2VtYWlsKCRhdXRob3JbMF0pOwor
CisJCSAgICBteSAkY291bnQgPSBncmVwKC8kY29tbWl0LywgQGFsbF9jb21taXRzKTsKKwkJICAg
IGZvciAoJGkgPSAwOyAkaSA8ICRjb3VudCA7ICRpKyspIHsKKwkJCXB1c2goQGJsYW1lX3NpZ25l
cnMsICRmb3JtYXR0ZWRfYXV0aG9yKTsKKwkJICAgIH0KKwkJfQorCSAgICB9CisJICAgIGlmIChA
YmxhbWVfc2lnbmVycykgeworCQl2Y3NfYXNzaWduKCJhdXRob3JlZCBsaW5lcyIsICR0b3RhbF9s
aW5lcywgQGJsYW1lX3NpZ25lcnMpOworCSAgICB9CisJfQorCWZvcmVhY2ggbXkgJHNpZ25lciAo
QHNpZ25lcnMpIHsKKwkgICAgJHNpZ25lciA9IGRlZHVwbGljYXRlX2VtYWlsKCRzaWduZXIpOwor
CX0KKwl2Y3NfYXNzaWduKCJjb21taXRzIiwgJHRvdGFsX2NvbW1pdHMsIEBzaWduZXJzKTsKKyAg
ICB9IGVsc2UgeworCWZvcmVhY2ggbXkgJHNpZ25lciAoQHNpZ25lcnMpIHsKKwkgICAgJHNpZ25l
ciA9IGRlZHVwbGljYXRlX2VtYWlsKCRzaWduZXIpOworCX0KKwl2Y3NfYXNzaWduKCJtb2RpZmll
ZCBjb21taXRzIiwgJHRvdGFsX2NvbW1pdHMsIEBzaWduZXJzKTsKKyAgICB9Cit9CisKK3N1YiB2
Y3NfZmlsZV9leGlzdHMgeworICAgIG15ICgkZmlsZSkgPSBAXzsKKworICAgIG15ICRleGlzdHM7
CisKKyAgICBteSAkdmNzX3VzZWQgPSB2Y3NfZXhpc3RzKCk7CisgICAgcmV0dXJuIDAgaWYgKCEk
dmNzX3VzZWQpOworCisgICAgbXkgJGNtZCA9ICRWQ1NfY21kc3siZmlsZV9leGlzdHNfY21kIn07
CisgICAgJGNtZCA9fiBzLyhcJFx3KykvJDEvZWVnOwkJIyBpbnRlcnBvbGF0ZSAkY21kCisgICAg
JGNtZCAuPSAiIDI+JjEiOworICAgICRleGlzdHMgPSAmeyRWQ1NfY21kc3siZXhlY3V0ZV9jbWQi
fX0oJGNtZCk7CisKKyAgICByZXR1cm4gMCBpZiAoJD8gIT0gMCk7CisKKyAgICByZXR1cm4gJGV4
aXN0czsKK30KKworc3ViIHZjc19saXN0X2ZpbGVzIHsKKyAgICBteSAoJGZpbGUpID0gQF87CisK
KyAgICBteSBAbHNmaWxlcyA9ICgpOworCisgICAgbXkgJHZjc191c2VkID0gdmNzX2V4aXN0cygp
OworICAgIHJldHVybiAwIGlmICghJHZjc191c2VkKTsKKworICAgIG15ICRjbWQgPSAkVkNTX2Nt
ZHN7Imxpc3RfZmlsZXNfY21kIn07CisgICAgJGNtZCA9fiBzLyhcJFx3KykvJDEvZWVnOyAgICMg
aW50ZXJwb2xhdGUgJGNtZAorICAgIEBsc2ZpbGVzID0gJnskVkNTX2NtZHN7ImV4ZWN1dGVfY21k
In19KCRjbWQpOworCisgICAgcmV0dXJuICgpIGlmICgkPyAhPSAwKTsKKworICAgIHJldHVybiBA
bHNmaWxlczsKK30KKworc3ViIHVuaXEgeworICAgIG15IChAcGFybXMpID0gQF87CisKKyAgICBt
eSAlc2F3OworICAgIEBwYXJtcyA9IGdyZXAoISRzYXd7JF99KyssIEBwYXJtcyk7CisgICAgcmV0
dXJuIEBwYXJtczsKK30KKworc3ViIHNvcnRfYW5kX3VuaXEgeworICAgIG15IChAcGFybXMpID0g
QF87CisKKyAgICBteSAlc2F3OworICAgIEBwYXJtcyA9IHNvcnQgQHBhcm1zOworICAgIEBwYXJt
cyA9IGdyZXAoISRzYXd7JF99KyssIEBwYXJtcyk7CisgICAgcmV0dXJuIEBwYXJtczsKK30KKwor
c3ViIGNsZWFuX2ZpbGVfZW1haWxzIHsKKyAgICBteSAoQGZpbGVfZW1haWxzKSA9IEBfOworICAg
IG15IEBmbXRfZW1haWxzID0gKCk7CisKKyAgICBmb3JlYWNoIG15ICRlbWFpbCAoQGZpbGVfZW1h
aWxzKSB7CisJJGVtYWlsID1+IHMvW1woXDxce117MCwxfShbQS1aYS16MC05X1wuXCstXStcQFtB
LVphLXowLTlcLi1dKylbXClcPlx9XXswLDF9L1w8JDFcPi9nOworCW15ICgkbmFtZSwgJGFkZHJl
c3MpID0gcGFyc2VfZW1haWwoJGVtYWlsKTsKKwlpZiAoJG5hbWUgZXEgJyJbLFwuXSInKSB7CisJ
ICAgICRuYW1lID0gIiI7CisJfQorCisJbXkgQG53ID0gc3BsaXQoL1teQS1aYS16w4Atw79cJ1ws
XC5cKy1dLywgJG5hbWUpOworCWlmIChAbncgPiAyKSB7CisJICAgIG15ICRmaXJzdCA9ICRud1tA
bncgLSAzXTsKKwkgICAgbXkgJG1pZGRsZSA9ICRud1tAbncgLSAyXTsKKwkgICAgbXkgJGxhc3Qg
PSAkbndbQG53IC0gMV07CisKKwkgICAgaWYgKCgobGVuZ3RoKCRmaXJzdCkgPT0gMSAmJiAkZmly
c3QgPX4gbS9bQS1aYS16XS8pIHx8CisJCSAobGVuZ3RoKCRmaXJzdCkgPT0gMiAmJiBzdWJzdHIo
JGZpcnN0LCAtMSkgZXEgIi4iKSkgfHwKKwkJKGxlbmd0aCgkbWlkZGxlKSA9PSAxIHx8CisJCSAo
bGVuZ3RoKCRtaWRkbGUpID09IDIgJiYgc3Vic3RyKCRtaWRkbGUsIC0xKSBlcSAiLiIpKSkgewor
CQkkbmFtZSA9ICIkZmlyc3QgJG1pZGRsZSAkbGFzdCI7CisJICAgIH0gZWxzZSB7CisJCSRuYW1l
ID0gIiRtaWRkbGUgJGxhc3QiOworCSAgICB9CisJfQorCisJaWYgKHN1YnN0cigkbmFtZSwgLTEp
ID1+IC9bLFwuXS8pIHsKKwkgICAgJG5hbWUgPSBzdWJzdHIoJG5hbWUsIDAsIGxlbmd0aCgkbmFt
ZSkgLSAxKTsKKwl9IGVsc2lmIChzdWJzdHIoJG5hbWUsIC0yKSA9fiAvWyxcLl0iLykgeworCSAg
ICAkbmFtZSA9IHN1YnN0cigkbmFtZSwgMCwgbGVuZ3RoKCRuYW1lKSAtIDIpIC4gJyInOworCX0K
KworCWlmIChzdWJzdHIoJG5hbWUsIDAsIDEpID1+IC9bLFwuXS8pIHsKKwkgICAgJG5hbWUgPSBz
dWJzdHIoJG5hbWUsIDEsIGxlbmd0aCgkbmFtZSkgLSAxKTsKKwl9IGVsc2lmIChzdWJzdHIoJG5h
bWUsIDAsIDIpID1+IC8iWyxcLl0vKSB7CisJICAgICRuYW1lID0gJyInIC4gc3Vic3RyKCRuYW1l
LCAyLCBsZW5ndGgoJG5hbWUpIC0gMik7CisJfQorCisJbXkgJGZtdF9lbWFpbCA9IGZvcm1hdF9l
bWFpbCgkbmFtZSwgJGFkZHJlc3MsICRlbWFpbF91c2VuYW1lKTsKKwlwdXNoKEBmbXRfZW1haWxz
LCAkZm10X2VtYWlsKTsKKyAgICB9CisgICAgcmV0dXJuIEBmbXRfZW1haWxzOworfQorCitzdWIg
bWVyZ2VfZW1haWwgeworICAgIG15IEBsaW5lczsKKyAgICBteSAlc2F3OworCisgICAgZm9yIChA
XykgeworCW15ICgkYWRkcmVzcywgJHJvbGUpID0gQCRfOworCWlmICghJHNhd3skYWRkcmVzc30p
IHsKKwkgICAgaWYgKCRvdXRwdXRfcm9sZXMpIHsKKwkJcHVzaChAbGluZXMsICIkYWRkcmVzcyAo
JHJvbGUpIik7CisJICAgIH0gZWxzZSB7CisJCXB1c2goQGxpbmVzLCAkYWRkcmVzcyk7CisJICAg
IH0KKwkgICAgJHNhd3skYWRkcmVzc30gPSAxOworCX0KKyAgICB9CisKKyAgICByZXR1cm4gQGxp
bmVzOworfQorCitzdWIgb3V0cHV0IHsKKyAgICBteSAoQHBhcm1zKSA9IEBfOworCisgICAgaWYg
KCRvdXRwdXRfbXVsdGlsaW5lKSB7CisJZm9yZWFjaCBteSAkbGluZSAoQHBhcm1zKSB7CisJICAg
IHByaW50KCIke2xpbmV9XG4iKTsKKwl9CisgICAgfSBlbHNlIHsKKwlwcmludChqb2luKCRvdXRw
dXRfc2VwYXJhdG9yLCBAcGFybXMpKTsKKwlwcmludCgiXG4iKTsKKyAgICB9Cit9CisKK215ICRy
ZmM4MjJyZTsKKworc3ViIG1ha2VfcmZjODIycmUgeworIyAgIEJhc2ljIGxleGljYWwgdG9rZW5z
IGFyZSBzcGVjaWFscywgZG9tYWluX2xpdGVyYWwsIHF1b3RlZF9zdHJpbmcsIGF0b20sIGFuZAor
IyAgIGNvbW1lbnQuICBXZSBtdXN0IGFsbG93IGZvciByZmM4MjJfbHdzcCAob3IgY29tbWVudHMp
IGFmdGVyIGVhY2ggb2YgdGhlc2UuCisjICAgVGhpcyByZWdleHAgd2lsbCBvbmx5IHdvcmsgb24g
YWRkcmVzc2VzIHdoaWNoIGhhdmUgaGFkIGNvbW1lbnRzIHN0cmlwcGVkCisjICAgYW5kIHJlcGxh
Y2VkIHdpdGggcmZjODIyX2x3c3AuCisKKyAgICBteSAkc3BlY2lhbHMgPSAnKCk8PkAsOzpcXFxc
Ii5cXFtcXF0nOworICAgIG15ICRjb250cm9scyA9ICdcXDAwMC1cXDAzN1xcMTc3JzsKKworICAg
IG15ICRkdGV4dCA9ICJbXlxcW1xcXVxcclxcXFxdIjsKKyAgICBteSAkZG9tYWluX2xpdGVyYWwg
PSAiXFxbKD86JGR0ZXh0fFxcXFwuKSpcXF0kcmZjODIyX2x3c3AqIjsKKworICAgIG15ICRxdW90
ZWRfc3RyaW5nID0gIlwiKD86W15cXFwiXFxyXFxcXF18XFxcXC58JHJmYzgyMl9sd3NwKSpcIiRy
ZmM4MjJfbHdzcCoiOworCisjICAgVXNlIHplcm8td2lkdGggYXNzZXJ0aW9uIHRvIHNwb3QgdGhl
IGxpbWl0IG9mIGFuIGF0b20uICBBIHNpbXBsZQorIyAgICRyZmM4MjJfbHdzcCogY2F1c2VzIHRo
ZSByZWdleHAgZW5naW5lIHRvIGhhbmcgb2NjYXNpb25hbGx5LgorICAgIG15ICRhdG9tID0gIlte
JHNwZWNpYWxzICRjb250cm9sc10rKD86JHJmYzgyMl9sd3NwK3xcXFp8KD89W1xcW1wiJHNwZWNp
YWxzXSkpIjsKKyAgICBteSAkd29yZCA9ICIoPzokYXRvbXwkcXVvdGVkX3N0cmluZykiOworICAg
IG15ICRsb2NhbHBhcnQgPSAiJHdvcmQoPzpcXC4kcmZjODIyX2x3c3AqJHdvcmQpKiI7CisKKyAg
ICBteSAkc3ViX2RvbWFpbiA9ICIoPzokYXRvbXwkZG9tYWluX2xpdGVyYWwpIjsKKyAgICBteSAk
ZG9tYWluID0gIiRzdWJfZG9tYWluKD86XFwuJHJmYzgyMl9sd3NwKiRzdWJfZG9tYWluKSoiOwor
CisgICAgbXkgJGFkZHJfc3BlYyA9ICIkbG9jYWxwYXJ0XEAkcmZjODIyX2x3c3AqJGRvbWFpbiI7
CisKKyAgICBteSAkcGhyYXNlID0gIiR3b3JkKiI7CisgICAgbXkgJHJvdXRlID0gIig/OlxAJGRv
bWFpbig/OixcQCRyZmM4MjJfbHdzcCokZG9tYWluKSo6JHJmYzgyMl9sd3NwKikiOworICAgIG15
ICRyb3V0ZV9hZGRyID0gIlxcPCRyZmM4MjJfbHdzcCokcm91dGU/JGFkZHJfc3BlY1xcPiRyZmM4
MjJfbHdzcCoiOworICAgIG15ICRtYWlsYm94ID0gIig/OiRhZGRyX3NwZWN8JHBocmFzZSRyb3V0
ZV9hZGRyKSI7CisKKyAgICBteSAkZ3JvdXAgPSAiJHBocmFzZTokcmZjODIyX2x3c3AqKD86JG1h
aWxib3goPzosXFxzKiRtYWlsYm94KSopPztcXHMqIjsKKyAgICBteSAkYWRkcmVzcyA9ICIoPzok
bWFpbGJveHwkZ3JvdXApIjsKKworICAgIHJldHVybiAiJHJmYzgyMl9sd3NwKiRhZGRyZXNzIjsK
K30KKworc3ViIHJmYzgyMl9zdHJpcF9jb21tZW50cyB7CisgICAgbXkgJHMgPSBzaGlmdDsKKyMg
ICBSZWN1cnNpdmVseSByZW1vdmUgY29tbWVudHMsIGFuZCByZXBsYWNlIHdpdGggYSBzaW5nbGUg
c3BhY2UuICBUaGUgc2ltcGxlcgorIyAgIHJlZ2V4cHMgaW4gdGhlIEVtYWlsIEFkZHJlc3Npbmcg
RkFRIGFyZSBpbXBlcmZlY3QgLSB0aGV5IHdpbGwgbWlzcyBlc2NhcGVkCisjICAgY2hhcnMgaW4g
YXRvbXMsIGZvciBleGFtcGxlLgorCisgICAgd2hpbGUgKCRzID1+IHMvXigoPzpbXiJcXF18XFwu
KSoKKyAgICAgICAgICAgICAgICAgICAgKD86Iig/OlteIlxcXXxcXC4pKiIoPzpbXiJcXF18XFwu
KSopKikKKyAgICAgICAgICAgICAgICAgICAgXCgoPzpbXigpXFxdfFxcLikqXCkvJDEgL29zeCkg
e30KKyAgICByZXR1cm4gJHM7Cit9CisKKyMgICB2YWxpZDogcmV0dXJucyB0cnVlIGlmIHRoZSBw
YXJhbWV0ZXIgaXMgYW4gUkZDODIyIHZhbGlkIGFkZHJlc3MKKyMKK3N1YiByZmM4MjJfdmFsaWQg
eworICAgIG15ICRzID0gcmZjODIyX3N0cmlwX2NvbW1lbnRzKHNoaWZ0KTsKKworICAgIGlmICgh
JHJmYzgyMnJlKSB7CisgICAgICAgICRyZmM4MjJyZSA9IG1ha2VfcmZjODIycmUoKTsKKyAgICB9
CisKKyAgICByZXR1cm4gJHMgPX4gbS9eJHJmYzgyMnJlJC9zbyAmJiAkcyA9fiBtL14kcmZjODIy
X2NoYXIqJC87Cit9CisKKyMgICB2YWxpZGxpc3Q6IEluIHNjYWxhciBjb250ZXh0LCByZXR1cm5z
IHRydWUgaWYgdGhlIHBhcmFtZXRlciBpcyBhbiBSRkM4MjIKKyMgICAgICAgICAgICAgIHZhbGlk
IGxpc3Qgb2YgYWRkcmVzc2VzLgorIworIyAgICAgICAgICAgICAgSW4gbGlzdCBjb250ZXh0LCBy
ZXR1cm5zIGFuIGVtcHR5IGxpc3Qgb24gZmFpbHVyZSAoYW4gaW52YWxpZAorIyAgICAgICAgICAg
ICAgYWRkcmVzcyB3YXMgZm91bmQpOyBvdGhlcndpc2UgYSBsaXN0IHdob3NlIGZpcnN0IGVsZW1l
bnQgaXMgdGhlCisjICAgICAgICAgICAgICBudW1iZXIgb2YgYWRkcmVzc2VzIGZvdW5kIGFuZCB3
aG9zZSByZW1haW5pbmcgZWxlbWVudHMgYXJlIHRoZQorIyAgICAgICAgICAgICAgYWRkcmVzc2Vz
LiAgVGhpcyBpcyBuZWVkZWQgdG8gZGlzYW1iaWd1YXRlIGZhaWx1cmUgKGludmFsaWQpCisjICAg
ICAgICAgICAgICBmcm9tIHN1Y2Nlc3Mgd2l0aCBubyBhZGRyZXNzZXMgZm91bmQsIGJlY2F1c2Ug
YW4gZW1wdHkgc3RyaW5nIGlzCisjICAgICAgICAgICAgICBhIHZhbGlkIGxpc3QuCisKK3N1YiBy
ZmM4MjJfdmFsaWRsaXN0IHsKKyAgICBteSAkcyA9IHJmYzgyMl9zdHJpcF9jb21tZW50cyhzaGlm
dCk7CisKKyAgICBpZiAoISRyZmM4MjJyZSkgeworICAgICAgICAkcmZjODIycmUgPSBtYWtlX3Jm
YzgyMnJlKCk7CisgICAgfQorICAgICMgKiBudWxsIGxpc3QgaXRlbXMgYXJlIHZhbGlkIGFjY29y
ZGluZyB0byB0aGUgUkZDCisgICAgIyAqIHRoZSAnMScgYnVzaW5lc3MgaXMgdG8gYWlkIGluIGRp
c3Rpbmd1aXNoaW5nIGZhaWx1cmUgZnJvbSBubyByZXN1bHRzCisKKyAgICBteSBAcjsKKyAgICBp
ZiAoJHMgPX4gbS9eKD86JHJmYzgyMnJlKT8oPzosKD86JHJmYzgyMnJlKT8pKiQvc28gJiYKKwkk
cyA9fiBtL14kcmZjODIyX2NoYXIqJC8pIHsKKyAgICAgICAgd2hpbGUgKCRzID1+IG0vKD86Xnws
JHJmYzgyMl9sd3NwKikoJHJmYzgyMnJlKS9nb3MpIHsKKyAgICAgICAgICAgIHB1c2goQHIsICQx
KTsKKyAgICAgICAgfQorICAgICAgICByZXR1cm4gd2FudGFycmF5ID8gKHNjYWxhcihAciksIEBy
KSA6IDE7CisgICAgfQorICAgIHJldHVybiB3YW50YXJyYXkgPyAoKSA6IDA7Cit9Ci0tIAoyLjI4
LjAuMzk0LmdlMTk3MTM2Mzg5CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkg
R21iSApLcmF1c2Vuc3RyLiAzOAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJp
c3RpYW4gU2NobGFlZ2VyLCBKb25hdGhhbiBXZWlzcwpFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNo
dCBDaGFybG90dGVuYnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDog
REUgMjg5IDIzNyA4NzkKCgo=

